{
  "metadata": {
    "extraction_timestamp": "2025-09-29T13:42:02.867423",
    "article_type": "research-article",
    "language": "en"
  },
  "publication_info": {
    "journal": "Nature",
    "issn": "0028-0836",
    "publisher": "Nature Publishing Group UK",
    "doi": "10.1038/s41586-021-03451-0",
    "volume": "592",
    "issue": "7856",
    "publication_dates": {
      "pub": "2021-04-29"
    }
  },
  "title": "Towards complete and error-free genome assemblies of all vertebrate species",
  "authors": [
    {
      "surname": "Rhie",
      "given_names": "Arang",
      "full_name": "Arang Rhie",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff1"
      ]
    },
    {
      "surname": "McCarthy",
      "given_names": "Shane A.",
      "full_name": "Shane A. McCarthy",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff2",
        "Aff3"
      ]
    },
    {
      "surname": "Fedrigo",
      "given_names": "Olivier",
      "full_name": "Olivier Fedrigo",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff4"
      ]
    },
    {
      "surname": "Damas",
      "given_names": "Joana",
      "full_name": "Joana Damas",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff5"
      ]
    },
    {
      "surname": "Formenti",
      "given_names": "Giulio",
      "full_name": "Giulio Formenti",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff4",
        "Aff6"
      ]
    },
    {
      "surname": "Koren",
      "given_names": "Sergey",
      "full_name": "Sergey Koren",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff1"
      ]
    },
    {
      "surname": "Uliano-Silva",
      "given_names": "Marcela",
      "full_name": "Marcela Uliano-Silva",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff7",
        "Aff8"
      ]
    },
    {
      "surname": "Chow",
      "given_names": "William",
      "full_name": "William Chow",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff3"
      ]
    },
    {
      "surname": "Fungtammasan",
      "given_names": "Arkarachai",
      "full_name": "Arkarachai Fungtammasan",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff9"
      ]
    },
    {
      "surname": "Kim",
      "given_names": "Juwan",
      "full_name": "Juwan Kim",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff10"
      ]
    },
    {
      "surname": "Lee",
      "given_names": "Chul",
      "full_name": "Chul Lee",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff10"
      ]
    },
    {
      "surname": "Ko",
      "given_names": "Byung June",
      "full_name": "Byung June Ko",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff11"
      ]
    },
    {
      "surname": "Chaisson",
      "given_names": "Mark",
      "full_name": "Mark Chaisson",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff12"
      ]
    },
    {
      "surname": "Gedman",
      "given_names": "Gregory L.",
      "full_name": "Gregory L. Gedman",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff6"
      ]
    },
    {
      "surname": "Cantin",
      "given_names": "Lindsey J.",
      "full_name": "Lindsey J. Cantin",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff6"
      ]
    },
    {
      "surname": "Thibaud-Nissen",
      "given_names": "Francoise",
      "full_name": "Francoise Thibaud-Nissen",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff13"
      ]
    },
    {
      "surname": "Haggerty",
      "given_names": "Leanne",
      "full_name": "Leanne Haggerty",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff14"
      ]
    },
    {
      "surname": "Bista",
      "given_names": "Iliana",
      "full_name": "Iliana Bista",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff2",
        "Aff3"
      ]
    },
    {
      "surname": "Smith",
      "given_names": "Michelle",
      "full_name": "Michelle Smith",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff3"
      ]
    },
    {
      "surname": "Haase",
      "given_names": "Bettina",
      "full_name": "Bettina Haase",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff4"
      ]
    },
    {
      "surname": "Mountcastle",
      "given_names": "Jacquelyn",
      "full_name": "Jacquelyn Mountcastle",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff4"
      ]
    },
    {
      "surname": "Winkler",
      "given_names": "Sylke",
      "full_name": "Sylke Winkler",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff15",
        "Aff16"
      ]
    },
    {
      "surname": "Paez",
      "given_names": "Sadye",
      "full_name": "Sadye Paez",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff4",
        "Aff6"
      ]
    },
    {
      "surname": "Howard",
      "given_names": "Jason",
      "full_name": "Jason Howard",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff17"
      ]
    },
    {
      "surname": "Vernes",
      "given_names": "Sonja C.",
      "full_name": "Sonja C. Vernes",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff18",
        "Aff19",
        "Aff20"
      ]
    },
    {
      "surname": "Lama",
      "given_names": "Tanya M.",
      "full_name": "Tanya M. Lama",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff21"
      ]
    },
    {
      "surname": "Grutzner",
      "given_names": "Frank",
      "full_name": "Frank Grutzner",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff22"
      ]
    },
    {
      "surname": "Warren",
      "given_names": "Wesley C.",
      "full_name": "Wesley C. Warren",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff23"
      ]
    },
    {
      "surname": "Balakrishnan",
      "given_names": "Christopher N.",
      "full_name": "Christopher N. Balakrishnan",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff24"
      ]
    },
    {
      "surname": "Burt",
      "given_names": "Dave",
      "full_name": "Dave Burt",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff25"
      ]
    },
    {
      "surname": "George",
      "given_names": "Julia M.",
      "full_name": "Julia M. George",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff26"
      ]
    },
    {
      "surname": "Biegler",
      "given_names": "Matthew T.",
      "full_name": "Matthew T. Biegler",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff6"
      ]
    },
    {
      "surname": "Iorns",
      "given_names": "David",
      "full_name": "David Iorns",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff27"
      ]
    },
    {
      "surname": "Digby",
      "given_names": "Andrew",
      "full_name": "Andrew Digby",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff28"
      ]
    },
    {
      "surname": "Eason",
      "given_names": "Daryl",
      "full_name": "Daryl Eason",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff28"
      ]
    },
    {
      "surname": "Robertson",
      "given_names": "Bruce",
      "full_name": "Bruce Robertson",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff29"
      ]
    },
    {
      "surname": "Edwards",
      "given_names": "Taylor",
      "full_name": "Taylor Edwards",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff30"
      ]
    },
    {
      "surname": "Wilkinson",
      "given_names": "Mark",
      "full_name": "Mark Wilkinson",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff31"
      ]
    },
    {
      "surname": "Turner",
      "given_names": "George",
      "full_name": "George Turner",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff32"
      ]
    },
    {
      "surname": "Meyer",
      "given_names": "Axel",
      "full_name": "Axel Meyer",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff33"
      ]
    },
    {
      "surname": "Kautt",
      "given_names": "Andreas F.",
      "full_name": "Andreas F. Kautt",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff33",
        "Aff34"
      ]
    },
    {
      "surname": "Franchini",
      "given_names": "Paolo",
      "full_name": "Paolo Franchini",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff33"
      ]
    },
    {
      "surname": "Detrich",
      "given_names": "H. William",
      "full_name": "H. William Detrich",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff35"
      ]
    },
    {
      "surname": "Svardal",
      "given_names": "Hannes",
      "full_name": "Hannes Svardal",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff36",
        "Aff37"
      ]
    },
    {
      "surname": "Wagner",
      "given_names": "Maximilian",
      "full_name": "Maximilian Wagner",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff38"
      ]
    },
    {
      "surname": "Naylor",
      "given_names": "Gavin J. P.",
      "full_name": "Gavin J. P. Naylor",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff39"
      ]
    },
    {
      "surname": "Pippel",
      "given_names": "Martin",
      "full_name": "Martin Pippel",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff15",
        "Aff40"
      ]
    },
    {
      "surname": "Malinsky",
      "given_names": "Milan",
      "full_name": "Milan Malinsky",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff3",
        "Aff41"
      ]
    },
    {
      "surname": "Mooney",
      "given_names": "Mark",
      "full_name": "Mark Mooney",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff42"
      ]
    },
    {
      "surname": "Simbirsky",
      "given_names": "Maria",
      "full_name": "Maria Simbirsky",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff9"
      ]
    },
    {
      "surname": "Hannigan",
      "given_names": "Brett T.",
      "full_name": "Brett T. Hannigan",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff9"
      ]
    },
    {
      "surname": "Pesout",
      "given_names": "Trevor",
      "full_name": "Trevor Pesout",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff43"
      ]
    },
    {
      "surname": "Houck",
      "given_names": "Marlys",
      "full_name": "Marlys Houck",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff44"
      ]
    },
    {
      "surname": "Misuraca",
      "given_names": "Ann",
      "full_name": "Ann Misuraca",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff44"
      ]
    },
    {
      "surname": "Kingan",
      "given_names": "Sarah B.",
      "full_name": "Sarah B. Kingan",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff45"
      ]
    },
    {
      "surname": "Hall",
      "given_names": "Richard",
      "full_name": "Richard Hall",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff45"
      ]
    },
    {
      "surname": "Kronenberg",
      "given_names": "Zev",
      "full_name": "Zev Kronenberg",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff45"
      ]
    },
    {
      "surname": "Sović",
      "given_names": "Ivan",
      "full_name": "Ivan Sović",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff45",
        "Aff46"
      ]
    },
    {
      "surname": "Dunn",
      "given_names": "Christopher",
      "full_name": "Christopher Dunn",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff45"
      ]
    },
    {
      "surname": "Ning",
      "given_names": "Zemin",
      "full_name": "Zemin Ning",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff3"
      ]
    },
    {
      "surname": "Hastie",
      "given_names": "Alex",
      "full_name": "Alex Hastie",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff47"
      ]
    },
    {
      "surname": "Lee",
      "given_names": "Joyce",
      "full_name": "Joyce Lee",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff47"
      ]
    },
    {
      "surname": "Selvaraj",
      "given_names": "Siddarth",
      "full_name": "Siddarth Selvaraj",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff48"
      ]
    },
    {
      "surname": "Green",
      "given_names": "Richard E.",
      "full_name": "Richard E. Green",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff43",
        "Aff49"
      ]
    },
    {
      "surname": "Putnam",
      "given_names": "Nicholas H.",
      "full_name": "Nicholas H. Putnam",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff50"
      ]
    },
    {
      "surname": "Gut",
      "given_names": "Ivo",
      "full_name": "Ivo Gut",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff51",
        "Aff52"
      ]
    },
    {
      "surname": "Ghurye",
      "given_names": "Jay",
      "full_name": "Jay Ghurye",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff49",
        "Aff53"
      ]
    },
    {
      "surname": "Garrison",
      "given_names": "Erik",
      "full_name": "Erik Garrison",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff43"
      ]
    },
    {
      "surname": "Sims",
      "given_names": "Ying",
      "full_name": "Ying Sims",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff3"
      ]
    },
    {
      "surname": "Collins",
      "given_names": "Joanna",
      "full_name": "Joanna Collins",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff3"
      ]
    },
    {
      "surname": "Pelan",
      "given_names": "Sarah",
      "full_name": "Sarah Pelan",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff3"
      ]
    },
    {
      "surname": "Torrance",
      "given_names": "James",
      "full_name": "James Torrance",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff3"
      ]
    },
    {
      "surname": "Tracey",
      "given_names": "Alan",
      "full_name": "Alan Tracey",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff3"
      ]
    },
    {
      "surname": "Wood",
      "given_names": "Jonathan",
      "full_name": "Jonathan Wood",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff3"
      ]
    },
    {
      "surname": "Dagnew",
      "given_names": "Robel E.",
      "full_name": "Robel E. Dagnew",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff12"
      ]
    },
    {
      "surname": "Guan",
      "given_names": "Dengfeng",
      "full_name": "Dengfeng Guan",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff2",
        "Aff54"
      ]
    },
    {
      "surname": "London",
      "given_names": "Sarah E.",
      "full_name": "Sarah E. London",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff55"
      ]
    },
    {
      "surname": "Clayton",
      "given_names": "David F.",
      "full_name": "David F. Clayton",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff56"
      ]
    },
    {
      "surname": "Mello",
      "given_names": "Claudio V.",
      "full_name": "Claudio V. Mello",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff57"
      ]
    },
    {
      "surname": "Friedrich",
      "given_names": "Samantha R.",
      "full_name": "Samantha R. Friedrich",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff57"
      ]
    },
    {
      "surname": "Lovell",
      "given_names": "Peter V.",
      "full_name": "Peter V. Lovell",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff57"
      ]
    },
    {
      "surname": "Osipova",
      "given_names": "Ekaterina",
      "full_name": "Ekaterina Osipova",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff15",
        "Aff40",
        "Aff58"
      ]
    },
    {
      "surname": "Al-Ajli",
      "given_names": "Farooq O.",
      "full_name": "Farooq O. Al-Ajli",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff59",
        "Aff60",
        "Aff61"
      ]
    },
    {
      "surname": "Secomandi",
      "given_names": "Simona",
      "full_name": "Simona Secomandi",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff62"
      ]
    },
    {
      "surname": "Kim",
      "given_names": "Heebal",
      "full_name": "Heebal Kim",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff10",
        "Aff11",
        "Aff63"
      ]
    },
    {
      "surname": "Theofanopoulou",
      "given_names": "Constantina",
      "full_name": "Constantina Theofanopoulou",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff6"
      ]
    },
    {
      "surname": "Hiller",
      "given_names": "Michael",
      "full_name": "Michael Hiller",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff64",
        "Aff65",
        "Aff66"
      ]
    },
    {
      "surname": "Zhou",
      "given_names": "Yang",
      "full_name": "Yang Zhou",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff67"
      ]
    },
    {
      "surname": "Harris",
      "given_names": "Robert S.",
      "full_name": "Robert S. Harris",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff68"
      ]
    },
    {
      "surname": "Makova",
      "given_names": "Kateryna D.",
      "full_name": "Kateryna D. Makova",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff68",
        "Aff69",
        "Aff70"
      ]
    },
    {
      "surname": "Medvedev",
      "given_names": "Paul",
      "full_name": "Paul Medvedev",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff69",
        "Aff70",
        "Aff71",
        "Aff72"
      ]
    },
    {
      "surname": "Hoffman",
      "given_names": "Jinna",
      "full_name": "Jinna Hoffman",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff13"
      ]
    },
    {
      "surname": "Masterson",
      "given_names": "Patrick",
      "full_name": "Patrick Masterson",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff13"
      ]
    },
    {
      "surname": "Clark",
      "given_names": "Karen",
      "full_name": "Karen Clark",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff13"
      ]
    },
    {
      "surname": "Martin",
      "given_names": "Fergal",
      "full_name": "Fergal Martin",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff14"
      ]
    },
    {
      "surname": "Howe",
      "given_names": "Kevin",
      "full_name": "Kevin Howe",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff14"
      ]
    },
    {
      "surname": "Flicek",
      "given_names": "Paul",
      "full_name": "Paul Flicek",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff14"
      ]
    },
    {
      "surname": "Walenz",
      "given_names": "Brian P.",
      "full_name": "Brian P. Walenz",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff1"
      ]
    },
    {
      "surname": "Kwak",
      "given_names": "Woori",
      "full_name": "Woori Kwak",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff63",
        "Aff73"
      ]
    },
    {
      "surname": "Clawson",
      "given_names": "Hiram",
      "full_name": "Hiram Clawson",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff43"
      ]
    },
    {
      "surname": "Diekhans",
      "given_names": "Mark",
      "full_name": "Mark Diekhans",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff43"
      ]
    },
    {
      "surname": "Nassar",
      "given_names": "Luis",
      "full_name": "Luis Nassar",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff43"
      ]
    },
    {
      "surname": "Paten",
      "given_names": "Benedict",
      "full_name": "Benedict Paten",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff43"
      ]
    },
    {
      "surname": "Kraus",
      "given_names": "Robert H. S.",
      "full_name": "Robert H. S. Kraus",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff33",
        "Aff74"
      ]
    },
    {
      "surname": "Crawford",
      "given_names": "Andrew J.",
      "full_name": "Andrew J. Crawford",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff75"
      ]
    },
    {
      "surname": "Gilbert",
      "given_names": "M. Thomas P.",
      "full_name": "M. Thomas P. Gilbert",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff76",
        "Aff77"
      ]
    },
    {
      "surname": "Zhang",
      "given_names": "Guojie",
      "full_name": "Guojie Zhang",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff78",
        "Aff79",
        "Aff80",
        "Aff81"
      ]
    },
    {
      "surname": "Venkatesh",
      "given_names": "Byrappa",
      "full_name": "Byrappa Venkatesh",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff82"
      ]
    },
    {
      "surname": "Murphy",
      "given_names": "Robert W.",
      "full_name": "Robert W. Murphy",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff83"
      ]
    },
    {
      "surname": "Koepfli",
      "given_names": "Klaus-Peter",
      "full_name": "Klaus-Peter Koepfli",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff84"
      ]
    },
    {
      "surname": "Shapiro",
      "given_names": "Beth",
      "full_name": "Beth Shapiro",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff85",
        "Aff86"
      ]
    },
    {
      "surname": "Johnson",
      "given_names": "Warren E.",
      "full_name": "Warren E. Johnson",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff84",
        "Aff87",
        "Aff88"
      ]
    },
    {
      "surname": "Di Palma",
      "given_names": "Federica",
      "full_name": "Federica Di Palma",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff89"
      ]
    },
    {
      "surname": "Marques-Bonet",
      "given_names": "Tomas",
      "full_name": "Tomas Marques-Bonet",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff90",
        "Aff91",
        "Aff92",
        "Aff93"
      ]
    },
    {
      "surname": "Teeling",
      "given_names": "Emma C.",
      "full_name": "Emma C. Teeling",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff94"
      ]
    },
    {
      "surname": "Warnow",
      "given_names": "Tandy",
      "full_name": "Tandy Warnow",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff95"
      ]
    },
    {
      "surname": "Graves",
      "given_names": "Jennifer Marshall",
      "full_name": "Jennifer Marshall Graves",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff96"
      ]
    },
    {
      "surname": "Ryder",
      "given_names": "Oliver A.",
      "full_name": "Oliver A. Ryder",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff44",
        "Aff97"
      ]
    },
    {
      "surname": "Haussler",
      "given_names": "David",
      "full_name": "David Haussler",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff43",
        "Aff85"
      ]
    },
    {
      "surname": "O’Brien",
      "given_names": "Stephen J.",
      "full_name": "Stephen J. O’Brien",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff98",
        "Aff99"
      ]
    },
    {
      "surname": "Korlach",
      "given_names": "Jonas",
      "full_name": "Jonas Korlach",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff45"
      ]
    },
    {
      "surname": "Lewin",
      "given_names": "Harris A.",
      "full_name": "Harris A. Lewin",
      "is_corresponding": false,
      "affiliation_refs": [
        "Aff5",
        "Aff100",
        "Aff101"
      ]
    },
    {
      "surname": "Howe",
      "given_names": "Kerstin",
      "full_name": "Kerstin Howe",
      "email": "kj2@sanger.ac.uk",
      "is_corresponding": true,
      "affiliation_refs": [
        "Aff3"
      ]
    },
    {
      "surname": "Myers",
      "given_names": "Eugene W.",
      "full_name": "Eugene W. Myers",
      "email": "gene@mpi-cbg.de",
      "is_corresponding": true,
      "affiliation_refs": [
        "Aff15",
        "Aff40",
        "Aff102"
      ]
    },
    {
      "surname": "Durbin",
      "given_names": "Richard",
      "full_name": "Richard Durbin",
      "email": "rd109@cam.ac.uk",
      "is_corresponding": true,
      "affiliation_refs": [
        "Aff2",
        "Aff3"
      ]
    },
    {
      "surname": "Phillippy",
      "given_names": "Adam M.",
      "full_name": "Adam M. Phillippy",
      "email": "adam.phillippy@nih.gov",
      "is_corresponding": true,
      "affiliation_refs": [
        "Aff1"
      ]
    },
    {
      "surname": "Jarvis",
      "given_names": "Erich D.",
      "full_name": "Erich D. Jarvis",
      "email": "ejarvis@rockefeller.edu",
      "is_corresponding": true,
      "affiliation_refs": [
        "Aff4",
        "Aff6",
        "Aff86"
      ]
    }
  ],
  "affiliations": {
    "Aff1": {
      "institution": "National Human Genome Research Institute, National Institutes of Health",
      "department": "Genome Informatics Section, Computational and Statistical Genomics Branch",
      "address": {
        "city": "Bethesda",
        "state": "MD",
        "country": "USA"
      }
    },
    "Aff2": {
      "institution": "University of Cambridge",
      "department": "Department of Genetics",
      "address": {
        "city": "Cambridge",
        "country": "UK"
      }
    },
    "Aff3": {
      "institution": "Wellcome Sanger Institute",
      "address": {
        "city": "Cambridge",
        "country": "UK"
      }
    },
    "Aff4": {
      "institution": "The Rockefeller University",
      "department": "Vertebrate Genome Lab",
      "address": {
        "city": "New York",
        "state": "NY",
        "country": "USA"
      }
    },
    "Aff5": {
      "institution": "University of California Davis",
      "department": "The Genome Center",
      "address": {
        "city": "Davis",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff6": {
      "institution": "The Rockefeller University",
      "department": "Laboratory of Neurogenetics of Language",
      "address": {
        "city": "New York",
        "state": "NY",
        "country": "USA"
      }
    },
    "Aff7": {
      "institution": "Department of Evolutionary Genetics",
      "department": "Leibniz Institute for Zoo and Wildlife Research",
      "address": {
        "city": "Berlin",
        "country": "Germany"
      }
    },
    "Aff8": {
      "institution": "Berlin Center for Genomics in Biodiversity Research",
      "address": {
        "city": "Berlin",
        "country": "Germany"
      }
    },
    "Aff9": {
      "institution": "DNAnexus Inc.",
      "address": {
        "city": "Mountain View",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff10": {
      "institution": "Seoul National University",
      "department": "Interdisciplinary Program in Bioinformatics",
      "address": {
        "city": "Seoul",
        "country": "Republic of Korea"
      }
    },
    "Aff11": {
      "institution": "Seoul National University",
      "department": "Department of Agricultural Biotechnology and Research Institute of Agriculture and Life Sciences",
      "address": {
        "city": "Seoul",
        "country": "Republic of Korea"
      }
    },
    "Aff12": {
      "institution": "University of Southern California",
      "address": {
        "city": "Los Angeles",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff13": {
      "institution": "National Library of Medicine, NIH",
      "department": "National Center for Biotechnology Information",
      "address": {
        "city": "Bethesda",
        "state": "MD",
        "country": "USA"
      }
    },
    "Aff14": {
      "institution": "Wellcome Genome Campus",
      "department": "European Molecular Biology Laboratory, European Bioinformatics Institute",
      "address": {
        "city": "Hinxton",
        "country": "UK"
      }
    },
    "Aff15": {
      "institution": "Max Planck Institute of Molecular Cell Biology and Genetics",
      "address": {
        "city": "Dresden",
        "country": "Germany"
      }
    },
    "Aff16": {
      "institution": "DRESDEN-concept Genome Center",
      "address": {
        "city": "Dresden",
        "country": "Germany"
      }
    },
    "Aff17": {
      "institution": "Novogene",
      "address": {
        "city": "Durham",
        "state": "NC",
        "country": "USA"
      }
    },
    "Aff18": {
      "institution": "Max Planck Institute for Psycholinguistics",
      "department": "Neurogenetics of Vocal Communication Group",
      "address": {
        "city": "Nijmegen",
        "country": "The Netherlands"
      }
    },
    "Aff19": {
      "institution": "Cognition and Behaviour",
      "department": "Donders Institute for Brain",
      "address": {
        "city": "Nijmegen",
        "country": "The Netherlands"
      }
    },
    "Aff20": {
      "institution": "University of St Andrews",
      "department": "School of Biology",
      "address": {
        "city": "St Andrews",
        "country": "UK"
      }
    },
    "Aff21": {
      "institution": "University of Massachusetts Cooperative Fish and Wildlife Research Unit",
      "address": {
        "city": "Amherst",
        "state": "MA",
        "country": "USA"
      }
    },
    "Aff22": {
      "institution": "University of Adelaide",
      "department": "School of Biological Science, The Environment Institute",
      "address": {
        "city": "Adelaide",
        "state": "South Australia",
        "country": "Australia"
      }
    },
    "Aff23": {
      "institution": "University of Missouri",
      "department": "Bond Life Sciences Center",
      "address": {
        "city": "Columbia",
        "state": "MO",
        "country": "USA"
      }
    },
    "Aff24": {
      "institution": "East Carolina University",
      "department": "Department of Biology",
      "address": {
        "city": "Greenville",
        "state": "NC",
        "country": "USA"
      }
    },
    "Aff25": {
      "institution": "University of Queensland",
      "department": "UQ Genomics",
      "address": {
        "city": "Brisbane",
        "state": "Queensland",
        "country": "Australia"
      }
    },
    "Aff26": {
      "institution": "Clemson University",
      "department": "Department of Biological Sciences",
      "address": {
        "city": "Clemson",
        "state": "SC",
        "country": "USA"
      }
    },
    "Aff27": {
      "institution": "The Genetic Rescue Foundation",
      "address": {
        "city": "Wellington",
        "country": "New Zealand"
      }
    },
    "Aff28": {
      "institution": "Kākāpō Recovery, Department of Conservation",
      "address": {
        "city": "Invercargill",
        "country": "New Zealand"
      }
    },
    "Aff29": {
      "institution": "University of Otago",
      "department": "Department of Zoology",
      "address": {
        "city": "Dunedin",
        "country": "New Zealand"
      }
    },
    "Aff30": {
      "institution": "University of Arizona Genetics Core",
      "address": {
        "city": "Tucson",
        "state": "AZ",
        "country": "USA"
      }
    },
    "Aff31": {
      "institution": "Natural History Museum",
      "department": "Department of Life Sciences",
      "address": {
        "city": "London",
        "country": "UK"
      }
    },
    "Aff32": {
      "institution": "Bangor University",
      "department": "School of Natural Sciences",
      "address": {
        "city": "Gwynedd",
        "country": "UK"
      }
    },
    "Aff33": {
      "institution": "University of Konstanz",
      "department": "Department of Biology",
      "address": {
        "city": "Konstanz",
        "country": "Germany"
      }
    },
    "Aff34": {
      "institution": "Harvard University",
      "department": "Department of Organismic and Evolutionary Biology",
      "address": {
        "city": "Cambridge",
        "state": "MA",
        "country": "USA"
      }
    },
    "Aff35": {
      "institution": "Northeastern University Marine Science Center",
      "department": "Department of Marine and Environmental Sciences",
      "address": {
        "city": "Nahant",
        "state": "MA",
        "country": "USA"
      }
    },
    "Aff36": {
      "institution": "University of Antwerp",
      "department": "Department of Biology",
      "address": {
        "city": "Antwerp",
        "country": "Belgium"
      }
    },
    "Aff37": {
      "institution": "Naturalis Biodiversity Center",
      "address": {
        "city": "Leiden",
        "country": "The Netherlands"
      }
    },
    "Aff38": {
      "institution": "Karl-Franzens University of Graz",
      "department": "Institute of Biology",
      "address": {
        "city": "Graz",
        "country": "Austria"
      }
    },
    "Aff39": {
      "institution": "University of Florida",
      "department": "Florida Museum of Natural History",
      "address": {
        "city": "Gainesville",
        "state": "FL",
        "country": "USA"
      }
    },
    "Aff40": {
      "institution": "Center for Systems Biology",
      "address": {
        "city": "Dresden",
        "country": "Germany"
      }
    },
    "Aff41": {
      "institution": "University of Basel",
      "department": "Zoological Institute",
      "address": {
        "city": "Basel",
        "country": "Switzerland"
      }
    },
    "Aff42": {
      "institution": "Tag.bio",
      "address": {
        "city": "San Francisco",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff43": {
      "institution": "University of California",
      "department": "UC Santa Cruz Genomics Institute",
      "address": {
        "city": "Santa Cruz",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff44": {
      "institution": "San Diego Zoo Global",
      "address": {
        "city": "Escondido",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff45": {
      "institution": "Pacific Biosciences",
      "address": {
        "city": "Menlo Park",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff46": {
      "institution": "Digital BioLogic",
      "address": {
        "city": "Ivanić-Grad",
        "country": "Croatia"
      }
    },
    "Aff47": {
      "institution": "Bionano Genomics",
      "address": {
        "city": "San Diego",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff48": {
      "institution": "Arima Genomics",
      "address": {
        "city": "San Diego",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff49": {
      "institution": "Dovetail Genomics",
      "address": {
        "city": "Santa Cruz",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff50": {
      "institution": "Independent Researcher",
      "address": {
        "city": "Santa Cruz",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff51": {
      "institution": "Barcelona Institute of Science and Technology",
      "department": "CNAG-CRG, Centre for Genomic Regulation",
      "address": {
        "city": "Barcelona",
        "country": "Spain"
      }
    },
    "Aff52": {
      "institution": "Universitat Pompeu Fabra",
      "address": {
        "city": "Barcelona",
        "country": "Spain"
      }
    },
    "Aff53": {
      "institution": "University of Maryland College Park",
      "department": "Department of Computer Science",
      "address": {
        "city": "College Park",
        "state": "MD",
        "country": "USA"
      }
    },
    "Aff54": {
      "institution": "Harbin Institute of Technology",
      "department": "School of Computer Science and Technology, Center for Bioinformatics",
      "address": {
        "city": "Harbin",
        "country": "China"
      }
    },
    "Aff55": {
      "institution": "University of Chicago",
      "department": "Department of Psychology, Institute for Mind and Biology",
      "address": {
        "city": "Chicago",
        "state": "IL",
        "country": "USA"
      }
    },
    "Aff56": {
      "institution": "Clemson University",
      "department": "Department of Genetics and Biochemistry",
      "address": {
        "city": "Clemson",
        "state": "SC",
        "country": "USA"
      }
    },
    "Aff57": {
      "institution": "Oregon Health and Science University",
      "department": "Department of Behavioral Neuroscience",
      "address": {
        "city": "Portland",
        "state": "OR",
        "country": "USA"
      }
    },
    "Aff58": {
      "institution": "Max Planck Institute for the Physics of Complex Systems",
      "address": {
        "city": "Dresden",
        "country": "Germany"
      }
    },
    "Aff59": {
      "institution": "Monash University Malaysia Genomics Facility, School of Science",
      "address": {
        "city": "Selangor Darul Ehsan",
        "country": "Malaysia"
      }
    },
    "Aff60": {
      "institution": "Monash University Malaysia",
      "department": "Tropical Medicine and Biology Multidisciplinary Platform",
      "address": {
        "city": "Selangor Darul Ehsan",
        "country": "Malaysia"
      }
    },
    "Aff61": {
      "institution": "Qatar Falcon Genome Project",
      "address": {
        "city": "Doha",
        "country": "Qatar"
      }
    },
    "Aff62": {
      "institution": "University of Milan",
      "department": "Department of Biosciences",
      "address": {
        "city": "Milan",
        "country": "Italy"
      }
    },
    "Aff63": {
      "institution": "eGnome, Inc.",
      "address": {
        "city": "Seoul",
        "country": "Republic of Korea"
      }
    },
    "Aff64": {
      "institution": "LOEWE Centre for Translational Biodiversity Genomics",
      "address": {
        "city": "Frankfurt",
        "country": "Germany"
      }
    },
    "Aff65": {
      "institution": "Senckenberg Research Institute",
      "address": {
        "city": "Frankfurt",
        "country": "Germany"
      }
    },
    "Aff66": {
      "institution": "Goethe-University, Faculty of Biosciences",
      "address": {
        "city": "Frankfurt",
        "country": "Germany"
      }
    },
    "Aff67": {
      "institution": "BGI-Shenzhen",
      "address": {
        "city": "Shenzhen",
        "country": "China"
      }
    },
    "Aff68": {
      "institution": "Pennsylvania State University",
      "department": "Department of Biology",
      "address": {
        "city": "University Park",
        "state": "PA",
        "country": "USA"
      }
    },
    "Aff69": {
      "institution": "Pennsylvania State University",
      "department": "Center for Medical Genomics",
      "address": {
        "city": "University Park",
        "state": "PA",
        "country": "USA"
      }
    },
    "Aff70": {
      "institution": "Pennsylvania State University",
      "department": "Center for Computational Biology and Bioinformatics",
      "address": {
        "city": "University Park",
        "state": "PA",
        "country": "USA"
      }
    },
    "Aff71": {
      "institution": "Pennsylvania State University",
      "department": "Department of Computer Science and Engineering",
      "address": {
        "city": "University Park",
        "state": "PA",
        "country": "USA"
      }
    },
    "Aff72": {
      "institution": "Pennsylvania State University",
      "department": "Department of Biochemistry and Molecular Biology",
      "address": {
        "city": "University Park",
        "state": "PA",
        "country": "USA"
      }
    },
    "Aff73": {
      "institution": "Hoonygen",
      "address": {
        "city": "Seoul",
        "country": "Korea"
      }
    },
    "Aff74": {
      "institution": "Max Planck Institute of Animal Behavior",
      "department": "Department of Migration",
      "address": {
        "city": "Radolfzell",
        "country": "Germany"
      }
    },
    "Aff75": {
      "institution": "Universidad de los Andes",
      "department": "Department of Biological Sciences",
      "address": {
        "city": "Bogotá",
        "country": "Colombia"
      }
    },
    "Aff76": {
      "institution": "University of Copenhagen",
      "department": "Center for Evolutionary Hologenomics, The GLOBE Institute",
      "address": {
        "city": "Copenhagen",
        "country": "Denmark"
      }
    },
    "Aff77": {
      "institution": "University Museum, NTNU",
      "address": {
        "city": "Trondheim",
        "country": "Norway"
      }
    },
    "Aff78": {
      "institution": "China National Genebank, BGI-Shenzhen",
      "address": {
        "city": "Shenzhen",
        "country": "China"
      }
    },
    "Aff79": {
      "institution": "University of Copenhagen",
      "department": "Villum Center for Biodiversity Genomics, Section for Ecology and Evolution, Department of Biology",
      "address": {
        "city": "Copenhagen",
        "country": "Denmark"
      }
    },
    "Aff80": {
      "institution": "Kunming Institute of Zoology, Chinese Academy of Sciences",
      "department": "State Key Laboratory of Genetic Resources and Evolution",
      "address": {
        "city": "Kunming",
        "country": "China"
      }
    },
    "Aff81": {
      "institution": "Chinese Academy of Sciences",
      "department": "Center for Excellence in Animal Evolution and Genetics",
      "address": {
        "city": "Kunming",
        "country": "China"
      }
    },
    "Aff82": {
      "institution": "Institute of Molecular and Cell Biology, A*STAR, Biopolis",
      "address": {
        "city": "Singapore",
        "country": "Singapore"
      }
    },
    "Aff83": {
      "institution": "Centre for Biodiversity, Royal Ontario Museum",
      "address": {
        "city": "Toronto",
        "state": "Ontario",
        "country": "Canada"
      }
    },
    "Aff84": {
      "institution": "Smithsonian Conservation Biology Institute, Center for Species Survival, National Zoological Park",
      "address": {
        "city": "Washington",
        "state": "DC",
        "country": "USA"
      }
    },
    "Aff85": {
      "institution": "University of California Santa Cruz",
      "department": "Department of Ecology and Evolutionary Biology",
      "address": {
        "city": "Santa Cruz",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff86": {
      "institution": "Howard Hughes Medical Institute",
      "address": {
        "city": "Chevy Chase",
        "state": "MD",
        "country": "USA"
      }
    },
    "Aff87": {
      "institution": "Smithsonian Institution",
      "department": "The Walter Reed Biosystematics Unit, Museum Support Center MRC-534",
      "address": {
        "city": "Suitland",
        "state": "MD",
        "country": "USA"
      }
    },
    "Aff88": {
      "institution": "Walter Reed Army Institute of Research",
      "address": {
        "city": "Silver Spring",
        "state": "MD",
        "country": "USA"
      }
    },
    "Aff89": {
      "institution": "University of East Anglia",
      "department": "Department of Biological Sciences, Earlham Institute",
      "address": {
        "city": "Norwich",
        "country": "UK"
      }
    },
    "Aff90": {
      "institution": "Institute of Evolutionary Biology (UPF-CSIC), PRBB",
      "address": {
        "city": "Barcelona",
        "country": "Spain"
      }
    },
    "Aff91": {
      "institution": "Catalan Institution of Research and Advanced Studies (ICREA)",
      "address": {
        "city": "Barcelona",
        "country": "Spain"
      }
    },
    "Aff92": {
      "institution": "Barcelona Institute of Science and Technology (BIST)",
      "department": "Centre for Genomic Regulation (CRG)",
      "address": {
        "city": "Barcelona",
        "country": "Spain"
      }
    },
    "Aff93": {
      "institution": "Universitat Autònoma de Barcelona",
      "department": "Institut Català de Paleontologia Miquel Crusafont",
      "address": {
        "city": "Barcelona",
        "country": "Spain"
      }
    },
    "Aff94": {
      "institution": "University College Dublin",
      "department": "School of Biology and Environmental Science",
      "address": {
        "city": "Dublin",
        "country": "Ireland"
      }
    },
    "Aff95": {
      "institution": "The University of Illinois at Urbana-Champaign",
      "department": "Department of Computer Science",
      "address": {
        "city": "Urbana",
        "state": "IL",
        "country": "USA"
      }
    },
    "Aff96": {
      "institution": "La Trobe University",
      "department": "School of Life Science",
      "address": {
        "city": "Melbourne",
        "state": "Victoria",
        "country": "Australia"
      }
    },
    "Aff97": {
      "institution": "University of California San Diego",
      "department": "Department of Evolution, Behavior, and Ecology",
      "address": {
        "city": "La Jolla",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff98": {
      "institution": "ITMO University",
      "department": "Laboratory of Genomics Diversity-Center for Computer Technologies",
      "address": {
        "city": "St. Petersburg",
        "country": "Russian Federation"
      }
    },
    "Aff99": {
      "institution": "Nova Southeastern University",
      "department": "Guy Harvey Oceanographic Center, Halmos College of Natural Sciences and Oceanography",
      "address": {
        "city": "Fort Lauderdale",
        "state": "FL",
        "country": "USA"
      }
    },
    "Aff100": {
      "institution": "University of California Davis",
      "department": "Department of Evolution and Ecology",
      "address": {
        "city": "Davis",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff101": {
      "institution": "University of California Davis",
      "department": "John Muir Institute for the Environment",
      "address": {
        "city": "Davis",
        "state": "CA",
        "country": "USA"
      }
    },
    "Aff102": {
      "institution": "Technical University Dresden",
      "department": "Faculty of Computer Science",
      "address": {
        "city": "Dresden",
        "country": "Germany"
      }
    }
  },
  "abstract": {
    "full_text": "Abstract High-quality and complete reference genome assemblies are fundamental for the application of genomics to biology, disease, and biodiversity conservation. However, such assemblies are available for only a few non-microbial species 1 , 2 , 3 – 4 . To address this issue, the international Genome 10K (G10K) consortium 5 , 6 has worked over a five-year period to evaluate and develop cost-effective methods for assembling highly accurate and nearly complete reference genomes. Here we present lessons learned from generating assemblies for 16 species that represent six major vertebrate lineages. We confirm that long-read sequencing technologies are essential for maximizing genome quality, and that unresolved complex repeats and haplotype heterozygosity are major sources of assembly error when not handled correctly. Our assemblies correct substantial errors, add missing sequence in some of the best historical reference genomes, and reveal biological discoveries. These include the identification of many false gene duplications, increases in gene sizes, chromosome rearrangements that are specific to lineages, a repeated independent chromosome breakpoint in bat genomes, and a canonical GC-rich pattern in protein-coding genes and their regulatory regions. Adopting these lessons, we have embarked on the Vertebrate Genomes Project (VGP), an international effort to generate high-quality, complete reference genomes for all of the roughly 70,000 extant vertebrate species and to help to enable a new era of discovery across the life sciences."
  },
  "keywords": [
    {
      "language": "en",
      "keywords": [
        "Biological Sciences",
        "Genetics"
      ]
    }
  ],
  "funding": [],
  "content": {
    "sections": [
      {
        "id": "Sec1",
        "title": "Main",
        "paragraphs": [
          {
            "id": "Par3",
            "text": "Chromosome-level reference genomes underpin the study of functional, comparative, and population genomics within and across species. The first high-quality genome assemblies of human 1 and other model species (for example, Caenorhabditis elegans 2 , mouse 3 , and zebrafish 4 ) were put together using 500–1,000-base pair (bp) Sanger sequencing reads of thousands of hierarchically organized clones with 200–300-kilobase (kb) inserts, and chromosome genetic maps. This approach required tremendous manual effort, software engineering, and cost, in decade-long projects. Whole-genome shotgun approaches simplified the logistics (for example, in human 7 and Drosophila 8 ), and later next-generation sequencing with shorter (30–150-bp) sequencing reads and short insert sizes (for example, 1 kb) ushered in more affordable and scalable genome sequencing 9 . However, the shorter reads resulted in lower-quality assemblies, fragmented into thousands of pieces, where many genes were missing, truncated, or incorrectly assembled, resulting in annotation and other errors 10 . Such errors can require months of manual effort to correct individual genes and years to correct an entire assembly. Genomic heterozygosity posed additional problems, because homologous haplotypes in a diploid or polyploid genome are forced together into a single consensus by standard assemblers, sometimes creating false gene duplications 11 , 12 , 13 – 14 ."
          },
          {
            "id": "Par4",
            "text": "To address these problems, the G10K consortium 5 , 6 initiated the Vertebrate Genomes Project (VGP; https://vertebrategenomesproject.org ) with the ultimate aim of producing at least one high-quality, near error-free and gapless, chromosome-level, haplotype-phased, and annotated reference genome assembly for each of the 71,657 extant named vertebrate species and using these genomes to address fundamental questions in biology, disease, and biodiversity conservation. Towards this end, having learned the lessons of having too many variables that make conclusions more difficult to reach in the G10K from the G10K Assemblathon 2 effort 15 , we first evaluated multiple genome sequencing and assembly approaches extensively on one species, the Anna’s hummingbird ( Calypte anna ). We then deployed the best-performing method across sixteen species representing six major vertebrate classes, with a wide diversity of genomic characteristics. Drawing on the principles learned, we improved these methods further, discovered parameters and approaches that work better for species with different genomic characteristics, and made biological discoveries that had not been possible with the previous assemblies."
          }
        ]
      },
      {
        "id": "Sec2",
        "title": "Complete, accurate assemblies require long reads",
        "paragraphs": [
          {
            "id": "Par5",
            "text": "We chose a female Anna’s hummingbird because it has a relatively small genome (about 1 Gb), is heterogametic (has both Z and W sex chromosomes), and has an annotated reference of the same individual built from short reads 16 . We obtained 12 new sequencing data types, including both short and long reads (80 bp to 100 kb), and long-range linking information (40 kb to more than 100 Mb), generated using eight technologies (Supplementary Table 1 ). We benchmarked all technologies and assembly algorithms (Supplementary Table 2 ) in isolation and in many combinations (Supplementary Table 3 ). To our knowledge, this was the first systematic analysis of many sequence technologies, assembly algorithms, and assembly parameters applied on the same individual. We found that primary contiguous sequences (contigs) (pseudo-haplotype; Supplementary Note 1 ) assembled from Pacific Biosciences continuous long reads (CLR) or Oxford Nanopore long reads (ONT) were approximately 30- to 300-fold longer than those assembled from Illumina short reads (SR), regardless of data type combination or assembly algorithm used (Fig. 1a , Supplementary Table 3 ). The highest contig NG50s for short-read-only assemblies were about 0.025 to 0.169 Mb, whereas for long reads they were about 4.6 to 7.66 Mb (Fig. 1a ); contig NG50 is an assembly metric based on a weighted median of the lengths of its gapless sequences relative to the estimated genome size. After fixing a function in the PacBio FALCON software 17 that caused artificial breaks in contigs between stretches of highly homozygous and heterozygous haplotype sequences (Supplementary Note 1 , Supplementary Table 2 ), contig NG50 nearly tripled to 12.77 Mb (Fig. 1a ). These findings are consistent with theoretical predictions 18 and demonstrate that, given current sequencing technology and assembly algorithms, it is not possible to achieve high contig continuity with short reads alone, as it is typically impossible to bridge through repeats that are longer than the read length. Fig. 1 Comparative analyses of Anna’s hummingbird genome assemblies with various data types. a , Contig NG50 values of the primary pseudo-haplotype. b , Scaffold NG50 values. c , Number of joins (gaps). d , Number of mis-join errors compared with the curated assembly. The curated assembly has no remaining conflicts with the raw data and thus no known mis-joins. *Same as CLR + linked + Opt. + Hi-C, but with contigs generated with an updated FALCON 17 version and earlier Hi-C Salsa version (v2.0 versus v2.2; Supplementary Table 2 ) for less aggressive contig joining. e , f , Hi-C interaction heat maps before and after manual curation, which identified 34 chromosomes. Grid lines indicate scaffold boundaries. Red arrow, example mis-join that was corrected during curation. g , Karyotype of the identified chromosomes ( n = 36 + ZW), consistent with previous findings 70 . h , Correlation between estimated chromosome sizes (in Mb) based on karyotype images in g and assembled scaffolds in Supplementary Table 4 (bCalAna1) on a log–log scale. v1.0, VGP assembly v1.0 pipeline; linked, 10X Genomics linked reads; Hi-C, Hi-C proximity ligation; 1D, 2D, Oxford Nanopore long reads; NRGene, NRGene paired-end Illumina reads; SR, paired-end Illumina short reads."
          },
          {
            "id": "",
            "text": "a , Contig NG50 values of the primary pseudo-haplotype. b , Scaffold NG50 values. c , Number of joins (gaps). d , Number of mis-join errors compared with the curated assembly. The curated assembly has no remaining conflicts with the raw data and thus no known mis-joins. *Same as CLR + linked + Opt. + Hi-C, but with contigs generated with an updated FALCON 17 version and earlier Hi-C Salsa version (v2.0 versus v2.2; Supplementary Table 2 ) for less aggressive contig joining. e , f , Hi-C interaction heat maps before and after manual curation, which identified 34 chromosomes. Grid lines indicate scaffold boundaries. Red arrow, example mis-join that was corrected during curation. g , Karyotype of the identified chromosomes ( n = 36 + ZW), consistent with previous findings 70 . h , Correlation between estimated chromosome sizes (in Mb) based on karyotype images in g and assembled scaffolds in Supplementary Table 4 (bCalAna1) on a log–log scale. v1.0, VGP assembly v1.0 pipeline; linked, 10X Genomics linked reads; Hi-C, Hi-C proximity ligation; 1D, 2D, Oxford Nanopore long reads; NRGene, NRGene paired-end Illumina reads; SR, paired-end Illumina short reads."
          }
        ]
      },
      {
        "id": "Sec3",
        "title": "Iterative assembly pipeline",
        "paragraphs": [
          {
            "id": "Par6",
            "text": "Scaffolds generated with all three scaffolding technologies (that is, 10X Genomics linked reads (10XG), Bionano optical maps (Opt.), and Arima Genomics, Dovetail Genomics, or Phase Genomics Hi-C) were approximately 50% to 150% longer than those generated using one or two technologies, regardless of whether we started with short- or long-read-based contigs (Fig. 1b , Extended Data Fig. 1a , Supplementary Table 3 ). These findings include improvements we made to each approach (Supplementary Note 1 , Supplementary Tables 4 , 5 , Supplementary Fig. 1 ). Despite similar scaffold continuity, the short-read-only assemblies had from about 18,000 to about 70,000 gaps, whereas the long-read assemblies had substantially fewer (about 400 to about 4,000) gaps (Fig. 1c ). Many gaps in the short-read assemblies were in repeat or GC-rich regions. Considering the curated version of this assembly to be more accurate, we also identified roughly 5,000 to 8,000 mis-joins in short-read-based assemblies, whereas long-read-based assemblies had only from 20 to around 700 mis-joins (Fig. 1d ). These mis-joins included chimeric joins and inversions. After we curated this assembly for contamination, assembly errors, and Hi-C-based chromosome assignments (Fig. 1e, f ), the final hummingbird assembly had 33 scaffolds that closely matched the chromosome karyotype in number (33 of 36 autosomes plus sex chromosomes) and estimated sizes (approximately 2 to 200 Mb; Fig. 1g, h ), with only 1 to 30 gaps per autosome (bCalAnn1 in Supplementary Table 6 ). Of the five autosomes with only one gap each, three (chromosomes 14, 15, and 19) had complete spanning support by at least two technologies (reliable blocks, Extended Data Fig. 1c ; bCalAnn1 in Supplementary Table 6 ), indicating that the chromosome contigs were nearly complete. However, they were missing long arrays of vertebrate telomere repeats within 1 kb of their ends (Extended Data Fig. 1c ; bCalAnn1 in Supplementary Tables 6 , 7 )."
          }
        ]
      },
      {
        "id": "Sec4",
        "title": "Assembly pipeline across vertebrate diversity",
        "paragraphs": [
          {
            "id": "Par7",
            "text": "Using the formula that gave the highest-quality hummingbird genome, we built an iterative VGP assembly pipeline (v1.0) with haplotype-separated CLR contigs, followed by scaffolding with linked reads, optical maps, and Hi-C, and then gap filling, base call polishing, and finally manual curation (Extended Data Figs. 2 a, 3a ). We systematically tested our pipeline on 15 additional species spanning all major vertebrate classes: mammals, birds, non-avian reptiles, amphibians, teleost fishes, and a cartilaginous fish (Supplementary Tables 8 , 9 , Supplementary Note 2 ). For the zebra finch, we used DNA from the same male as was used to generate the previous reference genome 19 , and included a female trio for benchmarking haplotype completeness, where sequenced reads from the parents were used to bin parental haplotype reads from the offspring before assembly 20 (Extended Data Figs. 2 a, 3b ). We set initial minimum assembly metric goals of: 1 Mb contig NG50; 10 Mb scaffold NG50; assigning 90% of the sequence to chromosomes, structurally validated by at least two independent lines of evidence; Q40 average base quality; and haplotypes assembled as completely and correctly as possible. When these metrics were achieved, most genes were assembled with gapless exon and intron structures 11 , and fewer than 3% had frame-shift base errors identified in annotation. Q40 is the mathematical inflection point at which genes go from usually containing an error to usually not 21 . Of the curated assemblies (Supplementary Table 10 , Supplementary Note 2 ), 16 of 17 achieved the desired continuity metrics (Extended Data Table 1 ). Scaffold NG50 was significantly correlated with genome size (Fig. 2a ), suggesting that larger genomes tend to have larger chromosomes. On average, 98.3% of the assembled bases had reliable block NG50s ranging from 2.3 to 40.2 Mb; collapsed repeat bases 22 with abnormally high CLR read coverage (more than 3 s.d.) ranged from 0.7 to 31.4 Mb per Gb; and the completeness of the genome assemblies ranged from 87.2 to 98.1%, with less than 4.9% falsely duplicated regions, consistent with the false duplication rate we found for the conserved BUSCO vertebrate gene set (Extended Data Table 1 , Supplementary Tables 11 , 12 ). Fig. 2 Impact of repeats and heterozygosity on assembly quality. a , Correlation between scaffold NG50 and genome size of the curated assemblies. b , Nonlinear correlation between contig NG50 and repeat content, before and after curation. c , Correlation between number of gaps per Gb assembled and repeat content. d , Correlation between primary assembly size relative to estimated genome size ( y axis) and genome heterozygosity ( x axis), before and after purging of false duplications. Assembly sizes above 100% indicate the presence of false duplications and those below 100% indicate collapsed repeats. e , f , Correlations between genome duplication rate using k -mers 23 ( e ) and conserved BUSCO vertebrate gene set ( f ), and genome heterozygosity before and after purging of false duplications. g , h , As in e , f , but with whole-genome repeat content before and after purging of false duplications. Genome size, heterozygosity, and repeat content were estimated from 31-mer counts using GenomeScope 71 , except for the channel bull blenny, as the estimates were unreliable (see Methods ). Repeat content was measured by modelling the k -mer multiplicity from sequencing reads. Sequence duplication rates were estimated with Merqury 23 using 21-mers. * P < 0.05; ** P < 0.01; *** P < 0.001, of the correlation coefficient: P values and adjusted r 2 from F -statistics. n = 17 assemblies of 16 species."
          },
          {
            "id": "",
            "text": "a , Correlation between scaffold NG50 and genome size of the curated assemblies. b , Nonlinear correlation between contig NG50 and repeat content, before and after curation. c , Correlation between number of gaps per Gb assembled and repeat content. d , Correlation between primary assembly size relative to estimated genome size ( y axis) and genome heterozygosity ( x axis), before and after purging of false duplications. Assembly sizes above 100% indicate the presence of false duplications and those below 100% indicate collapsed repeats. e , f , Correlations between genome duplication rate using k -mers 23 ( e ) and conserved BUSCO vertebrate gene set ( f ), and genome heterozygosity before and after purging of false duplications. g , h , As in e , f , but with whole-genome repeat content before and after purging of false duplications. Genome size, heterozygosity, and repeat content were estimated from 31-mer counts using GenomeScope 71 , except for the channel bull blenny, as the estimates were unreliable (see Methods ). Repeat content was measured by modelling the k -mer multiplicity from sequencing reads. Sequence duplication rates were estimated with Merqury 23 using 21-mers. * P < 0.05; ** P < 0.01; *** P < 0.001, of the correlation coefficient: P values and adjusted r 2 from F -statistics. n = 17 assemblies of 16 species."
          }
        ]
      },
      {
        "id": "Sec5",
        "title": "Repeats markedly affect continuity",
        "paragraphs": [
          {
            "id": "Par8",
            "text": "For assemblies generated using our automated pipeline (Extended Data Fig. 3a ) before manual curation, all but 2 (the thorny skate and channel bull blenny) of the 17 assemblies exceeded the desired continuity metrics (Supplementary Table 13 ). In searching for an explanation of these results, we found that contig NG50 decreased exponentially with increasing repeat content, with the thorny skate having the highest repeat content (Fig. 2b , Supplementary Table 13 ). Consequently, after scaffolding and gap filling, we observed a significant positive correlation between repeat content and number of gaps (Fig. 2c ). The kākāpō parrot, which had 15% repeat content, had about 325 gaps per Gb, including 2 of 26 chromosomes with no gaps (chromosomes 16 and 18) and no evidence of collapses or low support, suggesting that the chromosomal contigs were complete (bStrHab1 in Supplementary Table 6 ). By contrast, the thorny skate, with 54% repeat content, had about 1,400 gaps per Gb (Extended Data Table 1 ); none of its 49 chromosomal-level scaffolds contained fewer than eight gaps, and all had some regions that contained collapses or low support (sAmbRad1 in Supplementary Table 6 ). Even after curation and other modifications to increase assembly quality (Supplementary Note 2 ), the number of collapses, their total size, missing bases, and the number of genes in the collapses all correlated with repeat content (Extended Data Fig. 4a–d ). The average collapsed length, however, correlated with average CLR read lengths (10–35 kb; Extended Data Fig. 4e ). There were no correlations between the number of collapsed bases and heterozygosity or genome size (Extended Data Fig. 4f, g ). Depending on species, 77.4 to 99.2% of the collapsed regions consisted of unresolved segmental duplications (Extended Data Fig. 4h ). The remainder were high-copy repeats, mostly of previously unknown types (Extended Data Fig. 4i ), and of known types such as satellite arrays, simple repeats, long terminal repeats (LTRs), and short and long interspersed nuclear elements (SINEs and LINEs), depending on species (Extended Data Fig. 4j ). We found that repeat masking before generating contigs prevented some repeats from making it into the final assembly (Supplementary Note 3 ). All of the above findings quantitatively demonstrate the effect that repeat content has on the ability to produce highly continuous and complete assemblies."
          }
        ]
      },
      {
        "id": "Sec6",
        "title": "Detection and removal of false duplications",
        "paragraphs": [
          {
            "id": "Par9",
            "text": "During curation, we discovered that one of the most common assembly errors was the introduction of false duplications, which can be misinterpreted as exon, whole-gene, or large segmental duplications. We observed two types of false duplication: 1) heterotype duplications, which occurred in regions of increased sequence divergence between paternal and maternal haplotypes, where separate haplotype contigs were incorrectly placed in the primary assembly (Extended Data Fig. 5a ); and 2) homotype duplications, which occurred near contig boundaries or under-collapsed sequences caused by sequencing errors (Extended Data Fig. 5b ). False heterotype duplications appeared to occur with higher heterozygosity. For example, during curation of the female zebra finch genome, we found an approximately 1-Mb falsely duplicated heterozygous sequence (Extended Data Fig. 6a ). This zebra finch individual had the highest heterozygosity (1.6%) relative to all other genomes (0.1–1.1%). Homotype duplications often occurred at contig boundaries, and were approximately the same length as the sequence reads (Extended Data Fig. 6b, c ). We identified and removed false duplications during curation using read coverage, self-, transcript-, optical map- and Hi-C-alignments, and k -mer profiles (Extended Data Fig. 6 , Supplementary Fig. 2 )."
          },
          {
            "id": "Par10",
            "text": "Before we purged false duplications, the primary assembly genome size correlated positively with estimated percentage heterozygosity; more heterozygous genomes tended to have assembly sizes bigger than the estimated haploid genome size (Fig. 2d ). Similarly, the extra duplication rate in the primary assembly, measured using k -mers 23 or conserved vertebrate BUSCO genes 24 , varied from 0.3% to 30% and trended towards correlation with heterozygosity (Fig. 2e, f , Supplementary Table 13 ). Apparent false gene duplication rates correlated more strongly with the overall repeat rate in the assemblies (Fig. 2g, h ). To remove these false duplications automatically, we initially used Purge_Haplotigs 13 , which removed retained falsely duplicated contigs that were not scaffolded (Extended Data Fig. 5 ; VGP v1.0–1.5). Later, we developed Purge_Dups 14 to remove both falsely retained contigs and end-to-end duplicated contigs within scaffolds (Extended Data Fig. 5 ; VGP v1.6), which reduced the amount of manual curation. After we applied these tools, the primary assembly sizes and the k -mer and BUSCO gene duplication rates were all reduced, and their correlations with heterozygosity and repeat content were also reduced or eliminated (Fig. 2d–h ). These findings indicate that it is essential to properly phase haplotypes and to obtain high consensus sequence accuracy in order to prevent false duplications and associated biologically false conclusions."
          }
        ]
      },
      {
        "id": "Sec7",
        "title": "Curation is needed for a high-quality reference",
        "paragraphs": [
          {
            "id": "Par11",
            "text": "Each automated scaffolding method introduced tens to thousands of unique joins and breaks in contigs or scaffolds (Supplementary Table 14 ). Depending on species, the first scaffolding step with linked reads introduced about 50–900 joins between CLR-generated contigs. Optical maps introduced a further roughly 30–3,500 joins, followed by Hi-C with about 30–700 more joins, and each identified up to several dozen joins that were inconsistent with the previous scaffolding step. Manual curation resulted in an additional 7,262 total interventions for 19 genome assemblies or 236 interventions per Gb of sequence (Supplementary Table 15 ). When a genome assembly was available for the same or a closely related species, it was used to confirm putative chromosomal breakpoints or rearrangements (Supplementary Table 15 ). These interventions indicate that even with current state-of-the-art assembly algorithms, curation is essential for completing high-quality reference assemblies and for providing iterative feedback to improve assembly algorithms. A further description of our curation approach and analyses of VGP genomes are presented elsewhere 25 ."
          }
        ]
      },
      {
        "id": "Sec8",
        "title": "Hi-C scaffolding and cytological mapping",
        "paragraphs": [
          {
            "id": "Par12",
            "text": "Most large assembled scaffolds of each species spanned entire chromosomes, as shown by the relatively clean Hi-C heat map plots across each scaffold after curation (Extended Data Fig. 7 ), near perfect correlation between chromosomal scaffold length and karyotypically determined chromosome length (Fig. 1h ), and the presence of telomeric repeat motifs on some scaffold ends (Supplementary Table 7 ). In our VGP zebra finch assembly, all inferred chromosomes were consistent with previously identified linkage groups in the Sanger-based reference, except for chromosomes 1 and 1B (Extended Data Fig. 8a ). Their join in the VGP assembly was supported by both single CLR reads and optical maps through the junction. We also corrected nine inversion errors and filled in large gaps at some chromosome ends. In the platypus, we identified 18 structural differences in 13 scaffolds between the VGP assembly and the previous Sanger-based reference anchored to chromosomes using fluorescence in situ hybridization (FISH) physical mapping (Extended Data Fig. 8b , Supplementary Table 16 ). Of these 18, all were supported with Hi-C, and seven were also supported by both CLR and optical maps in the VGP assembly. Our platypus assembly also filled in many large (approximately 1–30 Mb) gaps and corrected many inversion errors (Extended Data Fig. 8b ). Furthermore, we identified seven additional chromosomes (chromosomes 30–36) in the zebra finch, and eight (chromosomes 8, 9, 14, 15, 17, 19, 21, and X4; Extended Data Fig. 8a, b ) in the platypus 26 , 27 . Relative to the VGP assembly, the earlier short-read Anna’s hummingbird assembly was highly fragmented (Extended Data Fig. 8c ), despite being scaffolded with seven different Illumina libraries spanning a wide range of insert sizes (0.2–20 kb). The previous climbing perch assembled chromosomes were even more fragmented and also had large gaps of missing sequence (Extended Data Fig. 8d ). On average, 97% ± 3% (s.d.) of the assembled bases were assigned to chromosomes (Extended Data Table 1 ), compared with 76% and 32% in the prior zebra finch and platypus references, respectively. We believe the comparable or higher accuracy of Hi-C relative to genetic linkage or FISH physical mapping is due to the higher sampling rate of Hi-C pairs across the genome. Nonetheless, visual karyotyping is useful for complementary validation of chromosome count and structure 28 ."
          }
        ]
      },
      {
        "id": "Sec9",
        "title": "Trios help to resolve haplotypes",
        "paragraphs": [
          {
            "id": "Par13",
            "text": "We were able to assemble the trio-based female zebra finch contigs into separate maternal and paternal chromosome-level scaffolds (Extended Data Fig. 9a ) using our VGP trio pipeline (Extended Data Fig. 3b ). Compared to the non-trio assembly of the same individual, the trio version had seven- to eightfold fewer false duplications ( k -mer and BUSCO dups in Supplementary Tables 11 , 12 ), well-preserved haplotype-specific variants ( k -mer precision/recall 99.99/97.08%), and higher base call accuracy, exceeding Q43 for both haplotypes (Extended Data Table 1 ). The trio-based assembly was the only assembly with nearly perfect (99.99%) separation of maternal and paternal haplotypes, determined using k -mers specific to each 23 . We identified haplotype-specific structural variants, including inversions of 4.5 to 12.5 Mb on chromosomes 5, 11, and 13 that were not readily identifiable in the non-trio version (Extended Data Fig. 10a–e ). Moving forward, the VGP is prioritising the collection of mother–father–offspring trios where possible, or single parent–offspring duos, to assist with diploid assembly and phasing, as well as the development of improved methods for the assembly of diploid genomes in the absence of parental genomic data, as described in another study 29 ."
          }
        ]
      },
      {
        "id": "Sec10",
        "title": "Effects of polishing on accuracy",
        "paragraphs": [
          {
            "id": "Par14",
            "text": "Despite their increased continuity and structural accuracy, CLR-based assemblies required at least two rounds of short-read consensus polishing to reach 99.99% base-level accuracy (one error per 10 kb, Phred 30 Q40; Supplementary Table 5 ). Before polishing, the per-base accuracy was Q30–35 (calculated using k -mers). The most common errors were short indels from inaccurate consensus calling during CLR contig formation, which resulted in amino acid frameshift errors. Using our combined approach of long-read and short-read polishing applied on both primary and alternate haplotype sequences together, we polished from 82% to 99.7% of the primary and about 91.3% of the alternate assembly (Supplementary Table 17 ). Of the remaining unpolished sequence, one haplotype was sometimes reconstructed at substantially lower quality, because most reads aligned to the higher quality haplotype (Extended Data Fig. 11a ). False duplications had similar effects, where the duplicated sequence acted as an attractor during the read mapping. Haplotypes in the more homozygous regions tended to be collapsed by FALCON-Unzip 17 . All such cases recruited reads from both haplotypes and thereby caused switch errors, which we confirmed in the trio-based assembly and fixed when excluding read pairs from the other haplotype during polishing (Extended Data Fig. 11b ). These findings indicate that both sequence read accuracy and careful haplotype separation are important for producing accurate assemblies."
          }
        ]
      },
      {
        "id": "Sec11",
        "title": "Sex chromosomes and mitochondrial genomes",
        "paragraphs": [
          {
            "id": "Par15",
            "text": "Sex chromosomes have been notoriously difficult to assemble, owing to their greater divergence relative to autosomes and high repeat content 31 . We successfully assembled both sex chromosomes (Z, W) for all three avian species, the first W chromosome (to our knowledge) for vocal learning birds (Extended Data Figs. 7 , 9b ), the X and/or Y chromosome in placental mammals (Canada lynx and two bat species), the X chromosome in the thorny skate, and for the first time, to our knowledge, all ten sex chromosomes (5X and 5Y) in the platypus 26 (Extended Data Fig. 9c ). The completeness and continuity of the zebra finch Z and W chromosomes were further improved by the trio-based assembly (Extended Data Fig. 9b ). However, the sex chromosome assemblies were still more fragmented than the autosomes, probably owing to their lower sequencing depth and high repeat content."
          },
          {
            "id": "Par16",
            "text": "Mitochondrial (MT) genomes, which are expected to be 11–28 kb in size 32 , were initially found in only six assemblies (Supplementary Table 18 ). The MT-derived raw reads were present, but they failed to assemble, in part because of minimum read-length cutoffs for the starting contig assembly. Furthermore, if the MT genome was not present during nuclear genome polishing, the raw MT reads were attracted to nuclear MT sequences (NuMTs), incorrectly converting them to the full organelle MT sequence (Extended Data Fig. 11c ). To address these issues, we developed a reference-guided MT pipeline and included the MT genome during polishing 33 (Extended Data Fig. 3c ; VGP v1.6). With these improvements, we reliably assembled 16 of 17 MT genomes (Supplementary Table 18 ) and discovered 2 kb of an 83-bp repeat expansion within the control region in the kākāpō (Extended Data Fig. 9d ), and Nad1 and trnL2 gene duplications in the climbing perch (Extended Data Fig. 9e ). These duplications were verified using single-molecule CLR reads that spanned the duplication junctions or even the entire MT genome. Their absence in previous MT references 34 , 35 is likely to result from the inability of Sanger or short reads to correctly resolve large duplications. More details on the MT-VGP pipeline and new biological discoveries are reported elsewhere 33 ."
          }
        ]
      },
      {
        "id": "Sec12",
        "title": "Improvements to read alignment and annotation",
        "paragraphs": [
          {
            "id": "Par17",
            "text": "Compared to previous Sanger (zebra finch and platypus) and Illumina (Anna’s hummingbird and climbing perch) assemblies, we added about 42–176 Mb of missing sequence and placed 68.5 Mb (zebra finch) to 1.8 Gb (platypus) of previously unplaced sequence within chromosomes. We corrected about 7,800–64,000 mis-joins, and closed 55,177–193,137 gaps per genome (Supplementary Table 19 ). Consistent with these improvements, both transcriptome RNA sequencing (RNA-seq) data (Fig. 3a ) and genome assay for transposase-accessible chromatin using sequencing (ATAC–seq) data (Fig. 3b ) aligned with about 5 to 10% greater mapability to our new VGP assemblies compared with the previous assemblies. The NCBI RefSeq and EBI Ensembl annotations revealed: 5,434 to 14,073 more protein-coding transcripts per species, with 94.1 to 97.8% fully supported (Fig. 3c , Supplementary Table 20 ); only about 100 to 300 partially assembled coding genes, compared with about 1,600 to 5,600 (Fig. 3d ); more orthologous coding genes shared with human; and fewer transcripts that required corrections to compensate for premature stop codons or frame-shift indel errors (Extended Data Table 2 ). The total number of genes annotated went down in the VGP assemblies (Extended Data Table 2 ), partly because there were fewer false duplications (Supplementary Table 19 ). Supporting these results, the VGP assemblies had 0 to 13% higher k -mer completeness (95% mean ± 3.5% s.d. versus 88 ± 4.3%; Extended Data Table 2 , Supplementary Table 19 ; P = 0.0047, n = 4 prior and 17 VGP assemblies, unpaired t -test). Fig. 3 Improvements to alignments and annotations in VGP assemblies relative to prior references. a , b , Average percentage of RNA-seq transcriptome samples ( a ; n = 44, mean ± s.e.m.) and ATAC–seq genome reads ( b ; n = 12) that align to the previous and VGP zebra finch assemblies. Unique reads mapped to only one location in the assembly. Total is the sum of unique and multi-mapped reads. P values are from paired t -test. c , d , Total number of coding sequence (CDS) transcripts (full bar) and portion fully supported (inner bar) ( c ) and the number of RefSeq coding genes annotated as partial ( d ) in the previous and VGP assemblies using the same input data. e – h , Examples of assembly and associated annotation errors in previous reference assemblies corrected in the new VGP assemblies. See main text for descriptions. i , Gene synteny around the VTR2C receptor in the platypus shows completely missing genes ( NUDT16 ), truncated and duplicated ARHGAP4 , and many gaps in the earlier Sanger-based assembly compared with the filled in and expanded gene lengths in the new VGP assembly. Assembly accessions are in Supplementary Table 19 ."
          },
          {
            "id": "",
            "text": "a , b , Average percentage of RNA-seq transcriptome samples ( a ; n = 44, mean ± s.e.m.) and ATAC–seq genome reads ( b ; n = 12) that align to the previous and VGP zebra finch assemblies. Unique reads mapped to only one location in the assembly. Total is the sum of unique and multi-mapped reads. P values are from paired t -test. c , d , Total number of coding sequence (CDS) transcripts (full bar) and portion fully supported (inner bar) ( c ) and the number of RefSeq coding genes annotated as partial ( d ) in the previous and VGP assemblies using the same input data. e – h , Examples of assembly and associated annotation errors in previous reference assemblies corrected in the new VGP assemblies. See main text for descriptions. i , Gene synteny around the VTR2C receptor in the platypus shows completely missing genes ( NUDT16 ), truncated and duplicated ARHGAP4 , and many gaps in the earlier Sanger-based assembly compared with the filled in and expanded gene lengths in the new VGP assembly. Assembly accessions are in Supplementary Table 19 ."
          },
          {
            "id": "Par18",
            "text": "An example of a whole-gene heterotype false duplication in the RefSeq annotation of the previous zebra finch reference 19 is the BUSCO gene SPC25 36 , for which each haplotype was correctly placed in the VGP primary and alternate assemblies (Fig. 3e ). The GABRG2 receptor, which shows specialized expression in vocal learning circuits 37 , had a partial tandem duplication of four of its ten exons, resulting in annotated partial false tandem gene duplications ( GABRG2 and GABRG2 -like; Fig. 3f ). The vitellogenin-2 ( VTG2 ) gene, a component of egg yolk in all egg-laying species 38 , was distributed across 14 contigs in 3 different scaffolds in the previous platypus assembly (Fig. 3g ). Two of these scaffolds received two corresponding VTG2 -like gene annotations, and the third was included as false duplicated intron in CAPN-13 (red), together causing false amino acid sequences in five exons (blue). The BUSCO YIPF6 gene, which is associated with inflammatory bowel disease 39 , was split between two different scaffolds and is thus presumed to be a gene loss in the earlier climbing perch assembly 40 (Fig. 3h ). Each of these genes is now present on long VGP contigs, within validated blocks, with no gaps and no false gene gains or losses (Supplementary Table 21 )."
          },
          {
            "id": "Par19",
            "text": "Going beyond individual genes, a ten-gene synteny window surrounding the vasotocin receptor 2C gene ( VTR2C ; also known as AVPR2 ), which is involved in blood pressure homeostasis and brain function 41 , 42 , was split into 34 contigs on four scaffolds, one of which contained a false haplotype duplication of ARHGAP4 in the previous platypus assembly 43 (Fig. 3i ). In our VGP assembly, all eleven genes were in one 37-Mb-long contig within the approximately 50 Mb chromosome 6 scaffold. Furthermore, eight of the eleven genes were remarkably increased in size owing to the addition of previously unknown missing sequences. This chromosomal region was more GC-rich (54%) than the entire chromosome 6 (46%). Thousands of such false gains and losses in previous reference assemblies have been corrected in our VGP assemblies (more details in refs. 27 , 44 ), demonstrating that assembly quality has a critical effect on subsequent annotations and functional genomics."
          }
        ]
      },
      {
        "id": "Sec13",
        "title": "GC-rich regulatory regions of coding genes",
        "paragraphs": [
          {
            "id": "Par20",
            "text": "We tested whether the higher-quality VGP assemblies enabled new biological discoveries. Notably, beginning about 1.5 kb upstream of protein-coding genes, in 100-bp blocks, there was a steady increase from about 6–20% to about 30–55% of genes having missing sequence in previous references (Fig. 4a ); similarly high proportions of genes were missing their subsequent 5′ untranslated regions (UTRs) and first exons. This fluctuation in missing sequence was directly proportional to GC content (Fig. 4a ). We therefore studied the GC content pattern across all protein-coding genes in all 16 new VGP assemblies and found a genome-wide signature: a rapid rise in GC content in the roughly 1.5 kb before the transcription start site, in the 5′ UTR, and in the first exon, followed by a steady decrease in subsequent exons and returning to near intergenic background levels in the 3′ UTR and about 1.5 kb after the transcription termination site (Fig. 4b ). The introns had lower GC content, closer to the intergenic background. The intergenic GC content was stable within 30 kb on either side of each gene (Fig. 4b ). Mammals, birds, and reptiles had the highest increase (around 20%) in GC content near the start site, followed by the amphibian and skate with medium levels (around 10%). Teleost fishes showed an initial decrease, followed by weaker increase (about 5%) from an already lower GC content (Fig. 4b ). Given that the skate represents the sister branch to all other vertebrate lineages sequenced, these findings suggest that teleosts lost at least 5% GC content genome-wide, while maintaining most of the GC content pattern in protein-coding genes. Although it is known that promoter regions can be CpG rich, and GC content can vary between exons and introns 45 , 46 , such a systematic pattern, the lineage-specific differences within vertebrates, and the magnitude of these differences had not been previously described, to our knowledge. Fig. 4 VGP assemblies reveal GC content patterns in protein-coding genes. a , Average GC content ( n = 14,000–18,000 annotated coding genes; Extended Data Table 2 ) in VGP assemblies (black) and the percentage of genes with missing sequence in the earlier references (red) based on a Cactus alignment, in 100-bp blocks, 2 kb on either side of all protein-coding genes (left and right), and for UTRs, exons, and introns (middle). b , Average GC content (mean ± s.d. for lineages with more than one species) of the six major vertebrate lineages sequenced, for 30 kb upstream and downstream (in 100-bp blocks, log scale; left and right) and of the UTR, exons, and introns (middle). c , d , Left, specialized expression (arrows) shown by in situ hybridization of DRD1B in the zebra finch striatum ( c ) and ER81 in the arcopallium ( d ), from Jarvis et al. 47 ; the cerebellum was removed from the ER81 image. Right, ATAC–seq profiles in the GC-rich promoter regions of these genes, showing each gene’s GC content (red is high), the ATAC–seq peaks in striatum (purple) or arcopallium (yellow) neurons, and portions of missing sequence (black) in the previous reference assembly (grey)."
          },
          {
            "id": "",
            "text": "a , Average GC content ( n = 14,000–18,000 annotated coding genes; Extended Data Table 2 ) in VGP assemblies (black) and the percentage of genes with missing sequence in the earlier references (red) based on a Cactus alignment, in 100-bp blocks, 2 kb on either side of all protein-coding genes (left and right), and for UTRs, exons, and introns (middle). b , Average GC content (mean ± s.d. for lineages with more than one species) of the six major vertebrate lineages sequenced, for 30 kb upstream and downstream (in 100-bp blocks, log scale; left and right) and of the UTR, exons, and introns (middle). c , d , Left, specialized expression (arrows) shown by in situ hybridization of DRD1B in the zebra finch striatum ( c ) and ER81 in the arcopallium ( d ), from Jarvis et al. 47 ; the cerebellum was removed from the ER81 image. Right, ATAC–seq profiles in the GC-rich promoter regions of these genes, showing each gene’s GC content (red is high), the ATAC–seq peaks in striatum (purple) or arcopallium (yellow) neurons, and portions of missing sequence (black) in the previous reference assembly (grey)."
          },
          {
            "id": "Par21",
            "text": "We tested whether the newly assembled GC-rich promoter regions contained novel regulatory sequences. Analysing the zebra finch brain, we found that genes with upregulated expression specific to the striatum (for example, DRD1B , which encodes a dopamine receptor) had ATAC-seq peaks in the GC-rich promoter and 5′ UTR region in striatal neurons, but not in arcopallium neurons (Fig. 4c ); conversely, genes (for example, the ER81 transcription factor) with upregulated expression in the arcopallium (mammalian cortex layer 5 equivalent 47 ) had ATAC–seq peaks in the GC-rich region in arcopallium neurons but not striatal neurons (Fig. 4d ). These GC-rich regions were missing in the earlier assembly. In addition, the missing region in DRD1B led to a false annotation as a two-exon gene 48 , whereas the VGP assembly revealed a single-exon gene (Fig. 4c ). These GC-rich promoter regions are candidates for driving cell-type-specific expression. These findings demonstrate the importance of using sequencing chemistry that reads through GC-rich regions, like the CLR method. The earlier hummingbird genome assembly was generated using Illumina TruSeq3 chemistry 16 , which was designed to read through GC-rich regions, and yet about 55% of the genes were missing the 100-bp GC-rich region before the start site (Fig. 4a ). Another paper contains additional findings on missing regions 27 ."
          }
        ]
      },
      {
        "id": "Sec14",
        "title": "Chromosomal evolution",
        "paragraphs": [
          {
            "id": "Par22",
            "text": "We next investigated whether we could gain new insights into chromosome evolution among vertebrates. Given the more than 430 million years (Myr) of evolutionary divergence among the species sampled here, it was difficult to generate whole genome-to-genome alignments across all species. Thus, we focused our initial analyses on 1,147 highly conserved BUSCO vertebrate genes that are shared among our assemblies of all 16 species and the human reference (GRCh38). Human chromosomes mapped with greater orthology to 3.7 ± 1.3 (s.d.) chromosomes on average in other mammals, compared to 5.6 ± 2.2 in amphibians and 9.6 ± 3.3 in teleost fishes (Fig. 5a , Supplementary Table 22 ). The skate chromosome arrangement was more conserved with tetrapods, mapping to 2.9 ± 1.4 chromosomes on average, compared to 4.8 ± 2.5 in teleost fishes. These findings indicate that, along with a reduction in GC content, the teleost lineage has experienced more massive chromosome rearrangements since divergence from their most recent common ancestor with tetrapods, consistent with a proposed higher rearrangement rate in teleosts 49 . Fig. 5 Chromosome evolution among bats and other vertebrates. a , Chromosome synteny maps across the species sequenced based on BUSCO gene alignments. Chromosome sizes (bar lengths) are normalized to genome size, to make visualization easier. Genes (lines) are coloured according to the human chromosome to which they belong; those on human chromosome 6 are highlighted in blue and other chromosomes are in lighter shades. The cladogram is from the TimeTree database 72 . b , Phylogenetic relationship of the mammalian species sequenced and their inferred chromosome EBR rates (breaks per Myr) on different branches. Red, higher rates than average (0.84); blue, lower than average. c , Summary of alignment, gene organization, and functional gene status surrounding a bat interchromosomal EBR involving the homologue of human chromosome 6. End of scaffold (S) or chromosome (Chr.) means that the breakpoint is located at a chromosome arm end; middle means that it is located within a scaffold or chromosome. Scale is relevant for human Chr. 6 only. Actual gene sizes in the non-human species may differ and were drawn to match the annotated human gene sizes for simplicity."
          },
          {
            "id": "",
            "text": "a , Chromosome synteny maps across the species sequenced based on BUSCO gene alignments. Chromosome sizes (bar lengths) are normalized to genome size, to make visualization easier. Genes (lines) are coloured according to the human chromosome to which they belong; those on human chromosome 6 are highlighted in blue and other chromosomes are in lighter shades. The cladogram is from the TimeTree database 72 . b , Phylogenetic relationship of the mammalian species sequenced and their inferred chromosome EBR rates (breaks per Myr) on different branches. Red, higher rates than average (0.84); blue, lower than average. c , Summary of alignment, gene organization, and functional gene status surrounding a bat interchromosomal EBR involving the homologue of human chromosome 6. End of scaffold (S) or chromosome (Chr.) means that the breakpoint is located at a chromosome arm end; middle means that it is located within a scaffold or chromosome. Scale is relevant for human Chr. 6 only. Actual gene sizes in the non-human species may differ and were drawn to match the annotated human gene sizes for simplicity."
          },
          {
            "id": "Par23",
            "text": "To determine the precise locations of chromosome rearrangements between species, we focused on a shorter evolutionary distance of around 180 Myr among mammals, and added four additional bat species described in our Bat1K study 50 , the human genome reference 51 (GRCh38.p12), and a recently upgraded long-read chicken reference 52 (galGal6a) as an outgroup. Pairwise whole-genome alignments to the human reference defined homologous synteny blocks and evolutionary breakpoint regions (EBRs) among the species. We found that breakpoint rates (EBRs per Myr) tripled among bats soon after the last mass extinction event (about 66 million years ago (Mya)), a time of rapid bat superfamily divergences 53 (about 60 Mya; Fig. 5b ). Some rearrangements affected genes. For example, a 1.3-Mb inversion in greater horseshoe bat chromosome 28 (homologous to 29.5 Mb of human chromosome 15; Extended Data Fig. 12a ) disrupted STARD5 , a gene involved in cholesterol homeostasis in liver cells 54 . The rearrangement separated exons 1–5 from exon 6, and disrupted splicing of the transcripts (Extended Data Fig. 12b ). Another example was an EBR that involved fission of an ancestral bat chromosome homologue of human chromosome 6 (boreoeutherian mammal chromosome 5 55 ) and was later reused among the different bat lineages in rearrangements that involved the ancestral homologues of human chromosomes 1, 2 and 6 (Fig. 5c , Extended Data Fig. 12c ). We also noted a fission in this region in the mouse, rat, and dog genomes 55 . On the basis of the conserved gene order in human and Canada lynx, we inferred that the boreoeutherian ancestral mammal locus corresponding to human 6p22.1 contained 12 genes, including four ZSCAN and two ZKSCAN transcription factors, and two GPX enzyme genes, all associated with sequentially increasing independent gene losses in bats (Fig. 5d ). For example, the greater horseshoe bat lost only ZSCAN12 and GPX6 to pseudogenization, whereas Kuhl’s pipistrelle lost all 12 genes. ZSCAN and ZKSCAN are involved in cell differentiation, migration and invasion, proliferation, apoptosis, and innate immunity 56 . We speculate that loss of ZSCAN12 in all six bats could contribute to their immune tolerance to pathogens 50 ."
          },
          {
            "id": "Par24",
            "text": "Other biological findings using these VGP assemblies are published elsewhere, and include: 1) more accurate synteny across species, leading to a better understanding of the evolution of and thus a universal nomenclature for the vasotocin (also known as vasopressin) and oxytocin ligand and receptor gene families 57 ; 2) greater understanding of the evolution of the carbohydrate 6- O sulfotransferase gene family, which encodes enzymes that modify secreted carbohydrates 58 ; 3) the first Bat1K study 50 , which generated a genome-scale phylogeny that better resolves the relationships between bats and other mammals, and which identified changes in bat genes that are involved in immunity and life span, including genes that are relevant to the COVID-19 pandemic 59 ; 4) deleterious mutations that have been purged from the last surviving isolated and inbred population of the critically endangered kākāpō 60 ; and 5) more complete resolution of the evolution of the complex sex chromosomes in platypus and echidna 26 . These discoveries were not possible with the previous reference assemblies, and we expect many future discoveries to follow."
          }
        ]
      },
      {
        "id": "Sec15",
        "title": "Proposed assembly quality metrics",
        "paragraphs": [
          {
            "id": "Par25",
            "text": "Drawing on the lessons learned from this work, we propose that assembly quality should be summarized using 14 metrics under 6 categories (Table 1 ; full details in Supplementary Note 4 ). We summarize the most critical and commonly used metrics using the simple notation x . y . P . Q . C , where: x = log 10 [contig NG50], y = log 10 [scaffold NG50], P = log 10 [haplotype phase block NG50], Q = QV base accuracy, and C = percentage of the assembly assigned to chromosomes (Table 1 ). Our current minimum VGP standard, for example, is 6.7.P5.Q40.C90. This revises our prior notation 50 , 61 , 62 , which reported log-scaled continuity measured in ‘kilobases’ rather than ‘bases’. The thresholds we chose were based on empirical and quantitative observations between what is achievable currently and what is aspirational, and the question the assemblies are meant to answer. For example, the short-read paired-end library-based assemblies of the B10K Phase 1 genomes in 2014 16 and the 10XG linked-read assembly of the Anna’s hummingbird presented here would be categorized as a 4.5.P7.Q50 assembly, with low continuity but high base accuracy (Table 1 ). Such a genome would be suitable for use in phylogenomics 63 and for population-scale SNP surveys 64 . If, instead, a genome is to be used to study chromosomal evolution, then the VGP-2016 minimum metric 6.7.P5.Q40.C95, with high structural and base accuracies and more than 95% assigned to chromosomes (Table 1 ), would be necessary. If having GC-rich promoter regions and complete 5′ exons in most genes is essential, then long-read approaches that sequence through these regions are necessary. ‘Finished’ quality (Table 1 ) is obviously the ideal assembly result, but this level of quality is currently routine only for bacterial and non-vertebrate model organisms with smaller genome sizes that lack large centromeric satellite arrays 65 , 66 – 67 and for organelle genomes, as presented here 33 . The possibility of achieving complete, telomere-to-telomere assemblies of vertebrate and other eukaryotic species is foreseeable, given some assembled avian and bat chromosomes with zero gaps in this study, and the recent complete assembly of two human chromosomes 68 , 69 . Table 1 Proposed standards and metrics for defining genome assembly quality Quality category Metric Finished VGP-2020 VGP-2016 B10k-2014 This study Notation x.y.P.Q.C c.c.Pc.Q60.C100 7.c.P6.Q50.C95 6.7.P5.Q40.C90 4.5.Q30 Continuity Contig NG50 ( x ) = Chr. NG50 >10 Mb >1 Mb >10 kb 1–25 Mb Scaffolds NG50 ( y ) = Chr. NG50 = Chr. NG50 >10 Mb >100 kb 23–480 Mb Gaps per Gb No gaps <200 <1,000 <10,000 75–1,500 Structural accuracy Reliable blocks = Chr. NG50 >10 Mb >1 Mb Not required 2.3–40.2 Mb False duplications 0% <1% <5% <10% 0.2–5.0% Curation Conflicts resolved Manual Manual Not required Manual Base accuracy Base pair QV ( Q ) >60 >50 >40 >30 39–43 k -mer completeness 100% complete >95% >90% >80% 87–98% Haplotype phasing Phase block NG50 ( P ) = Chr. NG50 >1 Mb >100 kb Not required 1.6 Mb a Functional completeness Genes >98% complete >95% complete >90% >80% 82–98% Transcript mappability >98% >90% >80% >70% 96% Chromosome status Assigned (C) >100% >95% >90% Not required 94.4–99.9% Sex chromosomes Right order, no gaps Localized homo pairs At least one shared (for example, X or Z) Fragmented At least one shared Organelles (for example, MT) One complete allele One complete allele Fragmented Not required One complete allele The six broad quality categories in the first column are split into sub-metrics in the second column. The recommendations for draft to finished qualities (columns 3–6) are based on those achieved in past studies 16 , 19 , 63 , this study, and what we aspire to. In the x.y.P.Q.C notation, x = log 10 [contig NG50]; y = log 10 [scaffold NG50]; P = log 10 [haplotype phased NG50 block]; Q = Phred base accuracy QV; and C = percentage of the assembly assigned to chromosomes. c denotes ‘complete’ telomere-to-telomere continuity. The VGP assemblies (last column) satisfy the 6.7.6.Q40.C90 standard, but some come close to achieving a higher 7.c.7.Q50.C95 standard. These metrics apply to genomes about 1 Gb or bigger. a Phase blocks calculated for the zebra finch non-trio assembly using haplotype specific k -mers from parental data 20 ; the trio assemblies had NG50 phase blocks of 17.3 Mb (maternal) and 56.6 Mb (paternal)."
          },
          {
            "id": "",
            "text": "Proposed standards and metrics for defining genome assembly quality"
          },
          {
            "id": "",
            "text": "Quality category"
          },
          {
            "id": "",
            "text": "Metric"
          },
          {
            "id": "",
            "text": "Finished"
          },
          {
            "id": "",
            "text": "VGP-2020"
          },
          {
            "id": "",
            "text": "VGP-2016"
          },
          {
            "id": "",
            "text": "B10k-2014"
          },
          {
            "id": "",
            "text": "This study"
          },
          {
            "id": "",
            "text": "Notation"
          },
          {
            "id": "",
            "text": "x.y.P.Q.C"
          },
          {
            "id": "",
            "text": "c.c.Pc.Q60.C100"
          },
          {
            "id": "",
            "text": "7.c.P6.Q50.C95"
          },
          {
            "id": "",
            "text": "6.7.P5.Q40.C90"
          },
          {
            "id": "",
            "text": "4.5.Q30"
          },
          {
            "id": "",
            "text": "Continuity"
          },
          {
            "id": "",
            "text": "Contig NG50 ( x )"
          },
          {
            "id": "",
            "text": "= Chr. NG50"
          },
          {
            "id": "",
            "text": ">10 Mb"
          },
          {
            "id": "",
            "text": ">1 Mb"
          },
          {
            "id": "",
            "text": ">10 kb"
          },
          {
            "id": "",
            "text": "1–25 Mb"
          },
          {
            "id": "",
            "text": "Scaffolds NG50 ( y )"
          },
          {
            "id": "",
            "text": "= Chr. NG50"
          },
          {
            "id": "",
            "text": "= Chr. NG50"
          },
          {
            "id": "",
            "text": ">10 Mb"
          },
          {
            "id": "",
            "text": ">100 kb"
          },
          {
            "id": "",
            "text": "23–480 Mb"
          },
          {
            "id": "",
            "text": "Gaps per Gb"
          },
          {
            "id": "",
            "text": "No gaps"
          },
          {
            "id": "",
            "text": "<200"
          },
          {
            "id": "",
            "text": "<1,000"
          },
          {
            "id": "",
            "text": "<10,000"
          },
          {
            "id": "",
            "text": "75–1,500"
          },
          {
            "id": "",
            "text": "Structural accuracy"
          },
          {
            "id": "",
            "text": "Reliable blocks"
          },
          {
            "id": "",
            "text": "= Chr. NG50"
          },
          {
            "id": "",
            "text": ">10 Mb"
          },
          {
            "id": "",
            "text": ">1 Mb"
          },
          {
            "id": "",
            "text": "Not required"
          },
          {
            "id": "",
            "text": "2.3–40.2 Mb"
          },
          {
            "id": "",
            "text": "False duplications"
          },
          {
            "id": "",
            "text": "0%"
          },
          {
            "id": "",
            "text": "<1%"
          },
          {
            "id": "",
            "text": "<5%"
          },
          {
            "id": "",
            "text": "<10%"
          },
          {
            "id": "",
            "text": "0.2–5.0%"
          },
          {
            "id": "",
            "text": "Curation"
          },
          {
            "id": "",
            "text": "Conflicts resolved"
          },
          {
            "id": "",
            "text": "Manual"
          },
          {
            "id": "",
            "text": "Manual"
          },
          {
            "id": "",
            "text": "Not required"
          },
          {
            "id": "",
            "text": "Manual"
          },
          {
            "id": "",
            "text": "Base accuracy"
          },
          {
            "id": "",
            "text": "Base pair QV ( Q )"
          },
          {
            "id": "",
            "text": ">60"
          },
          {
            "id": "",
            "text": ">50"
          },
          {
            "id": "",
            "text": ">40"
          },
          {
            "id": "",
            "text": ">30"
          },
          {
            "id": "",
            "text": "39–43"
          },
          {
            "id": "",
            "text": "k -mer completeness"
          },
          {
            "id": "",
            "text": "100% complete"
          },
          {
            "id": "",
            "text": ">95%"
          },
          {
            "id": "",
            "text": ">90%"
          },
          {
            "id": "",
            "text": ">80%"
          },
          {
            "id": "",
            "text": "87–98%"
          },
          {
            "id": "",
            "text": "Haplotype phasing"
          },
          {
            "id": "",
            "text": "Phase block NG50 ( P )"
          },
          {
            "id": "",
            "text": "= Chr. NG50"
          },
          {
            "id": "",
            "text": ">1 Mb"
          },
          {
            "id": "",
            "text": ">100 kb"
          },
          {
            "id": "",
            "text": "Not required"
          },
          {
            "id": "",
            "text": "1.6 Mb a"
          },
          {
            "id": "",
            "text": "Functional completeness"
          },
          {
            "id": "",
            "text": "Genes"
          },
          {
            "id": "",
            "text": ">98% complete"
          },
          {
            "id": "",
            "text": ">95% complete"
          },
          {
            "id": "",
            "text": ">90%"
          },
          {
            "id": "",
            "text": ">80%"
          },
          {
            "id": "",
            "text": "82–98%"
          },
          {
            "id": "",
            "text": "Transcript mappability"
          },
          {
            "id": "",
            "text": ">98%"
          },
          {
            "id": "",
            "text": ">90%"
          },
          {
            "id": "",
            "text": ">80%"
          },
          {
            "id": "",
            "text": ">70%"
          },
          {
            "id": "",
            "text": "96%"
          },
          {
            "id": "",
            "text": "Chromosome status"
          },
          {
            "id": "",
            "text": "Assigned (C)"
          },
          {
            "id": "",
            "text": ">100%"
          },
          {
            "id": "",
            "text": ">95%"
          },
          {
            "id": "",
            "text": ">90%"
          },
          {
            "id": "",
            "text": "Not required"
          },
          {
            "id": "",
            "text": "94.4–99.9%"
          },
          {
            "id": "",
            "text": "Sex chromosomes"
          },
          {
            "id": "",
            "text": "Right order, no gaps"
          },
          {
            "id": "",
            "text": "Localized homo pairs"
          },
          {
            "id": "",
            "text": "At least one shared (for example, X or Z)"
          },
          {
            "id": "",
            "text": "Fragmented"
          },
          {
            "id": "",
            "text": "At least one shared"
          },
          {
            "id": "",
            "text": "Organelles (for example, MT)"
          },
          {
            "id": "",
            "text": "One complete allele"
          },
          {
            "id": "",
            "text": "One complete allele"
          },
          {
            "id": "",
            "text": "Fragmented"
          },
          {
            "id": "",
            "text": "Not required"
          },
          {
            "id": "",
            "text": "One complete allele"
          },
          {
            "id": "",
            "text": "The six broad quality categories in the first column are split into sub-metrics in the second column. The recommendations for draft to finished qualities (columns 3–6) are based on those achieved in past studies 16 , 19 , 63 , this study, and what we aspire to. In the x.y.P.Q.C notation, x = log 10 [contig NG50]; y = log 10 [scaffold NG50]; P = log 10 [haplotype phased NG50 block]; Q = Phred base accuracy QV; and C = percentage of the assembly assigned to chromosomes. c denotes ‘complete’ telomere-to-telomere continuity. The VGP assemblies (last column) satisfy the 6.7.6.Q40.C90 standard, but some come close to achieving a higher 7.c.7.Q50.C95 standard. These metrics apply to genomes about 1 Gb or bigger."
          },
          {
            "id": "",
            "text": "a Phase blocks calculated for the zebra finch non-trio assembly using haplotype specific k -mers from parental data 20 ; the trio assemblies had NG50 phase blocks of 17.3 Mb (maternal) and 56.6 Mb (paternal)."
          }
        ]
      },
      {
        "id": "Sec16",
        "title": "The Vertebrate Genomes Project",
        "paragraphs": [
          {
            "id": "Par26",
            "text": "Building on this initial set of assembled genomes and the lessons learned, we propose to expand the VGP to deeper taxonomic phases, beginning with phase 1: representatives of approximately 260 vertebrate orders, defined here as lineages separated by 50 million or more years of divergence from each other. Phase 2 will encompass species that represent all approximately 1,000 vertebrate families; phase 3, all roughly 10,000 genera; and phase 4, nearly all 71,657 extant named vertebrate species (Supplementary Note 5 , Supplementary Fig. 3 ). To accomplish such a project within 10 years, we will need to scale up to completing 125 genomes per week, without sacrificing quality. This includes sample permitting, high molecular weight DNA extractions, sequencing, meta-data tracking, and computational infrastructure. We will take advantage of continuing improvements in genome sequencing technology, assembly, and annotation, including advances in PacBio HiFi reads, Oxford Nanopore reads, and replacements for 10XG reads (Supplementary Note 6 ), while addressing specific scientific questions at increasing levels of phylogenetic refinement. Genomic technology advances quickly, but we believe the principles of our pipeline and the lessons learned will be applicable to future efforts. Areas in which improvement is needed include more accurate and complete haplotype phasing, base-call accuracy, and resolution of long repetitive regions such as telomeres, centromeres, and sex chromosomes. The VGP is working towards these goals and making all data, protocols, and pipelines openly available (Supplementary Notes 5 , 7 )."
          },
          {
            "id": "Par27",
            "text": "Despite remaining imperfections, our reference genomes are the most complete and highest quality to date for each species sequenced, to our knowledge. When we began to generate genomes beyond the Anna’s hummingbird in 2017, only eight vertebrate species in GenBank had genomes that met our target continuity metrics, and none were haplotype phased (Supplementary Table 23 ). The VGP pipeline introduced here has now been used to complete assemblies of more than 130 species of similar or higher quality (Supplementary Note 5 ; BioProject PRJNA489243). We encourage the scientific community to use and evaluate the assemblies and associated raw data, and to provide feedback towards improving all processes for complete and error-free assembled genomes of all species."
          }
        ]
      },
      {
        "id": "Sec17",
        "title": "Methods",
        "paragraphs": [
          {
            "id": "Par28",
            "text": "For each completed assembly of an individual, we gave that assembly an abbreviated name with the following rules: Lineage/GenusSpecies/Individual#.Assembly#. The first letter, in lowercase, identifies the particular lineage: m, mammals; b, birds; r, reptiles; a, amphibians; f, teleost fish; and s, sharks and other cartilaginous fishes. The next three letters (first in caps) identify the species scientific genus name; the next three letters (first in caps) identifies the specific species name. In the last position is the genome identifier, where integers (1, 2, 3, …) represent different individuals of the same species, and decimals (1.1, 1.2, 1.3, …) represent different assemblies of the same individual. For example, the first submission of the curated Anna’s hummingbird ( Calypte anna ) assembly is bCalAnn1.1, and an updated assembly for the same individual is bCalAnn1.2. When the abbreviated lineage or genus and species names for two or more species were identical, we replaced the subsequent letters (fourth, fifth and so on) of the genus or species name until they could be differentiated. We have created abbreviated names for all 71,657 vertebrate species ( http://vgpdb.snu.ac.kr/splist/ ; https://id.tol.sanger.ac.uk/ )."
          },
          {
            "id": "Par29",
            "text": "The production of high-quality genome assemblies required us to obtain high-quality cells or tissue that would yield high-molecular-weight (HMW) DNA for long-read sequencing technologies (CLR and ONT) and optical mapping (Bionano). Therefore, we obtained fresh-frozen samples of various tissues (Supplementary Table 8 ). All samples were obtained according to approved protocols of the respective animal care and use committees or permits obtained by the respective persons and institutions listed in Supplementary Table 8 . Additional details of the samples are on their respective BioSample pages ( https://www.ncbi.nlm.nih.gov/biosample ; accession numbers in Supplementary Table 8 ). All tissue types tested yielded a sufficient quantity and quality of DNA for sequencing and assembly, but we found that blood worked best for species that have nucleated red blood cells (that is, bird and reptiles), and spleen or cultured cells worked best for mammals, as of to date. Analysis of different tissue types will be presented elsewhere (in preparation)."
          },
          {
            "id": "Par30",
            "text": "For tissue, HMW DNA was extracted using the Bionano animal tissue DNA isolation fibrous tissue protocol (cat no. RE-013-10; document number 30071), according to the manufacturer’s guidelines. A total of 25–30 mg was fixed in 2% formaldehyde and homogenized using the Qiagen TissueRuptor or manual tissue disruption. For nucleated blood, 27–54 μl was used with an adapted protocol (Bionano, personal communication) of the Bionano Prep Blood and Cell Culture DNA Isolation Kit (cat no. RE-130-10). Lysates were embedded into agarose plugs and treated with Proteinase K and RNase A. Plugs were then purified by drop dialysis with 1× TE. DNA quality was assessed using pulse field gel electrophoresis (PFGE) (Pippin Pulse, SAGE Science, Beverly, MA) or the Femto Pulse instrument (Agilent). PFGE revealed that we isolated ultra-high-molecular-weight DNA between ~100 and ~500 kb long."
          },
          {
            "id": "Par31",
            "text": "For some samples, we performed phenol–chloroform extractions for HMW gDNA. Snap-frozen tissue was pulverized into a fine powder with a mortar and pestle in liquid nitrogen. The powdered tissue was lysed overnight at 55 °C in high-salt tissue lysis buffer (400 mM NaCl, 20 mM Tris base (pH 8.0), 30 mM EDTA (pH 8.0), 0.5% SDS, 100 μg/ml Proteinase K), and powdered lung tissue was lysed overnight in Qiagen G2 lysis buffer (cat no. 1014636, Qiagen, Hilden, Germany) containing 100 μg/ml Proteinase K at 55 °C. RNA was removed by incubation in 50 μg/ml RNase A for 1 h at 37 °C. HMW gDNA was purified with two washes of phenol–chloroform-IAA equilibrated to pH 8.0, followed by two washes of chloroform-IAA, and precipitated in ice-cold 100% ethanol. Filamentous HMW gDNA was either spooled with shepherds hooks or collected by centrifugation. HMW gDNA was washed twice with 70% ethanol, dried for 20 min at room temperature and eluted in TE. For the flier cichlid muscle gDNA sample used for PacBio CLR and 10XG libraries, glycogen was precipitated by adding 1/10 (v/v) 0.3 M sodium acetate, pH 6.0 to the extracted genomic DNA, mixing carefully and spinning at room temperature at 10,000 g . PFGE revealed thatDNA molecule length was between 50 and 300 kb—often lower in size than that obtained with the agarose plug but sufficient for long-range sequencing of CLR and linked read data types."
          },
          {
            "id": "Par32",
            "text": "We also used the Qiagen MagAttract HMW DNA kit (cat no. 67563) and the KingFisher Cell and Tissue DNA kit (Thermo Scientific; cat no. 97030196), following the manufacturers’ guidelines. These protocols yielded HMW DNA ranging from 30 to 50 kb. The Genomic Tip (Qiagen) kit was also used for tissue-based extraction of HMW DNA."
          },
          {
            "id": "Par33",
            "text": "DNA obtained from agarose plugs was sheared down to ~40 kb fragment size with a MegaRuptor device (Diagenode, Belgium) and fragmented using Covaris g-tubes (520079) or by needle shearing. PacBio large insert libraries were prepared with either the SMRTbell Template Prep Kit 1.0‐SPv3 (no.100‐991‐900) or the SMRTbell Express Template Prep Kit v1 (no. 101‐357‐000). Libraries were size-selected between 12 and 25 kb using Sage BluePippin (Sage Science, USA), depending on the DNA quality and extraction method. These libraries were sequenced on either RSII or Sequel I instruments, at least 60× coverage per species using Sequel Binding Kit and Sequencing Plate versions 2.0 and 2.1 with 10-h movie time (Supplementary Table 9 )."
          },
          {
            "id": "Par34",
            "text": "Unfragmented HMW DNA from the agarose plugs was used to generate linked read libraries on the 10X Genomics Chromium platform (Genome Library Kit & Gel Bead Kit v2 PN-120258, Genome Chip Kit v2 PN-120257, i7 Multiplex Kit PN-120262) following the manufacturer’s guidelines. We sequenced the 10X libraries at ~60× coverage per species on an Illumina NovaSeq S4 150-bp PE lane."
          },
          {
            "id": "Par35",
            "text": "Unfragmented ultra-HMW DNA from the agarose plugs was labelled using either two different nicking enzymes (BspQI and BssSI) or a direct labelling enzyme (DLE1) following the Bionano Prep Labelling NLRS (document number 30024) and DLS protocols, respectively (document number 30206). Labelled samples were then imaged on a Bionano Irys or on a Bionano Saphyr instrument. For all species, we aimed for at least 100× coverage per label (Supplementary Table 9 )."
          },
          {
            "id": "Par36",
            "text": "Chromatin interaction (Hi-C) libraries were generated using either Arima Genomics, Dovetail Genomics, or Phase libraries on muscle, blood, or other tissue with in vivo cross-linking (Supplementary Table 9 ) and sequenced on Illumina instruments. Arima-HiC preparations were performed by Arima Genomics ( https://arimagenomics.com/ ) using the Arima-HiC kit that uses two enzymes (P/N: A510008). The resulting Arima-HiC proximally ligated DNA was then sheared, size-selected around 200–600 bp using SPRI beads, and enriched for biotin-labelled proximity-ligated DNA using streptavidin beads. From these fragments, Illumina-compatible libraries were generated using the KAPA Hyper Prep kit (P/N: KK8504). The resulting libraries were PCR amplified and purified with SPRI beads. The quality of the final libraries was checked with qPCR and Bioanalyzer, and then sequenced on Illumina HiSeq X at ~60× coverage following the manufacturer’s protocols. Dovetail-HiC preparations were performed by Dovetail using a single-enzyme (DpnII) proximity ligation approach. Phase-HiC libraries were made by Phase Genomics using a Proximo Hi-C Library single-enzyme reaction."
          },
          {
            "id": "Par37",
            "text": "Before we performed any assembly, all genomic data of all data types from each sample were used to screen potential outlier libraries, outlier sequencing runs, or accidental species contamination with Mash 73 by measuring sequence similarity (Supplementary Fig. 4 ). When running Mash, we used 21-mers to generate sketches with sketch size of 10,000 and compared among each sequencing run, and then differences assessed between sequencing sets."
          },
          {
            "id": "Par38",
            "text": "These estimations were made with k -mer-based methods applied to the Illumina short reads obtained from 10XG linked sequencing libraries. After trimming off barcodes during scaff10x 74 preprocessing, canonical 31-mer counts were collected using Meryl 23 . With the resulting 31-mer histogram, GenomeScope 71 was used to estimate the haploid genome length, repeat content, and heterozygosity. The thorny skate linked read data failed quality control, which we suspect was due to low complexity sequences from the high repeat content (54.1%) of the genome; so k -mers were collected later from Illumina whole-genome sequencing reads instead. The genome size and repeat content of the channel bull blenny were estimated from an alternative method that looks at the mode of long read overlap coverage and WindowMasker 75 , as the estimated genome size from GenomeScope was almost doubling the known haploid genome size (1.29 Gb versus 0.6 Gb) and repeat content (28.0% versus 58.0%), for reasons related to either the quality of the 10X data or species differences."
          },
          {
            "id": "Par39",
            "text": "To develop the VGP standard pipeline, we compared various scaffolding, gap filling, and polishing tools. Default options were used unless otherwise noted. Detailed software versions are listed in Supplementary Table 2 ."
          },
          {
            "id": "Par40",
            "text": "FALCON 76 and FALCON-Unzip 17 (smrtanalysis 3.0.0) were used to generate contigs that used CLR. Canu 77 1.5+67 was used to generate the combined PacBio CLR and Oxford Nanopore ONT assembly. To benchmark scaffolding with linked reads, we used scaff10x 74 2.0. For the linked read-only assembly, Supernova 2 78 was used. For the optical maps, two-enzyme hybrid scaffolding was used in the Bionano Solve v3.2.1 software, using BspQI and BssSI initially, as well as DLE1 later when the technology was developed. For benchmarking Hi-C in scaffolding, Salsa 2.2 79 was used for scaffolding results in Fig. 1a , with Hi-C reads generated from Arima Genomics. Additional comparisons for the Hi-C libraries were performed using assemblies provided by Dovetail Genomics and Phase Genomics (Supplementary Table 3 ). We used Hi-C from Arima Genomics as it had the smallest number of PCR duplicates and better coverage for short and long interactions at the time of comparison (Supplementary Fig. 1 ). Assembly statistics from HiRise, Proximo HiC, 3D-DNA 80 and Arima Hi-C are available in Supplementary Table 3 . We concluded that all Hi-C scaffolding algorithms had similar performance. We decided to use Salsa, as HiRise and Proximo HiC were not open access, and 3D-DNA was computationally expensive on the DNAnexus platform. For short read assemblies, other than Supernova and the NRGene assembly, the assembly GCA_000699085.1 16 was used for benchmarking, which was generated with Illumina paired-end, multiple mate-pair libraries and the SoapDeNovo 81 assembler. The NRGene assembly was provided by the company with DeNovo Magic."
          },
          {
            "id": "Par41",
            "text": "We ran PBJelly with support --capturedOnly --spanOnly parameters, to avoid greedy gap closures with no spanning read support. For conservatively filling sequences, we compared different parameters in output stage with --minreads 1 and --minreads 4 in addition to no restrictions. We found that the number of gaps closed was similar to the gaps filled with Arrow 76 (Supplementary Table 4 ) and chose not to run PBJelly 82 for future assemblies."
          },
          {
            "id": "Par42",
            "text": "Illumina polishing benchmarking was performed using Longranger 83 2.1.3 and Pilon 84 1.21 with --fix bases, local option (Supplementary Table 5 ). Later, for the VGP pipeline, we used FreeBayes 85 as Pilon 84 was not computationally scalable for large genomes with the updated Longranger 2.2.2."
          },
          {
            "id": "Par43",
            "text": "Base-level accuracy was measured using a mapping-based approach and later using the k -mer-based approach 23 . To determine the number of rounds to polish, we used Illumina paired-end reads from the hummingbird 16 ."
          },
          {
            "id": "Par44",
            "text": "The curated hummingbird assembly was mapped to the target assemblies with MashMap2 86 with --filter_mode one-to-one --pi 95 using 5 kb segments (-s 5000) for CLR assemblies and 1 kb (-s 1000) for SR assemblies to compensate for the shorter contig sizes, as contigs smaller than a segment size will be excluded from the alignment. The number of mis-joins and missed joins were identified using the assembly_comparison.pl used in the ‘Curation’ section below ( Supplementary Methods , Supplementary Fig. 5 )."
          },
          {
            "id": "Par45",
            "text": "All 17 genomes were assembled with the VGP pipeline (Extended Data Fig. 2a ) for benchmark purposes, with some uncurated. The pale spear-nosed bat, greater horseshoe bat, Canada lynx, platypus, male and female zebra finch, kākāpō, Anna’s hummingbird, Goode’s thornscrub tortoise, flier cichlid, and blunt-snouted clingfish assemblies were generated using the VGP pipeline 1.0 to 1.6 and curated for submission to NCBI and EBI public archives. The curated and submitted two-lined caecilian, zig-zag eel, climbing perch, channel bull blenny, eastern happy, and thorny skate assemblies were generated using a similar process developed in parallel (Supplementary Note 2 ). Two submitted curated versions of the female zebra finch were made, one using the standard VGP pipeline and the other using the VGP trio pipeline, so that comparative analyses could be performed by others."
          },
          {
            "id": "Par46",
            "text": "For PacBio data, contigs were generated from subreads using FALCON 76 and FALCON-Unzip 17 , with one round of Arrow polishing (smrtanalysis 5.1.0.26412). A minimum read length of 2 kb or a cutoff at which reads longer than the cutoff include 50× coverage was used, whichever was longer. For calculating read coverage, we used estimated genome size from http://www.genomesize.com/ when available, or from the literature (Supplementary Table 11 ) while waiting for 10XG sequencing to estimate genome size using k -mers. FALCON and FALCON-Unzip were run with default parameters, except for computing the overlaps. Raw read overlaps were computed with DALIGNER parameters -k14 -e0.75 -s100 -l2500 -h240 -w8 to better reflect the higher error rate in early PacBio sequel I and II. Pread (preassembled read) overlaps were computed with DALIGNER parameters -k24 -e.90 -s100 -l1000 -h600 intending to collapse haplotypes for the FALCON step to better unzip genomes with high heterozygosity rate. FALCON-Unzip outputs both a pseudo-haplotype and a set of alternate haplotigs that represent the secondary alleles. We refer to these outputs as the primary contig set (c1) and alternate contig set (c2)."
          },
          {
            "id": "Par47",
            "text": "Heterotype false duplications occurred despite setting FALCON 76 parameters to resolve up to 10% haplotype divergence. FALCON-Unzip 17 also incorrectly retained some secondary alleles in the primary contig set, which appeared as false duplications. To reduce these false duplications, we ran Purge_Haplotigs 13 , first during curation (VGP v1.0 pipeline) and then later after contig formation (VGP v1.5 pipeline). To do the former, Purge_Haplotigs was run on the primary contigs (c1), and identified haplotigs were mapped to the scaffolded primary assembly with MashMap2 86 for removal. In the latter, identified haplotigs were moved from the primary contigs (c1) to the alternate haplotig set (p2). The remaining primary contigs were referred to as p1; p2 combined with c2 was referred to as q2. Later, in the VGP v1.6 pipeline, we replaced Purge_Haplotigs with Purge_Dups 14 , a new program developed by several of the authors in response to Purge_Haplotigs not removing partial false duplication at contig boundaries. Purging also removes excessive low-coverage (junk) and high-coverage (repeats) contigs. To calculate the presence and overall success of purging false duplications, we used a k -mer approach ( Supplementary Methods , Supplementary Fig. 6 )."
          },
          {
            "id": "Par48",
            "text": "The 10X Genomics linked reads were aligned to the primary contigs (p1), and an adjacency matrix was computed from the barcodes using scaff10x 74 v2.0–2.1. Two rounds of scaffolding were performed. The first round was run with parameters -matrix 2000 -reads 12 -link 10 , and the second round with parameters -matrix 2000 -reads 8 -link 10 . A gap of 100 bp (represented with ‘N’s) was inserted between joined contigs. The resulting primary scaffold set was named s1."
          },
          {
            "id": "Par49",
            "text": "Bionano cmaps were generated using the Bionano Pipeline in non-haplotype assembly mode and used to further scaffold the s1 assembly with Bionano Solve v3.2.1 87 . We began with a one-enzyme nick map (BspQI), followed by a two-enzyme nick map (BspQI and BssSI), and then with a DLE-1 one-enzyme non-nicking approach when the later data type became available (Supplementary Table 9 ). Scaffold gaps were sized according to the software estimate. The resulting scaffold set was named s2."
          },
          {
            "id": "Par50",
            "text": "Hi-C reads were aligned to the s2 scaffolds using the Arima Genomics mapping pipeline 88 . In brief, both ends of a read pair were mapped independently using BWA-MEM 89 with the parameter -B8 , and filtered when mapping quality was <10. Chimeric reads containing a restriction enzyme site were trimmed from the restriction site onward, leaving only the 5′ end. The filtered single-read alignments were then rejoined as paired read alignments. The processed alignments were then used for scaffolding with Salsa2 79 , which analyses the normalized frequency of Hi-C interactions between all pairs of contig ends to determine a likely ordering and orientation of each. We used parameters -m yes -i 5 -p yes to allow Salsa2 to break potentially mis-assembled contigs and perform five iterations of scaffolding. After feedback from curation, later versions of Salsa were developed, which more conservatively determine the number of iterations (v2.1) and actively break at mis-assemblies (v2.2), and run for the Canada lynx, Goode’s thornscrub tortoise, and two-lined caecilian. The restriction enzyme(s) used to generate each library were specified using parameters -e GATC,GANTC for Arima and -e GATC for Dovetail and Phase Genomics Hi-C data. The resulting Hi-C scaffolded assembly was named s3."
          },
          {
            "id": "Par51",
            "text": "To polish bases in both haplotypes with minimal alignment bias, we concatenated the alternate haplotig set (c2 in v1.0 or q2 in v1.5–1.6) to the scaffolded primary set (s3) and the assembled mitochondrial genome (mitoVGP in v1.6). We then performed another round of polishing with Arrow (smrtanalysis 5.1.0.26412) using PacBio CLR reads, aligning with pbalign --minAccuracy=0.75 --minLength=50 --minAnchorSize=12 --maxDivergence=30 –concordant --algorithm=blasr --algorithmOptions=--useQuality --maxHits=1 --hitPolicy=random --seed=1 and consensus polishing with variantCaller --skipUnrecognizedContigs haploid -x 5 -q 20 -X120 –v --algorithm=arrow . While this round of polishing resulted in higher QV for all genomes herein considered, we noticed that it was particularly sensitive to the coverage cutoff parameter ( -x ). This is because Arrow generates a de novo consensus from the mapped reads without explicitly considering the reference sequence. Later, we found that the second round of Arrow polishing sometimes reduced the QV accuracy for some species. Upon investigation, this issue was traced back to option -x 5 , which requires at least 5 reads to call consensus. Such low minimum requirements can lead to uneven polishing in low coverage regions. To avoid this behaviour, we suggest to increase the -x close to the half sequence coverage (for example, 30× when 60× was used for assembly) and check QV before moving forward."
          },
          {
            "id": "Par52",
            "text": "For genomes with a combined assembly size larger than 4 Gb, we used Minimap2 90 with parameters -ax map-pb instead of Blasr 91 to overcome reference index size limitations."
          },
          {
            "id": "Par53",
            "text": "Two more rounds of base-pair polishing were performed with linked reads. The reads were aligned with Longranger align 2.2.2, which incorporates the Lauriat for barcode-aware alignment 83 . From the alignments, homozygous mismatches (variants) were called with FreeBayes 83 v1.2.0 using default options. Consensus was called with bcftools consensus 92 with -i’QUAL>1 && (GT=’’AA’’ || GT = ‘’Aa’’)’ -Hla ."
          },
          {
            "id": "Par54",
            "text": "The trio pipeline is similarly designed to the standard pipeline, except for the use of parental data (Extended Data Fig. 3b ). When parental genomes are available, the child’s CLR reads are binned to maternal and paternal haplotypes, and assembled separately as haplotype-specific contigs (haplotigs) using TrioCanu 20 . In brief, parental specific marker k -mers were collected using Meryl 23 from the parental Illumina WGS reads of the parents. These markers were filtered and used to bin the child’s CLR read. A haplotype was assigned given the markers observed, normalized by the total markers in each haplotype. The subsequent purging, scaffolding, and polishing steps were similarly updated with the use of Purge_Dups 14 (v1.6). We extended binning to linked reads and Hi-C reads, by excluding read pairs that had any parental-specific marker. The binned Hi-C reads were used to scaffold its haplotype assembly, and polished with the binned linked reads from the observation of haplotype switching using the standard polishing approach. During curation, one of the haplotype assemblies with the higher QV and/or contiguity was chosen as the representative haplotype. The heterogametic sex chromosome from the unchosen haplotype was added to the representative assembly. However, while curating several trios, we found that in regions of low divergence between shared parental homogametic sex chromosomes (that is, X or Z), a small fraction of offspring CLR data was mis-assigned to the wrong haplotype. This mis-alignment resulted in a duplicate, low-coverage offspring X or Z assembly in the paternal (for mammals) or maternal (for birds) haplotype, respectively, which required removal during curation. We are working on methods to improve the binning accuracy for resolution of this issue going forward."
          },
          {
            "id": "Par55",
            "text": "For the female zebra finch in particular, contigs were generated before the binning was automated in the Canu assembler as TrioCanu1.7, and therefore a manual binning process was applied as described in the original Trio-binning paper 20 ( Supplementary Methods ). Contigs were assembled for each haplotype using the binned reads, excluding unclassified reads. The contigs were polished with two rounds of Arrow polishing using the binned reads, and scaffolded following the v1.0 pipeline with no purging. Additional scaffolding rounds with Bionano (s4) and Hi-C were applied. Scaffolds were renamed according to the primary scaffold assembly of the same individual (s5), with sex chromosomes grouped as Z in the paternal assembly and W in the maternal assembly following synteny to the Z chromosome from the curated male zebra finch VGP assembly. Two rounds of SR polishing were applied using linked reads, by mapping on both haplotypes. After haplotype switches were discovered, additional rounds of polishing were applied using binned linked reads ( Supplementary Methods )."
          },
          {
            "id": "Par56",
            "text": "Similar to other recent methods 93 , 94 , we developed a reference-guided MT assembly pipeline. MT reads in the raw CLR data were identified by mapping the whole read set to an existing reference sequence of the specific species or of closely related species using Blasr. Filtered mtDNA CLRs were assembled into a single contig using Canu v1.8, polished with Arrow using CLR and then FreeBayes v1.0.2 together with bcftools v1.9 using short reads from the 10XG data (Extended Data Fig. 3c ). The overlapping sequences at the ends of the contig were trimmed, and the remaining contig sequence circularized. The mitoVGP pipeline is made available at https://github.com/VGP/vgp-assembly/tree/master/mitoVGP . A more detailed protocol description of the assembly pipeline and new discoveries from the MT assemblies are published elsewhere 33 ."
          },
          {
            "id": "Par57",
            "text": "The VGP genome assembly pipeline produces high quality assemblies, yet no automated method to date is free from the production of errors, especially during the scaffolding stages. To minimize the impact of the remaining algorithmic shortcomings, we subjected all assemblies to rigorous manual curation. All data generated for a species in this study and other publicly available data (for example, genetic maps, gene sets and genome assemblies of the same or closely related species) were collated, aligned to the primary assembly and analysed in gEVAL 95 ( https://vgp-geval.sanger.ac.uk/index.html ), visualizing discordances in a feature browser and issue lists. In parallel, Hi-C data were mapped to the primary assembly and visualized using Juicebox 96 and/or HiGlass 97 . With these data, genome curators identified mis-joins, missed joins and other anomalies, and corrected the primary assembly accordingly. No change was made without unambiguous evidence from available data types; for example, a Hi-C suggested join would not be made unless supported by BioNano maps, long-read data, or gene alignments. When sequencing the heterogametic sex, we identified sex chromosomes based on half coverage, homology alignments to sex chromosomes in other species, and the presence of sex chromosome-specific genes."
          },
          {
            "id": "Par58",
            "text": "A succession of searches was used to identify potential contaminants in the generated assemblies."
          },
          {
            "id": "Par59",
            "text": "1) A megaBLAST 98 search against a database of common contaminants (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/contam_in_euks.fa.gz) requiring e ≤ 1 × 10 −4 , reporting matches with ≥98% sequence identity and match length 50–99 bp, ≥94% and match length 100–199 bp, or ≥90% and match length 200 bp or above."
          },
          {
            "id": "Par60",
            "text": "2) A vecscreen ( https://www.ncbi.nlm.nih.gov/tools/vecscreen/ ) search against a database of adaptor sequences (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/adaptors_for_screening_euks.fa)"
          },
          {
            "id": "Par61",
            "text": "3) After soft-masking repeats using Windowmasker 75 , a megaBLAST search against chromosome-level assemblies from RefSeq requiring e ≤ 1 × 10 −4 , match score ≥100, and sequence identity ≥98%; regions matching highly conserved rDNAs were ignored."
          },
          {
            "id": "Par62",
            "text": "Manual inspection of the results was necessary to differentiate contamination from conservation and/or horizontal gene transfer. Adaptor sequences were masked; other contaminant sequences were removed. Assemblies were also checked for runs of Ns at the ends of scaffolds, created as artefacts of the iterative scaffolding process, and when found they were trimmed."
          },
          {
            "id": "Par63",
            "text": "These were detected by a megaBLAST search against a database of known organelle genomes requiring e ≤ 1 × 10 −4 , sequence identity ≥90%, and match length ≥500; the databases are available at ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/mito.nt.gz and ftp://ftp.ncbi.nlm.nih.gov/refseq/release/plastid/*genomic.fna.gz. Only scaffolds consisting entirely of organelle sequences were assumed to be organelle genomes, and replaced by the genome from the separate organelle assembly pipeline. Organelle matches embedded in nuclear sequences that were found to be NuMTs were kept."
          },
          {
            "id": "Par64",
            "text": "Retained false duplications were identified using Purge_Haplotigs 13 run either after scaffolding and polishing (Anna’s hummingbird, kākāpō, male zebra finch, female zebra finch, platypus, pale spear-nosed bat, and greater horseshoe bat) or on the c1 before scaffolding (two-lined caecilian, flier cichlid, Canada lynx, and Goode’s thornscrub tortoise). Subsequent manual curation identified additional haplotypic duplications for the listed assemblies and also those that were not treated with Purge_Haplotigs (Eastern happy, climbing perch, zig-zag eel). The evidence used included read coverage, sequence self-comparison, transcript alignments, Bionano map alignments and Hi-C 2D maps, all confirming the superfluous nature of one allele. The identified haplotype duplications were moved from the primary to the alternate assembly."
          },
          {
            "id": "Par65",
            "text": "For a scaffold to be annotated as a chromosome, we used evidence from Hi-C as well as genetic linkage or FISH karyotype mapping when available. For Hi-C evidence, we considered a scaffold as a complete chromosome (albeit with gaps) when there was a clear unbroken diagonal in the Juicebox or HiGlass plots for that scaffold and no other large scaffolds that could be joined to that same scaffold; if present and no unambiguous join was possible, we named it as an unlocalized scaffold for that chromosome. When we could not find evidence of a complete chromosome, we kept the scaffold number for its name. We named all evidence-validated scaffolds as chromosomes down to the smallest Hi-C box unit resolution allowed with these characteristics. When there was an established chromosome terminology for a given species or set of species, we use the established terminology except when our new assemblies revealed errors in the older assembly, such as scaffold/chromosome fusions, fissions, rearrangements, and non-chromosome names. For species without an established chromosome terminology, we named the scaffolds as chromosomes numbers 1, 2, 3 …, in descending order of scaffold size. For the sex chromosomes, we used the letters X and Y for mammals and Z and W for birds."
          },
          {
            "id": "Par66",
            "text": "In cases where a high-quality chromosome-level genome was available for a closely related species, comparative genome analysis was performed. The polished primary assembly (t3.p) was mapped to the related genome using MashMap2 86 with --pi 75 -s 300000 . The number of chromosomal differences was identified using a custom script available at https://github.com/jdamas13/assembly_comparison . This resulted in the identification of ~60 to ~450 regions for each genome assembly flanking putative misassemblies or lineage-specific genome rearrangements. To identify which were real misassemblies, the identified discrepancies were communicated to the curation team for manual verification (see above)."
          },
          {
            "id": "Par67",
            "text": "To identify any possible remaining mis-joins, each curated avian and mammalian assembly was compared with the zebra finch (taeGut2) or human (hg38) genomes, respectively. Pairwise alignments between each of the VGP assemblies and the clade reference were generated with LastZ 99 (version 1.04) using the following parameters: C = 0 E = 30 H = 2000 K = 3000 L = 2200 O = 400. The pairwise alignments were converted into the UCSC ‘chain’ and ‘net’ formats with axtChain (parameters: -minScore = 1000 -verbose = 0 -linearGap = medium ) followed by chainAntiRepeat, chainSort, chainPreNet, chainNet and netSyntenic, all with default parameters 100 . Pairwise synteny blocks were defined using maf2synteny 101 at 100-, 300-, and 500-kb resolutions. Evolutionary breakpoint regions were detected and classified using an ad hoc statistical approach 102 . This analysis identified 2 to 90 genomic regions per assembly that could be flanking misassemblies, lineage-specific chromosome rearrangements, or reference-specific chromosome rearrangements (116 in the human and 26 in the zebra finch). Determining the underlying cause for each of the flagged regions will need further verification. All alignments are available for visualization at the Evolution Highway comparative chromosome browser ( http://eh-demo.ncsa.illinois.edu/vgp/ )."
          },
          {
            "id": "Par68",
            "text": "NCBI and Ensembl annotation pipeline used in this study are described in the Supplementary Methods ."
          },
          {
            "id": "Par69",
            "text": "Detailed methods for other types of evaluation, including BUSCO runs, mis-join and missed-join identification, reliable blocks, collapsed repeats, telomeres, RNA-seq and ATAC–seq mapping, and false gene duplications are in the Supplementary Methods . No statistical methods were used to predetermine sample size, the experiments were not randomized, and the investigators were not blinded to group during experiments and outcome assessment."
          },
          {
            "id": "Par70",
            "text": "Further information on research design is available in the Nature Research Reporting Summary linked to this paper."
          }
        ],
        "subsections": [
          {
            "id": "Sec18",
            "title": "Genome assembly naming",
            "paragraphs": [
              {
                "id": "Par28",
                "text": "For each completed assembly of an individual, we gave that assembly an abbreviated name with the following rules: Lineage/GenusSpecies/Individual#.Assembly#. The first letter, in lowercase, identifies the particular lineage: m, mammals; b, birds; r, reptiles; a, amphibians; f, teleost fish; and s, sharks and other cartilaginous fishes. The next three letters (first in caps) identify the species scientific genus name; the next three letters (first in caps) identifies the specific species name. In the last position is the genome identifier, where integers (1, 2, 3, …) represent different individuals of the same species, and decimals (1.1, 1.2, 1.3, …) represent different assemblies of the same individual. For example, the first submission of the curated Anna’s hummingbird ( Calypte anna ) assembly is bCalAnn1.1, and an updated assembly for the same individual is bCalAnn1.2. When the abbreviated lineage or genus and species names for two or more species were identical, we replaced the subsequent letters (fourth, fifth and so on) of the genus or species name until they could be differentiated. We have created abbreviated names for all 71,657 vertebrate species ( http://vgpdb.snu.ac.kr/splist/ ; https://id.tol.sanger.ac.uk/ )."
              }
            ]
          },
          {
            "id": "Sec19",
            "title": "Sample collection",
            "paragraphs": [
              {
                "id": "Par29",
                "text": "The production of high-quality genome assemblies required us to obtain high-quality cells or tissue that would yield high-molecular-weight (HMW) DNA for long-read sequencing technologies (CLR and ONT) and optical mapping (Bionano). Therefore, we obtained fresh-frozen samples of various tissues (Supplementary Table 8 ). All samples were obtained according to approved protocols of the respective animal care and use committees or permits obtained by the respective persons and institutions listed in Supplementary Table 8 . Additional details of the samples are on their respective BioSample pages ( https://www.ncbi.nlm.nih.gov/biosample ; accession numbers in Supplementary Table 8 ). All tissue types tested yielded a sufficient quantity and quality of DNA for sequencing and assembly, but we found that blood worked best for species that have nucleated red blood cells (that is, bird and reptiles), and spleen or cultured cells worked best for mammals, as of to date. Analysis of different tissue types will be presented elsewhere (in preparation)."
              }
            ]
          },
          {
            "id": "Sec20",
            "title": "Isolation of high-molecular-weight DNA",
            "paragraphs": [
              {
                "id": "Par30",
                "text": "For tissue, HMW DNA was extracted using the Bionano animal tissue DNA isolation fibrous tissue protocol (cat no. RE-013-10; document number 30071), according to the manufacturer’s guidelines. A total of 25–30 mg was fixed in 2% formaldehyde and homogenized using the Qiagen TissueRuptor or manual tissue disruption. For nucleated blood, 27–54 μl was used with an adapted protocol (Bionano, personal communication) of the Bionano Prep Blood and Cell Culture DNA Isolation Kit (cat no. RE-130-10). Lysates were embedded into agarose plugs and treated with Proteinase K and RNase A. Plugs were then purified by drop dialysis with 1× TE. DNA quality was assessed using pulse field gel electrophoresis (PFGE) (Pippin Pulse, SAGE Science, Beverly, MA) or the Femto Pulse instrument (Agilent). PFGE revealed that we isolated ultra-high-molecular-weight DNA between ~100 and ~500 kb long."
              },
              {
                "id": "Par31",
                "text": "For some samples, we performed phenol–chloroform extractions for HMW gDNA. Snap-frozen tissue was pulverized into a fine powder with a mortar and pestle in liquid nitrogen. The powdered tissue was lysed overnight at 55 °C in high-salt tissue lysis buffer (400 mM NaCl, 20 mM Tris base (pH 8.0), 30 mM EDTA (pH 8.0), 0.5% SDS, 100 μg/ml Proteinase K), and powdered lung tissue was lysed overnight in Qiagen G2 lysis buffer (cat no. 1014636, Qiagen, Hilden, Germany) containing 100 μg/ml Proteinase K at 55 °C. RNA was removed by incubation in 50 μg/ml RNase A for 1 h at 37 °C. HMW gDNA was purified with two washes of phenol–chloroform-IAA equilibrated to pH 8.0, followed by two washes of chloroform-IAA, and precipitated in ice-cold 100% ethanol. Filamentous HMW gDNA was either spooled with shepherds hooks or collected by centrifugation. HMW gDNA was washed twice with 70% ethanol, dried for 20 min at room temperature and eluted in TE. For the flier cichlid muscle gDNA sample used for PacBio CLR and 10XG libraries, glycogen was precipitated by adding 1/10 (v/v) 0.3 M sodium acetate, pH 6.0 to the extracted genomic DNA, mixing carefully and spinning at room temperature at 10,000 g . PFGE revealed thatDNA molecule length was between 50 and 300 kb—often lower in size than that obtained with the agarose plug but sufficient for long-range sequencing of CLR and linked read data types."
              },
              {
                "id": "Par32",
                "text": "We also used the Qiagen MagAttract HMW DNA kit (cat no. 67563) and the KingFisher Cell and Tissue DNA kit (Thermo Scientific; cat no. 97030196), following the manufacturers’ guidelines. These protocols yielded HMW DNA ranging from 30 to 50 kb. The Genomic Tip (Qiagen) kit was also used for tissue-based extraction of HMW DNA."
              }
            ]
          },
          {
            "id": "Sec24",
            "title": "Libraries and sequencing",
            "paragraphs": [
              {
                "id": "Par33",
                "text": "DNA obtained from agarose plugs was sheared down to ~40 kb fragment size with a MegaRuptor device (Diagenode, Belgium) and fragmented using Covaris g-tubes (520079) or by needle shearing. PacBio large insert libraries were prepared with either the SMRTbell Template Prep Kit 1.0‐SPv3 (no.100‐991‐900) or the SMRTbell Express Template Prep Kit v1 (no. 101‐357‐000). Libraries were size-selected between 12 and 25 kb using Sage BluePippin (Sage Science, USA), depending on the DNA quality and extraction method. These libraries were sequenced on either RSII or Sequel I instruments, at least 60× coverage per species using Sequel Binding Kit and Sequencing Plate versions 2.0 and 2.1 with 10-h movie time (Supplementary Table 9 )."
              },
              {
                "id": "Par34",
                "text": "Unfragmented HMW DNA from the agarose plugs was used to generate linked read libraries on the 10X Genomics Chromium platform (Genome Library Kit & Gel Bead Kit v2 PN-120258, Genome Chip Kit v2 PN-120257, i7 Multiplex Kit PN-120262) following the manufacturer’s guidelines. We sequenced the 10X libraries at ~60× coverage per species on an Illumina NovaSeq S4 150-bp PE lane."
              },
              {
                "id": "Par35",
                "text": "Unfragmented ultra-HMW DNA from the agarose plugs was labelled using either two different nicking enzymes (BspQI and BssSI) or a direct labelling enzyme (DLE1) following the Bionano Prep Labelling NLRS (document number 30024) and DLS protocols, respectively (document number 30206). Labelled samples were then imaged on a Bionano Irys or on a Bionano Saphyr instrument. For all species, we aimed for at least 100× coverage per label (Supplementary Table 9 )."
              },
              {
                "id": "Par36",
                "text": "Chromatin interaction (Hi-C) libraries were generated using either Arima Genomics, Dovetail Genomics, or Phase libraries on muscle, blood, or other tissue with in vivo cross-linking (Supplementary Table 9 ) and sequenced on Illumina instruments. Arima-HiC preparations were performed by Arima Genomics ( https://arimagenomics.com/ ) using the Arima-HiC kit that uses two enzymes (P/N: A510008). The resulting Arima-HiC proximally ligated DNA was then sheared, size-selected around 200–600 bp using SPRI beads, and enriched for biotin-labelled proximity-ligated DNA using streptavidin beads. From these fragments, Illumina-compatible libraries were generated using the KAPA Hyper Prep kit (P/N: KK8504). The resulting libraries were PCR amplified and purified with SPRI beads. The quality of the final libraries was checked with qPCR and Bioanalyzer, and then sequenced on Illumina HiSeq X at ~60× coverage following the manufacturer’s protocols. Dovetail-HiC preparations were performed by Dovetail using a single-enzyme (DpnII) proximity ligation approach. Phase-HiC libraries were made by Phase Genomics using a Proximo Hi-C Library single-enzyme reaction."
              }
            ]
          },
          {
            "id": "Sec29",
            "title": "Quality control",
            "paragraphs": [
              {
                "id": "Par37",
                "text": "Before we performed any assembly, all genomic data of all data types from each sample were used to screen potential outlier libraries, outlier sequencing runs, or accidental species contamination with Mash 73 by measuring sequence similarity (Supplementary Fig. 4 ). When running Mash, we used 21-mers to generate sketches with sketch size of 10,000 and compared among each sequencing run, and then differences assessed between sequencing sets."
              }
            ]
          },
          {
            "id": "Sec30",
            "title": "Genome size, repeat content, and heterozygosity estimations",
            "paragraphs": [
              {
                "id": "Par38",
                "text": "These estimations were made with k -mer-based methods applied to the Illumina short reads obtained from 10XG linked sequencing libraries. After trimming off barcodes during scaff10x 74 preprocessing, canonical 31-mer counts were collected using Meryl 23 . With the resulting 31-mer histogram, GenomeScope 71 was used to estimate the haploid genome length, repeat content, and heterozygosity. The thorny skate linked read data failed quality control, which we suspect was due to low complexity sequences from the high repeat content (54.1%) of the genome; so k -mers were collected later from Illumina whole-genome sequencing reads instead. The genome size and repeat content of the channel bull blenny were estimated from an alternative method that looks at the mode of long read overlap coverage and WindowMasker 75 , as the estimated genome size from GenomeScope was almost doubling the known haploid genome size (1.29 Gb versus 0.6 Gb) and repeat content (28.0% versus 58.0%), for reasons related to either the quality of the 10X data or species differences."
              }
            ]
          },
          {
            "id": "Sec31",
            "title": "Benchmarking assembly steps with the Anna’s hummingbird",
            "paragraphs": [
              {
                "id": "Par39",
                "text": "To develop the VGP standard pipeline, we compared various scaffolding, gap filling, and polishing tools. Default options were used unless otherwise noted. Detailed software versions are listed in Supplementary Table 2 ."
              },
              {
                "id": "Par40",
                "text": "FALCON 76 and FALCON-Unzip 17 (smrtanalysis 3.0.0) were used to generate contigs that used CLR. Canu 77 1.5+67 was used to generate the combined PacBio CLR and Oxford Nanopore ONT assembly. To benchmark scaffolding with linked reads, we used scaff10x 74 2.0. For the linked read-only assembly, Supernova 2 78 was used. For the optical maps, two-enzyme hybrid scaffolding was used in the Bionano Solve v3.2.1 software, using BspQI and BssSI initially, as well as DLE1 later when the technology was developed. For benchmarking Hi-C in scaffolding, Salsa 2.2 79 was used for scaffolding results in Fig. 1a , with Hi-C reads generated from Arima Genomics. Additional comparisons for the Hi-C libraries were performed using assemblies provided by Dovetail Genomics and Phase Genomics (Supplementary Table 3 ). We used Hi-C from Arima Genomics as it had the smallest number of PCR duplicates and better coverage for short and long interactions at the time of comparison (Supplementary Fig. 1 ). Assembly statistics from HiRise, Proximo HiC, 3D-DNA 80 and Arima Hi-C are available in Supplementary Table 3 . We concluded that all Hi-C scaffolding algorithms had similar performance. We decided to use Salsa, as HiRise and Proximo HiC were not open access, and 3D-DNA was computationally expensive on the DNAnexus platform. For short read assemblies, other than Supernova and the NRGene assembly, the assembly GCA_000699085.1 16 was used for benchmarking, which was generated with Illumina paired-end, multiple mate-pair libraries and the SoapDeNovo 81 assembler. The NRGene assembly was provided by the company with DeNovo Magic."
              },
              {
                "id": "Par41",
                "text": "We ran PBJelly with support --capturedOnly --spanOnly parameters, to avoid greedy gap closures with no spanning read support. For conservatively filling sequences, we compared different parameters in output stage with --minreads 1 and --minreads 4 in addition to no restrictions. We found that the number of gaps closed was similar to the gaps filled with Arrow 76 (Supplementary Table 4 ) and chose not to run PBJelly 82 for future assemblies."
              },
              {
                "id": "Par42",
                "text": "Illumina polishing benchmarking was performed using Longranger 83 2.1.3 and Pilon 84 1.21 with --fix bases, local option (Supplementary Table 5 ). Later, for the VGP pipeline, we used FreeBayes 85 as Pilon 84 was not computationally scalable for large genomes with the updated Longranger 2.2.2."
              },
              {
                "id": "Par43",
                "text": "Base-level accuracy was measured using a mapping-based approach and later using the k -mer-based approach 23 . To determine the number of rounds to polish, we used Illumina paired-end reads from the hummingbird 16 ."
              },
              {
                "id": "Par44",
                "text": "The curated hummingbird assembly was mapped to the target assemblies with MashMap2 86 with --filter_mode one-to-one --pi 95 using 5 kb segments (-s 5000) for CLR assemblies and 1 kb (-s 1000) for SR assemblies to compensate for the shorter contig sizes, as contigs smaller than a segment size will be excluded from the alignment. The number of mis-joins and missed joins were identified using the assembly_comparison.pl used in the ‘Curation’ section below ( Supplementary Methods , Supplementary Fig. 5 )."
              }
            ]
          },
          {
            "id": "Sec37",
            "title": "VGP standard genome assembly pipeline 1.0 to 1.6",
            "paragraphs": [
              {
                "id": "Par45",
                "text": "All 17 genomes were assembled with the VGP pipeline (Extended Data Fig. 2a ) for benchmark purposes, with some uncurated. The pale spear-nosed bat, greater horseshoe bat, Canada lynx, platypus, male and female zebra finch, kākāpō, Anna’s hummingbird, Goode’s thornscrub tortoise, flier cichlid, and blunt-snouted clingfish assemblies were generated using the VGP pipeline 1.0 to 1.6 and curated for submission to NCBI and EBI public archives. The curated and submitted two-lined caecilian, zig-zag eel, climbing perch, channel bull blenny, eastern happy, and thorny skate assemblies were generated using a similar process developed in parallel (Supplementary Note 2 ). Two submitted curated versions of the female zebra finch were made, one using the standard VGP pipeline and the other using the VGP trio pipeline, so that comparative analyses could be performed by others."
              },
              {
                "id": "Par46",
                "text": "For PacBio data, contigs were generated from subreads using FALCON 76 and FALCON-Unzip 17 , with one round of Arrow polishing (smrtanalysis 5.1.0.26412). A minimum read length of 2 kb or a cutoff at which reads longer than the cutoff include 50× coverage was used, whichever was longer. For calculating read coverage, we used estimated genome size from http://www.genomesize.com/ when available, or from the literature (Supplementary Table 11 ) while waiting for 10XG sequencing to estimate genome size using k -mers. FALCON and FALCON-Unzip were run with default parameters, except for computing the overlaps. Raw read overlaps were computed with DALIGNER parameters -k14 -e0.75 -s100 -l2500 -h240 -w8 to better reflect the higher error rate in early PacBio sequel I and II. Pread (preassembled read) overlaps were computed with DALIGNER parameters -k24 -e.90 -s100 -l1000 -h600 intending to collapse haplotypes for the FALCON step to better unzip genomes with high heterozygosity rate. FALCON-Unzip outputs both a pseudo-haplotype and a set of alternate haplotigs that represent the secondary alleles. We refer to these outputs as the primary contig set (c1) and alternate contig set (c2)."
              },
              {
                "id": "Par47",
                "text": "Heterotype false duplications occurred despite setting FALCON 76 parameters to resolve up to 10% haplotype divergence. FALCON-Unzip 17 also incorrectly retained some secondary alleles in the primary contig set, which appeared as false duplications. To reduce these false duplications, we ran Purge_Haplotigs 13 , first during curation (VGP v1.0 pipeline) and then later after contig formation (VGP v1.5 pipeline). To do the former, Purge_Haplotigs was run on the primary contigs (c1), and identified haplotigs were mapped to the scaffolded primary assembly with MashMap2 86 for removal. In the latter, identified haplotigs were moved from the primary contigs (c1) to the alternate haplotig set (p2). The remaining primary contigs were referred to as p1; p2 combined with c2 was referred to as q2. Later, in the VGP v1.6 pipeline, we replaced Purge_Haplotigs with Purge_Dups 14 , a new program developed by several of the authors in response to Purge_Haplotigs not removing partial false duplication at contig boundaries. Purging also removes excessive low-coverage (junk) and high-coverage (repeats) contigs. To calculate the presence and overall success of purging false duplications, we used a k -mer approach ( Supplementary Methods , Supplementary Fig. 6 )."
              },
              {
                "id": "Par48",
                "text": "The 10X Genomics linked reads were aligned to the primary contigs (p1), and an adjacency matrix was computed from the barcodes using scaff10x 74 v2.0–2.1. Two rounds of scaffolding were performed. The first round was run with parameters -matrix 2000 -reads 12 -link 10 , and the second round with parameters -matrix 2000 -reads 8 -link 10 . A gap of 100 bp (represented with ‘N’s) was inserted between joined contigs. The resulting primary scaffold set was named s1."
              },
              {
                "id": "Par49",
                "text": "Bionano cmaps were generated using the Bionano Pipeline in non-haplotype assembly mode and used to further scaffold the s1 assembly with Bionano Solve v3.2.1 87 . We began with a one-enzyme nick map (BspQI), followed by a two-enzyme nick map (BspQI and BssSI), and then with a DLE-1 one-enzyme non-nicking approach when the later data type became available (Supplementary Table 9 ). Scaffold gaps were sized according to the software estimate. The resulting scaffold set was named s2."
              },
              {
                "id": "Par50",
                "text": "Hi-C reads were aligned to the s2 scaffolds using the Arima Genomics mapping pipeline 88 . In brief, both ends of a read pair were mapped independently using BWA-MEM 89 with the parameter -B8 , and filtered when mapping quality was <10. Chimeric reads containing a restriction enzyme site were trimmed from the restriction site onward, leaving only the 5′ end. The filtered single-read alignments were then rejoined as paired read alignments. The processed alignments were then used for scaffolding with Salsa2 79 , which analyses the normalized frequency of Hi-C interactions between all pairs of contig ends to determine a likely ordering and orientation of each. We used parameters -m yes -i 5 -p yes to allow Salsa2 to break potentially mis-assembled contigs and perform five iterations of scaffolding. After feedback from curation, later versions of Salsa were developed, which more conservatively determine the number of iterations (v2.1) and actively break at mis-assemblies (v2.2), and run for the Canada lynx, Goode’s thornscrub tortoise, and two-lined caecilian. The restriction enzyme(s) used to generate each library were specified using parameters -e GATC,GANTC for Arima and -e GATC for Dovetail and Phase Genomics Hi-C data. The resulting Hi-C scaffolded assembly was named s3."
              },
              {
                "id": "Par51",
                "text": "To polish bases in both haplotypes with minimal alignment bias, we concatenated the alternate haplotig set (c2 in v1.0 or q2 in v1.5–1.6) to the scaffolded primary set (s3) and the assembled mitochondrial genome (mitoVGP in v1.6). We then performed another round of polishing with Arrow (smrtanalysis 5.1.0.26412) using PacBio CLR reads, aligning with pbalign --minAccuracy=0.75 --minLength=50 --minAnchorSize=12 --maxDivergence=30 –concordant --algorithm=blasr --algorithmOptions=--useQuality --maxHits=1 --hitPolicy=random --seed=1 and consensus polishing with variantCaller --skipUnrecognizedContigs haploid -x 5 -q 20 -X120 –v --algorithm=arrow . While this round of polishing resulted in higher QV for all genomes herein considered, we noticed that it was particularly sensitive to the coverage cutoff parameter ( -x ). This is because Arrow generates a de novo consensus from the mapped reads without explicitly considering the reference sequence. Later, we found that the second round of Arrow polishing sometimes reduced the QV accuracy for some species. Upon investigation, this issue was traced back to option -x 5 , which requires at least 5 reads to call consensus. Such low minimum requirements can lead to uneven polishing in low coverage regions. To avoid this behaviour, we suggest to increase the -x close to the half sequence coverage (for example, 30× when 60× was used for assembly) and check QV before moving forward."
              },
              {
                "id": "Par52",
                "text": "For genomes with a combined assembly size larger than 4 Gb, we used Minimap2 90 with parameters -ax map-pb instead of Blasr 91 to overcome reference index size limitations."
              },
              {
                "id": "Par53",
                "text": "Two more rounds of base-pair polishing were performed with linked reads. The reads were aligned with Longranger align 2.2.2, which incorporates the Lauriat for barcode-aware alignment 83 . From the alignments, homozygous mismatches (variants) were called with FreeBayes 83 v1.2.0 using default options. Consensus was called with bcftools consensus 92 with -i’QUAL>1 && (GT=’’AA’’ || GT = ‘’Aa’’)’ -Hla ."
              },
              {
                "id": "Par54",
                "text": "The trio pipeline is similarly designed to the standard pipeline, except for the use of parental data (Extended Data Fig. 3b ). When parental genomes are available, the child’s CLR reads are binned to maternal and paternal haplotypes, and assembled separately as haplotype-specific contigs (haplotigs) using TrioCanu 20 . In brief, parental specific marker k -mers were collected using Meryl 23 from the parental Illumina WGS reads of the parents. These markers were filtered and used to bin the child’s CLR read. A haplotype was assigned given the markers observed, normalized by the total markers in each haplotype. The subsequent purging, scaffolding, and polishing steps were similarly updated with the use of Purge_Dups 14 (v1.6). We extended binning to linked reads and Hi-C reads, by excluding read pairs that had any parental-specific marker. The binned Hi-C reads were used to scaffold its haplotype assembly, and polished with the binned linked reads from the observation of haplotype switching using the standard polishing approach. During curation, one of the haplotype assemblies with the higher QV and/or contiguity was chosen as the representative haplotype. The heterogametic sex chromosome from the unchosen haplotype was added to the representative assembly. However, while curating several trios, we found that in regions of low divergence between shared parental homogametic sex chromosomes (that is, X or Z), a small fraction of offspring CLR data was mis-assigned to the wrong haplotype. This mis-alignment resulted in a duplicate, low-coverage offspring X or Z assembly in the paternal (for mammals) or maternal (for birds) haplotype, respectively, which required removal during curation. We are working on methods to improve the binning accuracy for resolution of this issue going forward."
              },
              {
                "id": "Par55",
                "text": "For the female zebra finch in particular, contigs were generated before the binning was automated in the Canu assembler as TrioCanu1.7, and therefore a manual binning process was applied as described in the original Trio-binning paper 20 ( Supplementary Methods ). Contigs were assembled for each haplotype using the binned reads, excluding unclassified reads. The contigs were polished with two rounds of Arrow polishing using the binned reads, and scaffolded following the v1.0 pipeline with no purging. Additional scaffolding rounds with Bionano (s4) and Hi-C were applied. Scaffolds were renamed according to the primary scaffold assembly of the same individual (s5), with sex chromosomes grouped as Z in the paternal assembly and W in the maternal assembly following synteny to the Z chromosome from the curated male zebra finch VGP assembly. Two rounds of SR polishing were applied using linked reads, by mapping on both haplotypes. After haplotype switches were discovered, additional rounds of polishing were applied using binned linked reads ( Supplementary Methods )."
              },
              {
                "id": "Par56",
                "text": "Similar to other recent methods 93 , 94 , we developed a reference-guided MT assembly pipeline. MT reads in the raw CLR data were identified by mapping the whole read set to an existing reference sequence of the specific species or of closely related species using Blasr. Filtered mtDNA CLRs were assembled into a single contig using Canu v1.8, polished with Arrow using CLR and then FreeBayes v1.0.2 together with bcftools v1.9 using short reads from the 10XG data (Extended Data Fig. 3c ). The overlapping sequences at the ends of the contig were trimmed, and the remaining contig sequence circularized. The mitoVGP pipeline is made available at https://github.com/VGP/vgp-assembly/tree/master/mitoVGP . A more detailed protocol description of the assembly pipeline and new discoveries from the MT assemblies are published elsewhere 33 ."
              }
            ]
          },
          {
            "id": "Sec46",
            "title": "Curation",
            "paragraphs": [
              {
                "id": "Par57",
                "text": "The VGP genome assembly pipeline produces high quality assemblies, yet no automated method to date is free from the production of errors, especially during the scaffolding stages. To minimize the impact of the remaining algorithmic shortcomings, we subjected all assemblies to rigorous manual curation. All data generated for a species in this study and other publicly available data (for example, genetic maps, gene sets and genome assemblies of the same or closely related species) were collated, aligned to the primary assembly and analysed in gEVAL 95 ( https://vgp-geval.sanger.ac.uk/index.html ), visualizing discordances in a feature browser and issue lists. In parallel, Hi-C data were mapped to the primary assembly and visualized using Juicebox 96 and/or HiGlass 97 . With these data, genome curators identified mis-joins, missed joins and other anomalies, and corrected the primary assembly accordingly. No change was made without unambiguous evidence from available data types; for example, a Hi-C suggested join would not be made unless supported by BioNano maps, long-read data, or gene alignments. When sequencing the heterogametic sex, we identified sex chromosomes based on half coverage, homology alignments to sex chromosomes in other species, and the presence of sex chromosome-specific genes."
              },
              {
                "id": "Par58",
                "text": "A succession of searches was used to identify potential contaminants in the generated assemblies."
              },
              {
                "id": "Par59",
                "text": "1) A megaBLAST 98 search against a database of common contaminants (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/contam_in_euks.fa.gz) requiring e ≤ 1 × 10 −4 , reporting matches with ≥98% sequence identity and match length 50–99 bp, ≥94% and match length 100–199 bp, or ≥90% and match length 200 bp or above."
              },
              {
                "id": "Par60",
                "text": "2) A vecscreen ( https://www.ncbi.nlm.nih.gov/tools/vecscreen/ ) search against a database of adaptor sequences (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/adaptors_for_screening_euks.fa)"
              },
              {
                "id": "Par61",
                "text": "3) After soft-masking repeats using Windowmasker 75 , a megaBLAST search against chromosome-level assemblies from RefSeq requiring e ≤ 1 × 10 −4 , match score ≥100, and sequence identity ≥98%; regions matching highly conserved rDNAs were ignored."
              },
              {
                "id": "Par62",
                "text": "Manual inspection of the results was necessary to differentiate contamination from conservation and/or horizontal gene transfer. Adaptor sequences were masked; other contaminant sequences were removed. Assemblies were also checked for runs of Ns at the ends of scaffolds, created as artefacts of the iterative scaffolding process, and when found they were trimmed."
              },
              {
                "id": "Par63",
                "text": "These were detected by a megaBLAST search against a database of known organelle genomes requiring e ≤ 1 × 10 −4 , sequence identity ≥90%, and match length ≥500; the databases are available at ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/mito.nt.gz and ftp://ftp.ncbi.nlm.nih.gov/refseq/release/plastid/*genomic.fna.gz. Only scaffolds consisting entirely of organelle sequences were assumed to be organelle genomes, and replaced by the genome from the separate organelle assembly pipeline. Organelle matches embedded in nuclear sequences that were found to be NuMTs were kept."
              },
              {
                "id": "Par64",
                "text": "Retained false duplications were identified using Purge_Haplotigs 13 run either after scaffolding and polishing (Anna’s hummingbird, kākāpō, male zebra finch, female zebra finch, platypus, pale spear-nosed bat, and greater horseshoe bat) or on the c1 before scaffolding (two-lined caecilian, flier cichlid, Canada lynx, and Goode’s thornscrub tortoise). Subsequent manual curation identified additional haplotypic duplications for the listed assemblies and also those that were not treated with Purge_Haplotigs (Eastern happy, climbing perch, zig-zag eel). The evidence used included read coverage, sequence self-comparison, transcript alignments, Bionano map alignments and Hi-C 2D maps, all confirming the superfluous nature of one allele. The identified haplotype duplications were moved from the primary to the alternate assembly."
              },
              {
                "id": "Par65",
                "text": "For a scaffold to be annotated as a chromosome, we used evidence from Hi-C as well as genetic linkage or FISH karyotype mapping when available. For Hi-C evidence, we considered a scaffold as a complete chromosome (albeit with gaps) when there was a clear unbroken diagonal in the Juicebox or HiGlass plots for that scaffold and no other large scaffolds that could be joined to that same scaffold; if present and no unambiguous join was possible, we named it as an unlocalized scaffold for that chromosome. When we could not find evidence of a complete chromosome, we kept the scaffold number for its name. We named all evidence-validated scaffolds as chromosomes down to the smallest Hi-C box unit resolution allowed with these characteristics. When there was an established chromosome terminology for a given species or set of species, we use the established terminology except when our new assemblies revealed errors in the older assembly, such as scaffold/chromosome fusions, fissions, rearrangements, and non-chromosome names. For species without an established chromosome terminology, we named the scaffolds as chromosomes numbers 1, 2, 3 …, in descending order of scaffold size. For the sex chromosomes, we used the letters X and Y for mammals and Z and W for birds."
              },
              {
                "id": "Par66",
                "text": "In cases where a high-quality chromosome-level genome was available for a closely related species, comparative genome analysis was performed. The polished primary assembly (t3.p) was mapped to the related genome using MashMap2 86 with --pi 75 -s 300000 . The number of chromosomal differences was identified using a custom script available at https://github.com/jdamas13/assembly_comparison . This resulted in the identification of ~60 to ~450 regions for each genome assembly flanking putative misassemblies or lineage-specific genome rearrangements. To identify which were real misassemblies, the identified discrepancies were communicated to the curation team for manual verification (see above)."
              },
              {
                "id": "Par67",
                "text": "To identify any possible remaining mis-joins, each curated avian and mammalian assembly was compared with the zebra finch (taeGut2) or human (hg38) genomes, respectively. Pairwise alignments between each of the VGP assemblies and the clade reference were generated with LastZ 99 (version 1.04) using the following parameters: C = 0 E = 30 H = 2000 K = 3000 L = 2200 O = 400. The pairwise alignments were converted into the UCSC ‘chain’ and ‘net’ formats with axtChain (parameters: -minScore = 1000 -verbose = 0 -linearGap = medium ) followed by chainAntiRepeat, chainSort, chainPreNet, chainNet and netSyntenic, all with default parameters 100 . Pairwise synteny blocks were defined using maf2synteny 101 at 100-, 300-, and 500-kb resolutions. Evolutionary breakpoint regions were detected and classified using an ad hoc statistical approach 102 . This analysis identified 2 to 90 genomic regions per assembly that could be flanking misassemblies, lineage-specific chromosome rearrangements, or reference-specific chromosome rearrangements (116 in the human and 26 in the zebra finch). Determining the underlying cause for each of the flagged regions will need further verification. All alignments are available for visualization at the Evolution Highway comparative chromosome browser ( http://eh-demo.ncsa.illinois.edu/vgp/ )."
              }
            ]
          },
          {
            "id": "Sec52",
            "title": "Annotation",
            "paragraphs": [
              {
                "id": "Par68",
                "text": "NCBI and Ensembl annotation pipeline used in this study are described in the Supplementary Methods ."
              }
            ]
          },
          {
            "id": "Sec53",
            "title": "Evaluation",
            "paragraphs": [
              {
                "id": "Par69",
                "text": "Detailed methods for other types of evaluation, including BUSCO runs, mis-join and missed-join identification, reliable blocks, collapsed repeats, telomeres, RNA-seq and ATAC–seq mapping, and false gene duplications are in the Supplementary Methods . No statistical methods were used to predetermine sample size, the experiments were not randomized, and the investigators were not blinded to group during experiments and outcome assessment."
              }
            ]
          },
          {
            "id": "Sec54",
            "title": "Reporting summary",
            "paragraphs": [
              {
                "id": "Par70",
                "text": "Further information on research design is available in the Nature Research Reporting Summary linked to this paper."
              }
            ]
          }
        ]
      },
      {
        "id": "Sec18",
        "title": "Genome assembly naming",
        "paragraphs": [
          {
            "id": "Par28",
            "text": "For each completed assembly of an individual, we gave that assembly an abbreviated name with the following rules: Lineage/GenusSpecies/Individual#.Assembly#. The first letter, in lowercase, identifies the particular lineage: m, mammals; b, birds; r, reptiles; a, amphibians; f, teleost fish; and s, sharks and other cartilaginous fishes. The next three letters (first in caps) identify the species scientific genus name; the next three letters (first in caps) identifies the specific species name. In the last position is the genome identifier, where integers (1, 2, 3, …) represent different individuals of the same species, and decimals (1.1, 1.2, 1.3, …) represent different assemblies of the same individual. For example, the first submission of the curated Anna’s hummingbird ( Calypte anna ) assembly is bCalAnn1.1, and an updated assembly for the same individual is bCalAnn1.2. When the abbreviated lineage or genus and species names for two or more species were identical, we replaced the subsequent letters (fourth, fifth and so on) of the genus or species name until they could be differentiated. We have created abbreviated names for all 71,657 vertebrate species ( http://vgpdb.snu.ac.kr/splist/ ; https://id.tol.sanger.ac.uk/ )."
          }
        ]
      },
      {
        "id": "Sec19",
        "title": "Sample collection",
        "paragraphs": [
          {
            "id": "Par29",
            "text": "The production of high-quality genome assemblies required us to obtain high-quality cells or tissue that would yield high-molecular-weight (HMW) DNA for long-read sequencing technologies (CLR and ONT) and optical mapping (Bionano). Therefore, we obtained fresh-frozen samples of various tissues (Supplementary Table 8 ). All samples were obtained according to approved protocols of the respective animal care and use committees or permits obtained by the respective persons and institutions listed in Supplementary Table 8 . Additional details of the samples are on their respective BioSample pages ( https://www.ncbi.nlm.nih.gov/biosample ; accession numbers in Supplementary Table 8 ). All tissue types tested yielded a sufficient quantity and quality of DNA for sequencing and assembly, but we found that blood worked best for species that have nucleated red blood cells (that is, bird and reptiles), and spleen or cultured cells worked best for mammals, as of to date. Analysis of different tissue types will be presented elsewhere (in preparation)."
          }
        ]
      },
      {
        "id": "Sec20",
        "title": "Isolation of high-molecular-weight DNA",
        "paragraphs": [
          {
            "id": "Par30",
            "text": "For tissue, HMW DNA was extracted using the Bionano animal tissue DNA isolation fibrous tissue protocol (cat no. RE-013-10; document number 30071), according to the manufacturer’s guidelines. A total of 25–30 mg was fixed in 2% formaldehyde and homogenized using the Qiagen TissueRuptor or manual tissue disruption. For nucleated blood, 27–54 μl was used with an adapted protocol (Bionano, personal communication) of the Bionano Prep Blood and Cell Culture DNA Isolation Kit (cat no. RE-130-10). Lysates were embedded into agarose plugs and treated with Proteinase K and RNase A. Plugs were then purified by drop dialysis with 1× TE. DNA quality was assessed using pulse field gel electrophoresis (PFGE) (Pippin Pulse, SAGE Science, Beverly, MA) or the Femto Pulse instrument (Agilent). PFGE revealed that we isolated ultra-high-molecular-weight DNA between ~100 and ~500 kb long."
          },
          {
            "id": "Par31",
            "text": "For some samples, we performed phenol–chloroform extractions for HMW gDNA. Snap-frozen tissue was pulverized into a fine powder with a mortar and pestle in liquid nitrogen. The powdered tissue was lysed overnight at 55 °C in high-salt tissue lysis buffer (400 mM NaCl, 20 mM Tris base (pH 8.0), 30 mM EDTA (pH 8.0), 0.5% SDS, 100 μg/ml Proteinase K), and powdered lung tissue was lysed overnight in Qiagen G2 lysis buffer (cat no. 1014636, Qiagen, Hilden, Germany) containing 100 μg/ml Proteinase K at 55 °C. RNA was removed by incubation in 50 μg/ml RNase A for 1 h at 37 °C. HMW gDNA was purified with two washes of phenol–chloroform-IAA equilibrated to pH 8.0, followed by two washes of chloroform-IAA, and precipitated in ice-cold 100% ethanol. Filamentous HMW gDNA was either spooled with shepherds hooks or collected by centrifugation. HMW gDNA was washed twice with 70% ethanol, dried for 20 min at room temperature and eluted in TE. For the flier cichlid muscle gDNA sample used for PacBio CLR and 10XG libraries, glycogen was precipitated by adding 1/10 (v/v) 0.3 M sodium acetate, pH 6.0 to the extracted genomic DNA, mixing carefully and spinning at room temperature at 10,000 g . PFGE revealed thatDNA molecule length was between 50 and 300 kb—often lower in size than that obtained with the agarose plug but sufficient for long-range sequencing of CLR and linked read data types."
          },
          {
            "id": "Par32",
            "text": "We also used the Qiagen MagAttract HMW DNA kit (cat no. 67563) and the KingFisher Cell and Tissue DNA kit (Thermo Scientific; cat no. 97030196), following the manufacturers’ guidelines. These protocols yielded HMW DNA ranging from 30 to 50 kb. The Genomic Tip (Qiagen) kit was also used for tissue-based extraction of HMW DNA."
          }
        ],
        "subsections": [
          {
            "id": "Sec21",
            "title": "Agarose plug DNA isolation",
            "paragraphs": [
              {
                "id": "Par30",
                "text": "For tissue, HMW DNA was extracted using the Bionano animal tissue DNA isolation fibrous tissue protocol (cat no. RE-013-10; document number 30071), according to the manufacturer’s guidelines. A total of 25–30 mg was fixed in 2% formaldehyde and homogenized using the Qiagen TissueRuptor or manual tissue disruption. For nucleated blood, 27–54 μl was used with an adapted protocol (Bionano, personal communication) of the Bionano Prep Blood and Cell Culture DNA Isolation Kit (cat no. RE-130-10). Lysates were embedded into agarose plugs and treated with Proteinase K and RNase A. Plugs were then purified by drop dialysis with 1× TE. DNA quality was assessed using pulse field gel electrophoresis (PFGE) (Pippin Pulse, SAGE Science, Beverly, MA) or the Femto Pulse instrument (Agilent). PFGE revealed that we isolated ultra-high-molecular-weight DNA between ~100 and ~500 kb long."
              }
            ]
          },
          {
            "id": "Sec22",
            "title": "Phenol–chloroform gDNA extraction",
            "paragraphs": [
              {
                "id": "Par31",
                "text": "For some samples, we performed phenol–chloroform extractions for HMW gDNA. Snap-frozen tissue was pulverized into a fine powder with a mortar and pestle in liquid nitrogen. The powdered tissue was lysed overnight at 55 °C in high-salt tissue lysis buffer (400 mM NaCl, 20 mM Tris base (pH 8.0), 30 mM EDTA (pH 8.0), 0.5% SDS, 100 μg/ml Proteinase K), and powdered lung tissue was lysed overnight in Qiagen G2 lysis buffer (cat no. 1014636, Qiagen, Hilden, Germany) containing 100 μg/ml Proteinase K at 55 °C. RNA was removed by incubation in 50 μg/ml RNase A for 1 h at 37 °C. HMW gDNA was purified with two washes of phenol–chloroform-IAA equilibrated to pH 8.0, followed by two washes of chloroform-IAA, and precipitated in ice-cold 100% ethanol. Filamentous HMW gDNA was either spooled with shepherds hooks or collected by centrifugation. HMW gDNA was washed twice with 70% ethanol, dried for 20 min at room temperature and eluted in TE. For the flier cichlid muscle gDNA sample used for PacBio CLR and 10XG libraries, glycogen was precipitated by adding 1/10 (v/v) 0.3 M sodium acetate, pH 6.0 to the extracted genomic DNA, mixing carefully and spinning at room temperature at 10,000 g . PFGE revealed thatDNA molecule length was between 50 and 300 kb—often lower in size than that obtained with the agarose plug but sufficient for long-range sequencing of CLR and linked read data types."
              }
            ]
          },
          {
            "id": "Sec23",
            "title": "Others",
            "paragraphs": [
              {
                "id": "Par32",
                "text": "We also used the Qiagen MagAttract HMW DNA kit (cat no. 67563) and the KingFisher Cell and Tissue DNA kit (Thermo Scientific; cat no. 97030196), following the manufacturers’ guidelines. These protocols yielded HMW DNA ranging from 30 to 50 kb. The Genomic Tip (Qiagen) kit was also used for tissue-based extraction of HMW DNA."
              }
            ]
          }
        ]
      },
      {
        "id": "Sec21",
        "title": "Agarose plug DNA isolation",
        "paragraphs": [
          {
            "id": "Par30",
            "text": "For tissue, HMW DNA was extracted using the Bionano animal tissue DNA isolation fibrous tissue protocol (cat no. RE-013-10; document number 30071), according to the manufacturer’s guidelines. A total of 25–30 mg was fixed in 2% formaldehyde and homogenized using the Qiagen TissueRuptor or manual tissue disruption. For nucleated blood, 27–54 μl was used with an adapted protocol (Bionano, personal communication) of the Bionano Prep Blood and Cell Culture DNA Isolation Kit (cat no. RE-130-10). Lysates were embedded into agarose plugs and treated with Proteinase K and RNase A. Plugs were then purified by drop dialysis with 1× TE. DNA quality was assessed using pulse field gel electrophoresis (PFGE) (Pippin Pulse, SAGE Science, Beverly, MA) or the Femto Pulse instrument (Agilent). PFGE revealed that we isolated ultra-high-molecular-weight DNA between ~100 and ~500 kb long."
          }
        ]
      },
      {
        "id": "Sec22",
        "title": "Phenol–chloroform gDNA extraction",
        "paragraphs": [
          {
            "id": "Par31",
            "text": "For some samples, we performed phenol–chloroform extractions for HMW gDNA. Snap-frozen tissue was pulverized into a fine powder with a mortar and pestle in liquid nitrogen. The powdered tissue was lysed overnight at 55 °C in high-salt tissue lysis buffer (400 mM NaCl, 20 mM Tris base (pH 8.0), 30 mM EDTA (pH 8.0), 0.5% SDS, 100 μg/ml Proteinase K), and powdered lung tissue was lysed overnight in Qiagen G2 lysis buffer (cat no. 1014636, Qiagen, Hilden, Germany) containing 100 μg/ml Proteinase K at 55 °C. RNA was removed by incubation in 50 μg/ml RNase A for 1 h at 37 °C. HMW gDNA was purified with two washes of phenol–chloroform-IAA equilibrated to pH 8.0, followed by two washes of chloroform-IAA, and precipitated in ice-cold 100% ethanol. Filamentous HMW gDNA was either spooled with shepherds hooks or collected by centrifugation. HMW gDNA was washed twice with 70% ethanol, dried for 20 min at room temperature and eluted in TE. For the flier cichlid muscle gDNA sample used for PacBio CLR and 10XG libraries, glycogen was precipitated by adding 1/10 (v/v) 0.3 M sodium acetate, pH 6.0 to the extracted genomic DNA, mixing carefully and spinning at room temperature at 10,000 g . PFGE revealed thatDNA molecule length was between 50 and 300 kb—often lower in size than that obtained with the agarose plug but sufficient for long-range sequencing of CLR and linked read data types."
          }
        ]
      },
      {
        "id": "Sec23",
        "title": "Others",
        "paragraphs": [
          {
            "id": "Par32",
            "text": "We also used the Qiagen MagAttract HMW DNA kit (cat no. 67563) and the KingFisher Cell and Tissue DNA kit (Thermo Scientific; cat no. 97030196), following the manufacturers’ guidelines. These protocols yielded HMW DNA ranging from 30 to 50 kb. The Genomic Tip (Qiagen) kit was also used for tissue-based extraction of HMW DNA."
          }
        ]
      },
      {
        "id": "Sec24",
        "title": "Libraries and sequencing",
        "paragraphs": [
          {
            "id": "Par33",
            "text": "DNA obtained from agarose plugs was sheared down to ~40 kb fragment size with a MegaRuptor device (Diagenode, Belgium) and fragmented using Covaris g-tubes (520079) or by needle shearing. PacBio large insert libraries were prepared with either the SMRTbell Template Prep Kit 1.0‐SPv3 (no.100‐991‐900) or the SMRTbell Express Template Prep Kit v1 (no. 101‐357‐000). Libraries were size-selected between 12 and 25 kb using Sage BluePippin (Sage Science, USA), depending on the DNA quality and extraction method. These libraries were sequenced on either RSII or Sequel I instruments, at least 60× coverage per species using Sequel Binding Kit and Sequencing Plate versions 2.0 and 2.1 with 10-h movie time (Supplementary Table 9 )."
          },
          {
            "id": "Par34",
            "text": "Unfragmented HMW DNA from the agarose plugs was used to generate linked read libraries on the 10X Genomics Chromium platform (Genome Library Kit & Gel Bead Kit v2 PN-120258, Genome Chip Kit v2 PN-120257, i7 Multiplex Kit PN-120262) following the manufacturer’s guidelines. We sequenced the 10X libraries at ~60× coverage per species on an Illumina NovaSeq S4 150-bp PE lane."
          },
          {
            "id": "Par35",
            "text": "Unfragmented ultra-HMW DNA from the agarose plugs was labelled using either two different nicking enzymes (BspQI and BssSI) or a direct labelling enzyme (DLE1) following the Bionano Prep Labelling NLRS (document number 30024) and DLS protocols, respectively (document number 30206). Labelled samples were then imaged on a Bionano Irys or on a Bionano Saphyr instrument. For all species, we aimed for at least 100× coverage per label (Supplementary Table 9 )."
          },
          {
            "id": "Par36",
            "text": "Chromatin interaction (Hi-C) libraries were generated using either Arima Genomics, Dovetail Genomics, or Phase libraries on muscle, blood, or other tissue with in vivo cross-linking (Supplementary Table 9 ) and sequenced on Illumina instruments. Arima-HiC preparations were performed by Arima Genomics ( https://arimagenomics.com/ ) using the Arima-HiC kit that uses two enzymes (P/N: A510008). The resulting Arima-HiC proximally ligated DNA was then sheared, size-selected around 200–600 bp using SPRI beads, and enriched for biotin-labelled proximity-ligated DNA using streptavidin beads. From these fragments, Illumina-compatible libraries were generated using the KAPA Hyper Prep kit (P/N: KK8504). The resulting libraries were PCR amplified and purified with SPRI beads. The quality of the final libraries was checked with qPCR and Bioanalyzer, and then sequenced on Illumina HiSeq X at ~60× coverage following the manufacturer’s protocols. Dovetail-HiC preparations were performed by Dovetail using a single-enzyme (DpnII) proximity ligation approach. Phase-HiC libraries were made by Phase Genomics using a Proximo Hi-C Library single-enzyme reaction."
          }
        ],
        "subsections": [
          {
            "id": "Sec25",
            "title": "PacBio libraries and sequencing",
            "paragraphs": [
              {
                "id": "Par33",
                "text": "DNA obtained from agarose plugs was sheared down to ~40 kb fragment size with a MegaRuptor device (Diagenode, Belgium) and fragmented using Covaris g-tubes (520079) or by needle shearing. PacBio large insert libraries were prepared with either the SMRTbell Template Prep Kit 1.0‐SPv3 (no.100‐991‐900) or the SMRTbell Express Template Prep Kit v1 (no. 101‐357‐000). Libraries were size-selected between 12 and 25 kb using Sage BluePippin (Sage Science, USA), depending on the DNA quality and extraction method. These libraries were sequenced on either RSII or Sequel I instruments, at least 60× coverage per species using Sequel Binding Kit and Sequencing Plate versions 2.0 and 2.1 with 10-h movie time (Supplementary Table 9 )."
              }
            ]
          },
          {
            "id": "Sec26",
            "title": "10X Chromium libraries and sequencing",
            "paragraphs": [
              {
                "id": "Par34",
                "text": "Unfragmented HMW DNA from the agarose plugs was used to generate linked read libraries on the 10X Genomics Chromium platform (Genome Library Kit & Gel Bead Kit v2 PN-120258, Genome Chip Kit v2 PN-120257, i7 Multiplex Kit PN-120262) following the manufacturer’s guidelines. We sequenced the 10X libraries at ~60× coverage per species on an Illumina NovaSeq S4 150-bp PE lane."
              }
            ]
          },
          {
            "id": "Sec27",
            "title": "Bionano libraries and optical map imaging",
            "paragraphs": [
              {
                "id": "Par35",
                "text": "Unfragmented ultra-HMW DNA from the agarose plugs was labelled using either two different nicking enzymes (BspQI and BssSI) or a direct labelling enzyme (DLE1) following the Bionano Prep Labelling NLRS (document number 30024) and DLS protocols, respectively (document number 30206). Labelled samples were then imaged on a Bionano Irys or on a Bionano Saphyr instrument. For all species, we aimed for at least 100× coverage per label (Supplementary Table 9 )."
              }
            ]
          },
          {
            "id": "Sec28",
            "title": "Hi-C libraries and sequencing",
            "paragraphs": [
              {
                "id": "Par36",
                "text": "Chromatin interaction (Hi-C) libraries were generated using either Arima Genomics, Dovetail Genomics, or Phase libraries on muscle, blood, or other tissue with in vivo cross-linking (Supplementary Table 9 ) and sequenced on Illumina instruments. Arima-HiC preparations were performed by Arima Genomics ( https://arimagenomics.com/ ) using the Arima-HiC kit that uses two enzymes (P/N: A510008). The resulting Arima-HiC proximally ligated DNA was then sheared, size-selected around 200–600 bp using SPRI beads, and enriched for biotin-labelled proximity-ligated DNA using streptavidin beads. From these fragments, Illumina-compatible libraries were generated using the KAPA Hyper Prep kit (P/N: KK8504). The resulting libraries were PCR amplified and purified with SPRI beads. The quality of the final libraries was checked with qPCR and Bioanalyzer, and then sequenced on Illumina HiSeq X at ~60× coverage following the manufacturer’s protocols. Dovetail-HiC preparations were performed by Dovetail using a single-enzyme (DpnII) proximity ligation approach. Phase-HiC libraries were made by Phase Genomics using a Proximo Hi-C Library single-enzyme reaction."
              }
            ]
          }
        ]
      },
      {
        "id": "Sec25",
        "title": "PacBio libraries and sequencing",
        "paragraphs": [
          {
            "id": "Par33",
            "text": "DNA obtained from agarose plugs was sheared down to ~40 kb fragment size with a MegaRuptor device (Diagenode, Belgium) and fragmented using Covaris g-tubes (520079) or by needle shearing. PacBio large insert libraries were prepared with either the SMRTbell Template Prep Kit 1.0‐SPv3 (no.100‐991‐900) or the SMRTbell Express Template Prep Kit v1 (no. 101‐357‐000). Libraries were size-selected between 12 and 25 kb using Sage BluePippin (Sage Science, USA), depending on the DNA quality and extraction method. These libraries were sequenced on either RSII or Sequel I instruments, at least 60× coverage per species using Sequel Binding Kit and Sequencing Plate versions 2.0 and 2.1 with 10-h movie time (Supplementary Table 9 )."
          }
        ]
      },
      {
        "id": "Sec26",
        "title": "10X Chromium libraries and sequencing",
        "paragraphs": [
          {
            "id": "Par34",
            "text": "Unfragmented HMW DNA from the agarose plugs was used to generate linked read libraries on the 10X Genomics Chromium platform (Genome Library Kit & Gel Bead Kit v2 PN-120258, Genome Chip Kit v2 PN-120257, i7 Multiplex Kit PN-120262) following the manufacturer’s guidelines. We sequenced the 10X libraries at ~60× coverage per species on an Illumina NovaSeq S4 150-bp PE lane."
          }
        ]
      },
      {
        "id": "Sec27",
        "title": "Bionano libraries and optical map imaging",
        "paragraphs": [
          {
            "id": "Par35",
            "text": "Unfragmented ultra-HMW DNA from the agarose plugs was labelled using either two different nicking enzymes (BspQI and BssSI) or a direct labelling enzyme (DLE1) following the Bionano Prep Labelling NLRS (document number 30024) and DLS protocols, respectively (document number 30206). Labelled samples were then imaged on a Bionano Irys or on a Bionano Saphyr instrument. For all species, we aimed for at least 100× coverage per label (Supplementary Table 9 )."
          }
        ]
      },
      {
        "id": "Sec28",
        "title": "Hi-C libraries and sequencing",
        "paragraphs": [
          {
            "id": "Par36",
            "text": "Chromatin interaction (Hi-C) libraries were generated using either Arima Genomics, Dovetail Genomics, or Phase libraries on muscle, blood, or other tissue with in vivo cross-linking (Supplementary Table 9 ) and sequenced on Illumina instruments. Arima-HiC preparations were performed by Arima Genomics ( https://arimagenomics.com/ ) using the Arima-HiC kit that uses two enzymes (P/N: A510008). The resulting Arima-HiC proximally ligated DNA was then sheared, size-selected around 200–600 bp using SPRI beads, and enriched for biotin-labelled proximity-ligated DNA using streptavidin beads. From these fragments, Illumina-compatible libraries were generated using the KAPA Hyper Prep kit (P/N: KK8504). The resulting libraries were PCR amplified and purified with SPRI beads. The quality of the final libraries was checked with qPCR and Bioanalyzer, and then sequenced on Illumina HiSeq X at ~60× coverage following the manufacturer’s protocols. Dovetail-HiC preparations were performed by Dovetail using a single-enzyme (DpnII) proximity ligation approach. Phase-HiC libraries were made by Phase Genomics using a Proximo Hi-C Library single-enzyme reaction."
          }
        ]
      },
      {
        "id": "Sec29",
        "title": "Quality control",
        "paragraphs": [
          {
            "id": "Par37",
            "text": "Before we performed any assembly, all genomic data of all data types from each sample were used to screen potential outlier libraries, outlier sequencing runs, or accidental species contamination with Mash 73 by measuring sequence similarity (Supplementary Fig. 4 ). When running Mash, we used 21-mers to generate sketches with sketch size of 10,000 and compared among each sequencing run, and then differences assessed between sequencing sets."
          }
        ]
      },
      {
        "id": "Sec30",
        "title": "Genome size, repeat content, and heterozygosity estimations",
        "paragraphs": [
          {
            "id": "Par38",
            "text": "These estimations were made with k -mer-based methods applied to the Illumina short reads obtained from 10XG linked sequencing libraries. After trimming off barcodes during scaff10x 74 preprocessing, canonical 31-mer counts were collected using Meryl 23 . With the resulting 31-mer histogram, GenomeScope 71 was used to estimate the haploid genome length, repeat content, and heterozygosity. The thorny skate linked read data failed quality control, which we suspect was due to low complexity sequences from the high repeat content (54.1%) of the genome; so k -mers were collected later from Illumina whole-genome sequencing reads instead. The genome size and repeat content of the channel bull blenny were estimated from an alternative method that looks at the mode of long read overlap coverage and WindowMasker 75 , as the estimated genome size from GenomeScope was almost doubling the known haploid genome size (1.29 Gb versus 0.6 Gb) and repeat content (28.0% versus 58.0%), for reasons related to either the quality of the 10X data or species differences."
          }
        ]
      },
      {
        "id": "Sec31",
        "title": "Benchmarking assembly steps with the Anna’s hummingbird",
        "paragraphs": [
          {
            "id": "Par39",
            "text": "To develop the VGP standard pipeline, we compared various scaffolding, gap filling, and polishing tools. Default options were used unless otherwise noted. Detailed software versions are listed in Supplementary Table 2 ."
          },
          {
            "id": "Par40",
            "text": "FALCON 76 and FALCON-Unzip 17 (smrtanalysis 3.0.0) were used to generate contigs that used CLR. Canu 77 1.5+67 was used to generate the combined PacBio CLR and Oxford Nanopore ONT assembly. To benchmark scaffolding with linked reads, we used scaff10x 74 2.0. For the linked read-only assembly, Supernova 2 78 was used. For the optical maps, two-enzyme hybrid scaffolding was used in the Bionano Solve v3.2.1 software, using BspQI and BssSI initially, as well as DLE1 later when the technology was developed. For benchmarking Hi-C in scaffolding, Salsa 2.2 79 was used for scaffolding results in Fig. 1a , with Hi-C reads generated from Arima Genomics. Additional comparisons for the Hi-C libraries were performed using assemblies provided by Dovetail Genomics and Phase Genomics (Supplementary Table 3 ). We used Hi-C from Arima Genomics as it had the smallest number of PCR duplicates and better coverage for short and long interactions at the time of comparison (Supplementary Fig. 1 ). Assembly statistics from HiRise, Proximo HiC, 3D-DNA 80 and Arima Hi-C are available in Supplementary Table 3 . We concluded that all Hi-C scaffolding algorithms had similar performance. We decided to use Salsa, as HiRise and Proximo HiC were not open access, and 3D-DNA was computationally expensive on the DNAnexus platform. For short read assemblies, other than Supernova and the NRGene assembly, the assembly GCA_000699085.1 16 was used for benchmarking, which was generated with Illumina paired-end, multiple mate-pair libraries and the SoapDeNovo 81 assembler. The NRGene assembly was provided by the company with DeNovo Magic."
          },
          {
            "id": "Par41",
            "text": "We ran PBJelly with support --capturedOnly --spanOnly parameters, to avoid greedy gap closures with no spanning read support. For conservatively filling sequences, we compared different parameters in output stage with --minreads 1 and --minreads 4 in addition to no restrictions. We found that the number of gaps closed was similar to the gaps filled with Arrow 76 (Supplementary Table 4 ) and chose not to run PBJelly 82 for future assemblies."
          },
          {
            "id": "Par42",
            "text": "Illumina polishing benchmarking was performed using Longranger 83 2.1.3 and Pilon 84 1.21 with --fix bases, local option (Supplementary Table 5 ). Later, for the VGP pipeline, we used FreeBayes 85 as Pilon 84 was not computationally scalable for large genomes with the updated Longranger 2.2.2."
          },
          {
            "id": "Par43",
            "text": "Base-level accuracy was measured using a mapping-based approach and later using the k -mer-based approach 23 . To determine the number of rounds to polish, we used Illumina paired-end reads from the hummingbird 16 ."
          },
          {
            "id": "Par44",
            "text": "The curated hummingbird assembly was mapped to the target assemblies with MashMap2 86 with --filter_mode one-to-one --pi 95 using 5 kb segments (-s 5000) for CLR assemblies and 1 kb (-s 1000) for SR assemblies to compensate for the shorter contig sizes, as contigs smaller than a segment size will be excluded from the alignment. The number of mis-joins and missed joins were identified using the assembly_comparison.pl used in the ‘Curation’ section below ( Supplementary Methods , Supplementary Fig. 5 )."
          }
        ],
        "subsections": [
          {
            "id": "Sec32",
            "title": "Contigging and scaffolding",
            "paragraphs": [
              {
                "id": "Par40",
                "text": "FALCON 76 and FALCON-Unzip 17 (smrtanalysis 3.0.0) were used to generate contigs that used CLR. Canu 77 1.5+67 was used to generate the combined PacBio CLR and Oxford Nanopore ONT assembly. To benchmark scaffolding with linked reads, we used scaff10x 74 2.0. For the linked read-only assembly, Supernova 2 78 was used. For the optical maps, two-enzyme hybrid scaffolding was used in the Bionano Solve v3.2.1 software, using BspQI and BssSI initially, as well as DLE1 later when the technology was developed. For benchmarking Hi-C in scaffolding, Salsa 2.2 79 was used for scaffolding results in Fig. 1a , with Hi-C reads generated from Arima Genomics. Additional comparisons for the Hi-C libraries were performed using assemblies provided by Dovetail Genomics and Phase Genomics (Supplementary Table 3 ). We used Hi-C from Arima Genomics as it had the smallest number of PCR duplicates and better coverage for short and long interactions at the time of comparison (Supplementary Fig. 1 ). Assembly statistics from HiRise, Proximo HiC, 3D-DNA 80 and Arima Hi-C are available in Supplementary Table 3 . We concluded that all Hi-C scaffolding algorithms had similar performance. We decided to use Salsa, as HiRise and Proximo HiC were not open access, and 3D-DNA was computationally expensive on the DNAnexus platform. For short read assemblies, other than Supernova and the NRGene assembly, the assembly GCA_000699085.1 16 was used for benchmarking, which was generated with Illumina paired-end, multiple mate-pair libraries and the SoapDeNovo 81 assembler. The NRGene assembly was provided by the company with DeNovo Magic."
              }
            ]
          },
          {
            "id": "Sec33",
            "title": "Gap filling",
            "paragraphs": [
              {
                "id": "Par41",
                "text": "We ran PBJelly with support --capturedOnly --spanOnly parameters, to avoid greedy gap closures with no spanning read support. For conservatively filling sequences, we compared different parameters in output stage with --minreads 1 and --minreads 4 in addition to no restrictions. We found that the number of gaps closed was similar to the gaps filled with Arrow 76 (Supplementary Table 4 ) and chose not to run PBJelly 82 for future assemblies."
              }
            ]
          },
          {
            "id": "Sec34",
            "title": "Short-read polishing",
            "paragraphs": [
              {
                "id": "Par42",
                "text": "Illumina polishing benchmarking was performed using Longranger 83 2.1.3 and Pilon 84 1.21 with --fix bases, local option (Supplementary Table 5 ). Later, for the VGP pipeline, we used FreeBayes 85 as Pilon 84 was not computationally scalable for large genomes with the updated Longranger 2.2.2."
              }
            ]
          },
          {
            "id": "Sec35",
            "title": "Base-level accuracy estimate",
            "paragraphs": [
              {
                "id": "Par43",
                "text": "Base-level accuracy was measured using a mapping-based approach and later using the k -mer-based approach 23 . To determine the number of rounds to polish, we used Illumina paired-end reads from the hummingbird 16 ."
              }
            ]
          },
          {
            "id": "Sec36",
            "title": "Mis-joins and missed-joins",
            "paragraphs": [
              {
                "id": "Par44",
                "text": "The curated hummingbird assembly was mapped to the target assemblies with MashMap2 86 with --filter_mode one-to-one --pi 95 using 5 kb segments (-s 5000) for CLR assemblies and 1 kb (-s 1000) for SR assemblies to compensate for the shorter contig sizes, as contigs smaller than a segment size will be excluded from the alignment. The number of mis-joins and missed joins were identified using the assembly_comparison.pl used in the ‘Curation’ section below ( Supplementary Methods , Supplementary Fig. 5 )."
              }
            ]
          }
        ]
      },
      {
        "id": "Sec32",
        "title": "Contigging and scaffolding",
        "paragraphs": [
          {
            "id": "Par40",
            "text": "FALCON 76 and FALCON-Unzip 17 (smrtanalysis 3.0.0) were used to generate contigs that used CLR. Canu 77 1.5+67 was used to generate the combined PacBio CLR and Oxford Nanopore ONT assembly. To benchmark scaffolding with linked reads, we used scaff10x 74 2.0. For the linked read-only assembly, Supernova 2 78 was used. For the optical maps, two-enzyme hybrid scaffolding was used in the Bionano Solve v3.2.1 software, using BspQI and BssSI initially, as well as DLE1 later when the technology was developed. For benchmarking Hi-C in scaffolding, Salsa 2.2 79 was used for scaffolding results in Fig. 1a , with Hi-C reads generated from Arima Genomics. Additional comparisons for the Hi-C libraries were performed using assemblies provided by Dovetail Genomics and Phase Genomics (Supplementary Table 3 ). We used Hi-C from Arima Genomics as it had the smallest number of PCR duplicates and better coverage for short and long interactions at the time of comparison (Supplementary Fig. 1 ). Assembly statistics from HiRise, Proximo HiC, 3D-DNA 80 and Arima Hi-C are available in Supplementary Table 3 . We concluded that all Hi-C scaffolding algorithms had similar performance. We decided to use Salsa, as HiRise and Proximo HiC were not open access, and 3D-DNA was computationally expensive on the DNAnexus platform. For short read assemblies, other than Supernova and the NRGene assembly, the assembly GCA_000699085.1 16 was used for benchmarking, which was generated with Illumina paired-end, multiple mate-pair libraries and the SoapDeNovo 81 assembler. The NRGene assembly was provided by the company with DeNovo Magic."
          }
        ]
      },
      {
        "id": "Sec33",
        "title": "Gap filling",
        "paragraphs": [
          {
            "id": "Par41",
            "text": "We ran PBJelly with support --capturedOnly --spanOnly parameters, to avoid greedy gap closures with no spanning read support. For conservatively filling sequences, we compared different parameters in output stage with --minreads 1 and --minreads 4 in addition to no restrictions. We found that the number of gaps closed was similar to the gaps filled with Arrow 76 (Supplementary Table 4 ) and chose not to run PBJelly 82 for future assemblies."
          }
        ]
      },
      {
        "id": "Sec34",
        "title": "Short-read polishing",
        "paragraphs": [
          {
            "id": "Par42",
            "text": "Illumina polishing benchmarking was performed using Longranger 83 2.1.3 and Pilon 84 1.21 with --fix bases, local option (Supplementary Table 5 ). Later, for the VGP pipeline, we used FreeBayes 85 as Pilon 84 was not computationally scalable for large genomes with the updated Longranger 2.2.2."
          }
        ]
      },
      {
        "id": "Sec35",
        "title": "Base-level accuracy estimate",
        "paragraphs": [
          {
            "id": "Par43",
            "text": "Base-level accuracy was measured using a mapping-based approach and later using the k -mer-based approach 23 . To determine the number of rounds to polish, we used Illumina paired-end reads from the hummingbird 16 ."
          }
        ]
      },
      {
        "id": "Sec36",
        "title": "Mis-joins and missed-joins",
        "paragraphs": [
          {
            "id": "Par44",
            "text": "The curated hummingbird assembly was mapped to the target assemblies with MashMap2 86 with --filter_mode one-to-one --pi 95 using 5 kb segments (-s 5000) for CLR assemblies and 1 kb (-s 1000) for SR assemblies to compensate for the shorter contig sizes, as contigs smaller than a segment size will be excluded from the alignment. The number of mis-joins and missed joins were identified using the assembly_comparison.pl used in the ‘Curation’ section below ( Supplementary Methods , Supplementary Fig. 5 )."
          }
        ]
      },
      {
        "id": "Sec37",
        "title": "VGP standard genome assembly pipeline 1.0 to 1.6",
        "paragraphs": [
          {
            "id": "Par45",
            "text": "All 17 genomes were assembled with the VGP pipeline (Extended Data Fig. 2a ) for benchmark purposes, with some uncurated. The pale spear-nosed bat, greater horseshoe bat, Canada lynx, platypus, male and female zebra finch, kākāpō, Anna’s hummingbird, Goode’s thornscrub tortoise, flier cichlid, and blunt-snouted clingfish assemblies were generated using the VGP pipeline 1.0 to 1.6 and curated for submission to NCBI and EBI public archives. The curated and submitted two-lined caecilian, zig-zag eel, climbing perch, channel bull blenny, eastern happy, and thorny skate assemblies were generated using a similar process developed in parallel (Supplementary Note 2 ). Two submitted curated versions of the female zebra finch were made, one using the standard VGP pipeline and the other using the VGP trio pipeline, so that comparative analyses could be performed by others."
          },
          {
            "id": "Par46",
            "text": "For PacBio data, contigs were generated from subreads using FALCON 76 and FALCON-Unzip 17 , with one round of Arrow polishing (smrtanalysis 5.1.0.26412). A minimum read length of 2 kb or a cutoff at which reads longer than the cutoff include 50× coverage was used, whichever was longer. For calculating read coverage, we used estimated genome size from http://www.genomesize.com/ when available, or from the literature (Supplementary Table 11 ) while waiting for 10XG sequencing to estimate genome size using k -mers. FALCON and FALCON-Unzip were run with default parameters, except for computing the overlaps. Raw read overlaps were computed with DALIGNER parameters -k14 -e0.75 -s100 -l2500 -h240 -w8 to better reflect the higher error rate in early PacBio sequel I and II. Pread (preassembled read) overlaps were computed with DALIGNER parameters -k24 -e.90 -s100 -l1000 -h600 intending to collapse haplotypes for the FALCON step to better unzip genomes with high heterozygosity rate. FALCON-Unzip outputs both a pseudo-haplotype and a set of alternate haplotigs that represent the secondary alleles. We refer to these outputs as the primary contig set (c1) and alternate contig set (c2)."
          },
          {
            "id": "Par47",
            "text": "Heterotype false duplications occurred despite setting FALCON 76 parameters to resolve up to 10% haplotype divergence. FALCON-Unzip 17 also incorrectly retained some secondary alleles in the primary contig set, which appeared as false duplications. To reduce these false duplications, we ran Purge_Haplotigs 13 , first during curation (VGP v1.0 pipeline) and then later after contig formation (VGP v1.5 pipeline). To do the former, Purge_Haplotigs was run on the primary contigs (c1), and identified haplotigs were mapped to the scaffolded primary assembly with MashMap2 86 for removal. In the latter, identified haplotigs were moved from the primary contigs (c1) to the alternate haplotig set (p2). The remaining primary contigs were referred to as p1; p2 combined with c2 was referred to as q2. Later, in the VGP v1.6 pipeline, we replaced Purge_Haplotigs with Purge_Dups 14 , a new program developed by several of the authors in response to Purge_Haplotigs not removing partial false duplication at contig boundaries. Purging also removes excessive low-coverage (junk) and high-coverage (repeats) contigs. To calculate the presence and overall success of purging false duplications, we used a k -mer approach ( Supplementary Methods , Supplementary Fig. 6 )."
          },
          {
            "id": "Par48",
            "text": "The 10X Genomics linked reads were aligned to the primary contigs (p1), and an adjacency matrix was computed from the barcodes using scaff10x 74 v2.0–2.1. Two rounds of scaffolding were performed. The first round was run with parameters -matrix 2000 -reads 12 -link 10 , and the second round with parameters -matrix 2000 -reads 8 -link 10 . A gap of 100 bp (represented with ‘N’s) was inserted between joined contigs. The resulting primary scaffold set was named s1."
          },
          {
            "id": "Par49",
            "text": "Bionano cmaps were generated using the Bionano Pipeline in non-haplotype assembly mode and used to further scaffold the s1 assembly with Bionano Solve v3.2.1 87 . We began with a one-enzyme nick map (BspQI), followed by a two-enzyme nick map (BspQI and BssSI), and then with a DLE-1 one-enzyme non-nicking approach when the later data type became available (Supplementary Table 9 ). Scaffold gaps were sized according to the software estimate. The resulting scaffold set was named s2."
          },
          {
            "id": "Par50",
            "text": "Hi-C reads were aligned to the s2 scaffolds using the Arima Genomics mapping pipeline 88 . In brief, both ends of a read pair were mapped independently using BWA-MEM 89 with the parameter -B8 , and filtered when mapping quality was <10. Chimeric reads containing a restriction enzyme site were trimmed from the restriction site onward, leaving only the 5′ end. The filtered single-read alignments were then rejoined as paired read alignments. The processed alignments were then used for scaffolding with Salsa2 79 , which analyses the normalized frequency of Hi-C interactions between all pairs of contig ends to determine a likely ordering and orientation of each. We used parameters -m yes -i 5 -p yes to allow Salsa2 to break potentially mis-assembled contigs and perform five iterations of scaffolding. After feedback from curation, later versions of Salsa were developed, which more conservatively determine the number of iterations (v2.1) and actively break at mis-assemblies (v2.2), and run for the Canada lynx, Goode’s thornscrub tortoise, and two-lined caecilian. The restriction enzyme(s) used to generate each library were specified using parameters -e GATC,GANTC for Arima and -e GATC for Dovetail and Phase Genomics Hi-C data. The resulting Hi-C scaffolded assembly was named s3."
          },
          {
            "id": "Par51",
            "text": "To polish bases in both haplotypes with minimal alignment bias, we concatenated the alternate haplotig set (c2 in v1.0 or q2 in v1.5–1.6) to the scaffolded primary set (s3) and the assembled mitochondrial genome (mitoVGP in v1.6). We then performed another round of polishing with Arrow (smrtanalysis 5.1.0.26412) using PacBio CLR reads, aligning with pbalign --minAccuracy=0.75 --minLength=50 --minAnchorSize=12 --maxDivergence=30 –concordant --algorithm=blasr --algorithmOptions=--useQuality --maxHits=1 --hitPolicy=random --seed=1 and consensus polishing with variantCaller --skipUnrecognizedContigs haploid -x 5 -q 20 -X120 –v --algorithm=arrow . While this round of polishing resulted in higher QV for all genomes herein considered, we noticed that it was particularly sensitive to the coverage cutoff parameter ( -x ). This is because Arrow generates a de novo consensus from the mapped reads without explicitly considering the reference sequence. Later, we found that the second round of Arrow polishing sometimes reduced the QV accuracy for some species. Upon investigation, this issue was traced back to option -x 5 , which requires at least 5 reads to call consensus. Such low minimum requirements can lead to uneven polishing in low coverage regions. To avoid this behaviour, we suggest to increase the -x close to the half sequence coverage (for example, 30× when 60× was used for assembly) and check QV before moving forward."
          },
          {
            "id": "Par52",
            "text": "For genomes with a combined assembly size larger than 4 Gb, we used Minimap2 90 with parameters -ax map-pb instead of Blasr 91 to overcome reference index size limitations."
          },
          {
            "id": "Par53",
            "text": "Two more rounds of base-pair polishing were performed with linked reads. The reads were aligned with Longranger align 2.2.2, which incorporates the Lauriat for barcode-aware alignment 83 . From the alignments, homozygous mismatches (variants) were called with FreeBayes 83 v1.2.0 using default options. Consensus was called with bcftools consensus 92 with -i’QUAL>1 && (GT=’’AA’’ || GT = ‘’Aa’’)’ -Hla ."
          },
          {
            "id": "Par54",
            "text": "The trio pipeline is similarly designed to the standard pipeline, except for the use of parental data (Extended Data Fig. 3b ). When parental genomes are available, the child’s CLR reads are binned to maternal and paternal haplotypes, and assembled separately as haplotype-specific contigs (haplotigs) using TrioCanu 20 . In brief, parental specific marker k -mers were collected using Meryl 23 from the parental Illumina WGS reads of the parents. These markers were filtered and used to bin the child’s CLR read. A haplotype was assigned given the markers observed, normalized by the total markers in each haplotype. The subsequent purging, scaffolding, and polishing steps were similarly updated with the use of Purge_Dups 14 (v1.6). We extended binning to linked reads and Hi-C reads, by excluding read pairs that had any parental-specific marker. The binned Hi-C reads were used to scaffold its haplotype assembly, and polished with the binned linked reads from the observation of haplotype switching using the standard polishing approach. During curation, one of the haplotype assemblies with the higher QV and/or contiguity was chosen as the representative haplotype. The heterogametic sex chromosome from the unchosen haplotype was added to the representative assembly. However, while curating several trios, we found that in regions of low divergence between shared parental homogametic sex chromosomes (that is, X or Z), a small fraction of offspring CLR data was mis-assigned to the wrong haplotype. This mis-alignment resulted in a duplicate, low-coverage offspring X or Z assembly in the paternal (for mammals) or maternal (for birds) haplotype, respectively, which required removal during curation. We are working on methods to improve the binning accuracy for resolution of this issue going forward."
          },
          {
            "id": "Par55",
            "text": "For the female zebra finch in particular, contigs were generated before the binning was automated in the Canu assembler as TrioCanu1.7, and therefore a manual binning process was applied as described in the original Trio-binning paper 20 ( Supplementary Methods ). Contigs were assembled for each haplotype using the binned reads, excluding unclassified reads. The contigs were polished with two rounds of Arrow polishing using the binned reads, and scaffolded following the v1.0 pipeline with no purging. Additional scaffolding rounds with Bionano (s4) and Hi-C were applied. Scaffolds were renamed according to the primary scaffold assembly of the same individual (s5), with sex chromosomes grouped as Z in the paternal assembly and W in the maternal assembly following synteny to the Z chromosome from the curated male zebra finch VGP assembly. Two rounds of SR polishing were applied using linked reads, by mapping on both haplotypes. After haplotype switches were discovered, additional rounds of polishing were applied using binned linked reads ( Supplementary Methods )."
          },
          {
            "id": "Par56",
            "text": "Similar to other recent methods 93 , 94 , we developed a reference-guided MT assembly pipeline. MT reads in the raw CLR data were identified by mapping the whole read set to an existing reference sequence of the specific species or of closely related species using Blasr. Filtered mtDNA CLRs were assembled into a single contig using Canu v1.8, polished with Arrow using CLR and then FreeBayes v1.0.2 together with bcftools v1.9 using short reads from the 10XG data (Extended Data Fig. 3c ). The overlapping sequences at the ends of the contig were trimmed, and the remaining contig sequence circularized. The mitoVGP pipeline is made available at https://github.com/VGP/vgp-assembly/tree/master/mitoVGP . A more detailed protocol description of the assembly pipeline and new discoveries from the MT assemblies are published elsewhere 33 ."
          }
        ],
        "subsections": [
          {
            "id": "Sec38",
            "title": "Contigging",
            "paragraphs": [
              {
                "id": "Par46",
                "text": "For PacBio data, contigs were generated from subreads using FALCON 76 and FALCON-Unzip 17 , with one round of Arrow polishing (smrtanalysis 5.1.0.26412). A minimum read length of 2 kb or a cutoff at which reads longer than the cutoff include 50× coverage was used, whichever was longer. For calculating read coverage, we used estimated genome size from http://www.genomesize.com/ when available, or from the literature (Supplementary Table 11 ) while waiting for 10XG sequencing to estimate genome size using k -mers. FALCON and FALCON-Unzip were run with default parameters, except for computing the overlaps. Raw read overlaps were computed with DALIGNER parameters -k14 -e0.75 -s100 -l2500 -h240 -w8 to better reflect the higher error rate in early PacBio sequel I and II. Pread (preassembled read) overlaps were computed with DALIGNER parameters -k24 -e.90 -s100 -l1000 -h600 intending to collapse haplotypes for the FALCON step to better unzip genomes with high heterozygosity rate. FALCON-Unzip outputs both a pseudo-haplotype and a set of alternate haplotigs that represent the secondary alleles. We refer to these outputs as the primary contig set (c1) and alternate contig set (c2)."
              }
            ]
          },
          {
            "id": "Sec39",
            "title": "Purging false duplications",
            "paragraphs": [
              {
                "id": "Par47",
                "text": "Heterotype false duplications occurred despite setting FALCON 76 parameters to resolve up to 10% haplotype divergence. FALCON-Unzip 17 also incorrectly retained some secondary alleles in the primary contig set, which appeared as false duplications. To reduce these false duplications, we ran Purge_Haplotigs 13 , first during curation (VGP v1.0 pipeline) and then later after contig formation (VGP v1.5 pipeline). To do the former, Purge_Haplotigs was run on the primary contigs (c1), and identified haplotigs were mapped to the scaffolded primary assembly with MashMap2 86 for removal. In the latter, identified haplotigs were moved from the primary contigs (c1) to the alternate haplotig set (p2). The remaining primary contigs were referred to as p1; p2 combined with c2 was referred to as q2. Later, in the VGP v1.6 pipeline, we replaced Purge_Haplotigs with Purge_Dups 14 , a new program developed by several of the authors in response to Purge_Haplotigs not removing partial false duplication at contig boundaries. Purging also removes excessive low-coverage (junk) and high-coverage (repeats) contigs. To calculate the presence and overall success of purging false duplications, we used a k -mer approach ( Supplementary Methods , Supplementary Fig. 6 )."
              }
            ]
          },
          {
            "id": "Sec40",
            "title": "Scaffolding with 10XG linked reads",
            "paragraphs": [
              {
                "id": "Par48",
                "text": "The 10X Genomics linked reads were aligned to the primary contigs (p1), and an adjacency matrix was computed from the barcodes using scaff10x 74 v2.0–2.1. Two rounds of scaffolding were performed. The first round was run with parameters -matrix 2000 -reads 12 -link 10 , and the second round with parameters -matrix 2000 -reads 8 -link 10 . A gap of 100 bp (represented with ‘N’s) was inserted between joined contigs. The resulting primary scaffold set was named s1."
              }
            ]
          },
          {
            "id": "Sec41",
            "title": "Scaffolding with Bionano optical maps",
            "paragraphs": [
              {
                "id": "Par49",
                "text": "Bionano cmaps were generated using the Bionano Pipeline in non-haplotype assembly mode and used to further scaffold the s1 assembly with Bionano Solve v3.2.1 87 . We began with a one-enzyme nick map (BspQI), followed by a two-enzyme nick map (BspQI and BssSI), and then with a DLE-1 one-enzyme non-nicking approach when the later data type became available (Supplementary Table 9 ). Scaffold gaps were sized according to the software estimate. The resulting scaffold set was named s2."
              }
            ]
          },
          {
            "id": "Sec42",
            "title": "Scaffolding with Hi-C reads",
            "paragraphs": [
              {
                "id": "Par50",
                "text": "Hi-C reads were aligned to the s2 scaffolds using the Arima Genomics mapping pipeline 88 . In brief, both ends of a read pair were mapped independently using BWA-MEM 89 with the parameter -B8 , and filtered when mapping quality was <10. Chimeric reads containing a restriction enzyme site were trimmed from the restriction site onward, leaving only the 5′ end. The filtered single-read alignments were then rejoined as paired read alignments. The processed alignments were then used for scaffolding with Salsa2 79 , which analyses the normalized frequency of Hi-C interactions between all pairs of contig ends to determine a likely ordering and orientation of each. We used parameters -m yes -i 5 -p yes to allow Salsa2 to break potentially mis-assembled contigs and perform five iterations of scaffolding. After feedback from curation, later versions of Salsa were developed, which more conservatively determine the number of iterations (v2.1) and actively break at mis-assemblies (v2.2), and run for the Canada lynx, Goode’s thornscrub tortoise, and two-lined caecilian. The restriction enzyme(s) used to generate each library were specified using parameters -e GATC,GANTC for Arima and -e GATC for Dovetail and Phase Genomics Hi-C data. The resulting Hi-C scaffolded assembly was named s3."
              }
            ]
          },
          {
            "id": "Sec43",
            "title": "Consensus polishing",
            "paragraphs": [
              {
                "id": "Par51",
                "text": "To polish bases in both haplotypes with minimal alignment bias, we concatenated the alternate haplotig set (c2 in v1.0 or q2 in v1.5–1.6) to the scaffolded primary set (s3) and the assembled mitochondrial genome (mitoVGP in v1.6). We then performed another round of polishing with Arrow (smrtanalysis 5.1.0.26412) using PacBio CLR reads, aligning with pbalign --minAccuracy=0.75 --minLength=50 --minAnchorSize=12 --maxDivergence=30 –concordant --algorithm=blasr --algorithmOptions=--useQuality --maxHits=1 --hitPolicy=random --seed=1 and consensus polishing with variantCaller --skipUnrecognizedContigs haploid -x 5 -q 20 -X120 –v --algorithm=arrow . While this round of polishing resulted in higher QV for all genomes herein considered, we noticed that it was particularly sensitive to the coverage cutoff parameter ( -x ). This is because Arrow generates a de novo consensus from the mapped reads without explicitly considering the reference sequence. Later, we found that the second round of Arrow polishing sometimes reduced the QV accuracy for some species. Upon investigation, this issue was traced back to option -x 5 , which requires at least 5 reads to call consensus. Such low minimum requirements can lead to uneven polishing in low coverage regions. To avoid this behaviour, we suggest to increase the -x close to the half sequence coverage (for example, 30× when 60× was used for assembly) and check QV before moving forward."
              },
              {
                "id": "Par52",
                "text": "For genomes with a combined assembly size larger than 4 Gb, we used Minimap2 90 with parameters -ax map-pb instead of Blasr 91 to overcome reference index size limitations."
              },
              {
                "id": "Par53",
                "text": "Two more rounds of base-pair polishing were performed with linked reads. The reads were aligned with Longranger align 2.2.2, which incorporates the Lauriat for barcode-aware alignment 83 . From the alignments, homozygous mismatches (variants) were called with FreeBayes 83 v1.2.0 using default options. Consensus was called with bcftools consensus 92 with -i’QUAL>1 && (GT=’’AA’’ || GT = ‘’Aa’’)’ -Hla ."
              }
            ]
          },
          {
            "id": "Sec44",
            "title": "VGP Trio Pipeline v1.0–v1.6",
            "paragraphs": [
              {
                "id": "Par54",
                "text": "The trio pipeline is similarly designed to the standard pipeline, except for the use of parental data (Extended Data Fig. 3b ). When parental genomes are available, the child’s CLR reads are binned to maternal and paternal haplotypes, and assembled separately as haplotype-specific contigs (haplotigs) using TrioCanu 20 . In brief, parental specific marker k -mers were collected using Meryl 23 from the parental Illumina WGS reads of the parents. These markers were filtered and used to bin the child’s CLR read. A haplotype was assigned given the markers observed, normalized by the total markers in each haplotype. The subsequent purging, scaffolding, and polishing steps were similarly updated with the use of Purge_Dups 14 (v1.6). We extended binning to linked reads and Hi-C reads, by excluding read pairs that had any parental-specific marker. The binned Hi-C reads were used to scaffold its haplotype assembly, and polished with the binned linked reads from the observation of haplotype switching using the standard polishing approach. During curation, one of the haplotype assemblies with the higher QV and/or contiguity was chosen as the representative haplotype. The heterogametic sex chromosome from the unchosen haplotype was added to the representative assembly. However, while curating several trios, we found that in regions of low divergence between shared parental homogametic sex chromosomes (that is, X or Z), a small fraction of offspring CLR data was mis-assigned to the wrong haplotype. This mis-alignment resulted in a duplicate, low-coverage offspring X or Z assembly in the paternal (for mammals) or maternal (for birds) haplotype, respectively, which required removal during curation. We are working on methods to improve the binning accuracy for resolution of this issue going forward."
              },
              {
                "id": "Par55",
                "text": "For the female zebra finch in particular, contigs were generated before the binning was automated in the Canu assembler as TrioCanu1.7, and therefore a manual binning process was applied as described in the original Trio-binning paper 20 ( Supplementary Methods ). Contigs were assembled for each haplotype using the binned reads, excluding unclassified reads. The contigs were polished with two rounds of Arrow polishing using the binned reads, and scaffolded following the v1.0 pipeline with no purging. Additional scaffolding rounds with Bionano (s4) and Hi-C were applied. Scaffolds were renamed according to the primary scaffold assembly of the same individual (s5), with sex chromosomes grouped as Z in the paternal assembly and W in the maternal assembly following synteny to the Z chromosome from the curated male zebra finch VGP assembly. Two rounds of SR polishing were applied using linked reads, by mapping on both haplotypes. After haplotype switches were discovered, additional rounds of polishing were applied using binned linked reads ( Supplementary Methods )."
              }
            ]
          },
          {
            "id": "Sec45",
            "title": "Mitochondrial genome assembly",
            "paragraphs": [
              {
                "id": "Par56",
                "text": "Similar to other recent methods 93 , 94 , we developed a reference-guided MT assembly pipeline. MT reads in the raw CLR data were identified by mapping the whole read set to an existing reference sequence of the specific species or of closely related species using Blasr. Filtered mtDNA CLRs were assembled into a single contig using Canu v1.8, polished with Arrow using CLR and then FreeBayes v1.0.2 together with bcftools v1.9 using short reads from the 10XG data (Extended Data Fig. 3c ). The overlapping sequences at the ends of the contig were trimmed, and the remaining contig sequence circularized. The mitoVGP pipeline is made available at https://github.com/VGP/vgp-assembly/tree/master/mitoVGP . A more detailed protocol description of the assembly pipeline and new discoveries from the MT assemblies are published elsewhere 33 ."
              }
            ]
          }
        ]
      },
      {
        "id": "Sec38",
        "title": "Contigging",
        "paragraphs": [
          {
            "id": "Par46",
            "text": "For PacBio data, contigs were generated from subreads using FALCON 76 and FALCON-Unzip 17 , with one round of Arrow polishing (smrtanalysis 5.1.0.26412). A minimum read length of 2 kb or a cutoff at which reads longer than the cutoff include 50× coverage was used, whichever was longer. For calculating read coverage, we used estimated genome size from http://www.genomesize.com/ when available, or from the literature (Supplementary Table 11 ) while waiting for 10XG sequencing to estimate genome size using k -mers. FALCON and FALCON-Unzip were run with default parameters, except for computing the overlaps. Raw read overlaps were computed with DALIGNER parameters -k14 -e0.75 -s100 -l2500 -h240 -w8 to better reflect the higher error rate in early PacBio sequel I and II. Pread (preassembled read) overlaps were computed with DALIGNER parameters -k24 -e.90 -s100 -l1000 -h600 intending to collapse haplotypes for the FALCON step to better unzip genomes with high heterozygosity rate. FALCON-Unzip outputs both a pseudo-haplotype and a set of alternate haplotigs that represent the secondary alleles. We refer to these outputs as the primary contig set (c1) and alternate contig set (c2)."
          }
        ]
      },
      {
        "id": "Sec39",
        "title": "Purging false duplications",
        "paragraphs": [
          {
            "id": "Par47",
            "text": "Heterotype false duplications occurred despite setting FALCON 76 parameters to resolve up to 10% haplotype divergence. FALCON-Unzip 17 also incorrectly retained some secondary alleles in the primary contig set, which appeared as false duplications. To reduce these false duplications, we ran Purge_Haplotigs 13 , first during curation (VGP v1.0 pipeline) and then later after contig formation (VGP v1.5 pipeline). To do the former, Purge_Haplotigs was run on the primary contigs (c1), and identified haplotigs were mapped to the scaffolded primary assembly with MashMap2 86 for removal. In the latter, identified haplotigs were moved from the primary contigs (c1) to the alternate haplotig set (p2). The remaining primary contigs were referred to as p1; p2 combined with c2 was referred to as q2. Later, in the VGP v1.6 pipeline, we replaced Purge_Haplotigs with Purge_Dups 14 , a new program developed by several of the authors in response to Purge_Haplotigs not removing partial false duplication at contig boundaries. Purging also removes excessive low-coverage (junk) and high-coverage (repeats) contigs. To calculate the presence and overall success of purging false duplications, we used a k -mer approach ( Supplementary Methods , Supplementary Fig. 6 )."
          }
        ]
      },
      {
        "id": "Sec40",
        "title": "Scaffolding with 10XG linked reads",
        "paragraphs": [
          {
            "id": "Par48",
            "text": "The 10X Genomics linked reads were aligned to the primary contigs (p1), and an adjacency matrix was computed from the barcodes using scaff10x 74 v2.0–2.1. Two rounds of scaffolding were performed. The first round was run with parameters -matrix 2000 -reads 12 -link 10 , and the second round with parameters -matrix 2000 -reads 8 -link 10 . A gap of 100 bp (represented with ‘N’s) was inserted between joined contigs. The resulting primary scaffold set was named s1."
          }
        ]
      },
      {
        "id": "Sec41",
        "title": "Scaffolding with Bionano optical maps",
        "paragraphs": [
          {
            "id": "Par49",
            "text": "Bionano cmaps were generated using the Bionano Pipeline in non-haplotype assembly mode and used to further scaffold the s1 assembly with Bionano Solve v3.2.1 87 . We began with a one-enzyme nick map (BspQI), followed by a two-enzyme nick map (BspQI and BssSI), and then with a DLE-1 one-enzyme non-nicking approach when the later data type became available (Supplementary Table 9 ). Scaffold gaps were sized according to the software estimate. The resulting scaffold set was named s2."
          }
        ]
      },
      {
        "id": "Sec42",
        "title": "Scaffolding with Hi-C reads",
        "paragraphs": [
          {
            "id": "Par50",
            "text": "Hi-C reads were aligned to the s2 scaffolds using the Arima Genomics mapping pipeline 88 . In brief, both ends of a read pair were mapped independently using BWA-MEM 89 with the parameter -B8 , and filtered when mapping quality was <10. Chimeric reads containing a restriction enzyme site were trimmed from the restriction site onward, leaving only the 5′ end. The filtered single-read alignments were then rejoined as paired read alignments. The processed alignments were then used for scaffolding with Salsa2 79 , which analyses the normalized frequency of Hi-C interactions between all pairs of contig ends to determine a likely ordering and orientation of each. We used parameters -m yes -i 5 -p yes to allow Salsa2 to break potentially mis-assembled contigs and perform five iterations of scaffolding. After feedback from curation, later versions of Salsa were developed, which more conservatively determine the number of iterations (v2.1) and actively break at mis-assemblies (v2.2), and run for the Canada lynx, Goode’s thornscrub tortoise, and two-lined caecilian. The restriction enzyme(s) used to generate each library were specified using parameters -e GATC,GANTC for Arima and -e GATC for Dovetail and Phase Genomics Hi-C data. The resulting Hi-C scaffolded assembly was named s3."
          }
        ]
      },
      {
        "id": "Sec43",
        "title": "Consensus polishing",
        "paragraphs": [
          {
            "id": "Par51",
            "text": "To polish bases in both haplotypes with minimal alignment bias, we concatenated the alternate haplotig set (c2 in v1.0 or q2 in v1.5–1.6) to the scaffolded primary set (s3) and the assembled mitochondrial genome (mitoVGP in v1.6). We then performed another round of polishing with Arrow (smrtanalysis 5.1.0.26412) using PacBio CLR reads, aligning with pbalign --minAccuracy=0.75 --minLength=50 --minAnchorSize=12 --maxDivergence=30 –concordant --algorithm=blasr --algorithmOptions=--useQuality --maxHits=1 --hitPolicy=random --seed=1 and consensus polishing with variantCaller --skipUnrecognizedContigs haploid -x 5 -q 20 -X120 –v --algorithm=arrow . While this round of polishing resulted in higher QV for all genomes herein considered, we noticed that it was particularly sensitive to the coverage cutoff parameter ( -x ). This is because Arrow generates a de novo consensus from the mapped reads without explicitly considering the reference sequence. Later, we found that the second round of Arrow polishing sometimes reduced the QV accuracy for some species. Upon investigation, this issue was traced back to option -x 5 , which requires at least 5 reads to call consensus. Such low minimum requirements can lead to uneven polishing in low coverage regions. To avoid this behaviour, we suggest to increase the -x close to the half sequence coverage (for example, 30× when 60× was used for assembly) and check QV before moving forward."
          },
          {
            "id": "Par52",
            "text": "For genomes with a combined assembly size larger than 4 Gb, we used Minimap2 90 with parameters -ax map-pb instead of Blasr 91 to overcome reference index size limitations."
          },
          {
            "id": "Par53",
            "text": "Two more rounds of base-pair polishing were performed with linked reads. The reads were aligned with Longranger align 2.2.2, which incorporates the Lauriat for barcode-aware alignment 83 . From the alignments, homozygous mismatches (variants) were called with FreeBayes 83 v1.2.0 using default options. Consensus was called with bcftools consensus 92 with -i’QUAL>1 && (GT=’’AA’’ || GT = ‘’Aa’’)’ -Hla ."
          }
        ]
      },
      {
        "id": "Sec44",
        "title": "VGP Trio Pipeline v1.0–v1.6",
        "paragraphs": [
          {
            "id": "Par54",
            "text": "The trio pipeline is similarly designed to the standard pipeline, except for the use of parental data (Extended Data Fig. 3b ). When parental genomes are available, the child’s CLR reads are binned to maternal and paternal haplotypes, and assembled separately as haplotype-specific contigs (haplotigs) using TrioCanu 20 . In brief, parental specific marker k -mers were collected using Meryl 23 from the parental Illumina WGS reads of the parents. These markers were filtered and used to bin the child’s CLR read. A haplotype was assigned given the markers observed, normalized by the total markers in each haplotype. The subsequent purging, scaffolding, and polishing steps were similarly updated with the use of Purge_Dups 14 (v1.6). We extended binning to linked reads and Hi-C reads, by excluding read pairs that had any parental-specific marker. The binned Hi-C reads were used to scaffold its haplotype assembly, and polished with the binned linked reads from the observation of haplotype switching using the standard polishing approach. During curation, one of the haplotype assemblies with the higher QV and/or contiguity was chosen as the representative haplotype. The heterogametic sex chromosome from the unchosen haplotype was added to the representative assembly. However, while curating several trios, we found that in regions of low divergence between shared parental homogametic sex chromosomes (that is, X or Z), a small fraction of offspring CLR data was mis-assigned to the wrong haplotype. This mis-alignment resulted in a duplicate, low-coverage offspring X or Z assembly in the paternal (for mammals) or maternal (for birds) haplotype, respectively, which required removal during curation. We are working on methods to improve the binning accuracy for resolution of this issue going forward."
          },
          {
            "id": "Par55",
            "text": "For the female zebra finch in particular, contigs were generated before the binning was automated in the Canu assembler as TrioCanu1.7, and therefore a manual binning process was applied as described in the original Trio-binning paper 20 ( Supplementary Methods ). Contigs were assembled for each haplotype using the binned reads, excluding unclassified reads. The contigs were polished with two rounds of Arrow polishing using the binned reads, and scaffolded following the v1.0 pipeline with no purging. Additional scaffolding rounds with Bionano (s4) and Hi-C were applied. Scaffolds were renamed according to the primary scaffold assembly of the same individual (s5), with sex chromosomes grouped as Z in the paternal assembly and W in the maternal assembly following synteny to the Z chromosome from the curated male zebra finch VGP assembly. Two rounds of SR polishing were applied using linked reads, by mapping on both haplotypes. After haplotype switches were discovered, additional rounds of polishing were applied using binned linked reads ( Supplementary Methods )."
          }
        ]
      },
      {
        "id": "Sec45",
        "title": "Mitochondrial genome assembly",
        "paragraphs": [
          {
            "id": "Par56",
            "text": "Similar to other recent methods 93 , 94 , we developed a reference-guided MT assembly pipeline. MT reads in the raw CLR data were identified by mapping the whole read set to an existing reference sequence of the specific species or of closely related species using Blasr. Filtered mtDNA CLRs were assembled into a single contig using Canu v1.8, polished with Arrow using CLR and then FreeBayes v1.0.2 together with bcftools v1.9 using short reads from the 10XG data (Extended Data Fig. 3c ). The overlapping sequences at the ends of the contig were trimmed, and the remaining contig sequence circularized. The mitoVGP pipeline is made available at https://github.com/VGP/vgp-assembly/tree/master/mitoVGP . A more detailed protocol description of the assembly pipeline and new discoveries from the MT assemblies are published elsewhere 33 ."
          }
        ]
      },
      {
        "id": "Sec46",
        "title": "Curation",
        "paragraphs": [
          {
            "id": "Par57",
            "text": "The VGP genome assembly pipeline produces high quality assemblies, yet no automated method to date is free from the production of errors, especially during the scaffolding stages. To minimize the impact of the remaining algorithmic shortcomings, we subjected all assemblies to rigorous manual curation. All data generated for a species in this study and other publicly available data (for example, genetic maps, gene sets and genome assemblies of the same or closely related species) were collated, aligned to the primary assembly and analysed in gEVAL 95 ( https://vgp-geval.sanger.ac.uk/index.html ), visualizing discordances in a feature browser and issue lists. In parallel, Hi-C data were mapped to the primary assembly and visualized using Juicebox 96 and/or HiGlass 97 . With these data, genome curators identified mis-joins, missed joins and other anomalies, and corrected the primary assembly accordingly. No change was made without unambiguous evidence from available data types; for example, a Hi-C suggested join would not be made unless supported by BioNano maps, long-read data, or gene alignments. When sequencing the heterogametic sex, we identified sex chromosomes based on half coverage, homology alignments to sex chromosomes in other species, and the presence of sex chromosome-specific genes."
          },
          {
            "id": "Par58",
            "text": "A succession of searches was used to identify potential contaminants in the generated assemblies."
          },
          {
            "id": "Par59",
            "text": "1) A megaBLAST 98 search against a database of common contaminants (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/contam_in_euks.fa.gz) requiring e ≤ 1 × 10 −4 , reporting matches with ≥98% sequence identity and match length 50–99 bp, ≥94% and match length 100–199 bp, or ≥90% and match length 200 bp or above."
          },
          {
            "id": "Par60",
            "text": "2) A vecscreen ( https://www.ncbi.nlm.nih.gov/tools/vecscreen/ ) search against a database of adaptor sequences (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/adaptors_for_screening_euks.fa)"
          },
          {
            "id": "Par61",
            "text": "3) After soft-masking repeats using Windowmasker 75 , a megaBLAST search against chromosome-level assemblies from RefSeq requiring e ≤ 1 × 10 −4 , match score ≥100, and sequence identity ≥98%; regions matching highly conserved rDNAs were ignored."
          },
          {
            "id": "Par62",
            "text": "Manual inspection of the results was necessary to differentiate contamination from conservation and/or horizontal gene transfer. Adaptor sequences were masked; other contaminant sequences were removed. Assemblies were also checked for runs of Ns at the ends of scaffolds, created as artefacts of the iterative scaffolding process, and when found they were trimmed."
          },
          {
            "id": "Par63",
            "text": "These were detected by a megaBLAST search against a database of known organelle genomes requiring e ≤ 1 × 10 −4 , sequence identity ≥90%, and match length ≥500; the databases are available at ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/mito.nt.gz and ftp://ftp.ncbi.nlm.nih.gov/refseq/release/plastid/*genomic.fna.gz. Only scaffolds consisting entirely of organelle sequences were assumed to be organelle genomes, and replaced by the genome from the separate organelle assembly pipeline. Organelle matches embedded in nuclear sequences that were found to be NuMTs were kept."
          },
          {
            "id": "Par64",
            "text": "Retained false duplications were identified using Purge_Haplotigs 13 run either after scaffolding and polishing (Anna’s hummingbird, kākāpō, male zebra finch, female zebra finch, platypus, pale spear-nosed bat, and greater horseshoe bat) or on the c1 before scaffolding (two-lined caecilian, flier cichlid, Canada lynx, and Goode’s thornscrub tortoise). Subsequent manual curation identified additional haplotypic duplications for the listed assemblies and also those that were not treated with Purge_Haplotigs (Eastern happy, climbing perch, zig-zag eel). The evidence used included read coverage, sequence self-comparison, transcript alignments, Bionano map alignments and Hi-C 2D maps, all confirming the superfluous nature of one allele. The identified haplotype duplications were moved from the primary to the alternate assembly."
          },
          {
            "id": "Par65",
            "text": "For a scaffold to be annotated as a chromosome, we used evidence from Hi-C as well as genetic linkage or FISH karyotype mapping when available. For Hi-C evidence, we considered a scaffold as a complete chromosome (albeit with gaps) when there was a clear unbroken diagonal in the Juicebox or HiGlass plots for that scaffold and no other large scaffolds that could be joined to that same scaffold; if present and no unambiguous join was possible, we named it as an unlocalized scaffold for that chromosome. When we could not find evidence of a complete chromosome, we kept the scaffold number for its name. We named all evidence-validated scaffolds as chromosomes down to the smallest Hi-C box unit resolution allowed with these characteristics. When there was an established chromosome terminology for a given species or set of species, we use the established terminology except when our new assemblies revealed errors in the older assembly, such as scaffold/chromosome fusions, fissions, rearrangements, and non-chromosome names. For species without an established chromosome terminology, we named the scaffolds as chromosomes numbers 1, 2, 3 …, in descending order of scaffold size. For the sex chromosomes, we used the letters X and Y for mammals and Z and W for birds."
          },
          {
            "id": "Par66",
            "text": "In cases where a high-quality chromosome-level genome was available for a closely related species, comparative genome analysis was performed. The polished primary assembly (t3.p) was mapped to the related genome using MashMap2 86 with --pi 75 -s 300000 . The number of chromosomal differences was identified using a custom script available at https://github.com/jdamas13/assembly_comparison . This resulted in the identification of ~60 to ~450 regions for each genome assembly flanking putative misassemblies or lineage-specific genome rearrangements. To identify which were real misassemblies, the identified discrepancies were communicated to the curation team for manual verification (see above)."
          },
          {
            "id": "Par67",
            "text": "To identify any possible remaining mis-joins, each curated avian and mammalian assembly was compared with the zebra finch (taeGut2) or human (hg38) genomes, respectively. Pairwise alignments between each of the VGP assemblies and the clade reference were generated with LastZ 99 (version 1.04) using the following parameters: C = 0 E = 30 H = 2000 K = 3000 L = 2200 O = 400. The pairwise alignments were converted into the UCSC ‘chain’ and ‘net’ formats with axtChain (parameters: -minScore = 1000 -verbose = 0 -linearGap = medium ) followed by chainAntiRepeat, chainSort, chainPreNet, chainNet and netSyntenic, all with default parameters 100 . Pairwise synteny blocks were defined using maf2synteny 101 at 100-, 300-, and 500-kb resolutions. Evolutionary breakpoint regions were detected and classified using an ad hoc statistical approach 102 . This analysis identified 2 to 90 genomic regions per assembly that could be flanking misassemblies, lineage-specific chromosome rearrangements, or reference-specific chromosome rearrangements (116 in the human and 26 in the zebra finch). Determining the underlying cause for each of the flagged regions will need further verification. All alignments are available for visualization at the Evolution Highway comparative chromosome browser ( http://eh-demo.ncsa.illinois.edu/vgp/ )."
          }
        ],
        "subsections": [
          {
            "id": "Sec47",
            "title": "Contamination removal",
            "paragraphs": [
              {
                "id": "Par58",
                "text": "A succession of searches was used to identify potential contaminants in the generated assemblies."
              },
              {
                "id": "Par59",
                "text": "1) A megaBLAST 98 search against a database of common contaminants (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/contam_in_euks.fa.gz) requiring e ≤ 1 × 10 −4 , reporting matches with ≥98% sequence identity and match length 50–99 bp, ≥94% and match length 100–199 bp, or ≥90% and match length 200 bp or above."
              },
              {
                "id": "Par60",
                "text": "2) A vecscreen ( https://www.ncbi.nlm.nih.gov/tools/vecscreen/ ) search against a database of adaptor sequences (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/adaptors_for_screening_euks.fa)"
              },
              {
                "id": "Par61",
                "text": "3) After soft-masking repeats using Windowmasker 75 , a megaBLAST search against chromosome-level assemblies from RefSeq requiring e ≤ 1 × 10 −4 , match score ≥100, and sequence identity ≥98%; regions matching highly conserved rDNAs were ignored."
              },
              {
                "id": "Par62",
                "text": "Manual inspection of the results was necessary to differentiate contamination from conservation and/or horizontal gene transfer. Adaptor sequences were masked; other contaminant sequences were removed. Assemblies were also checked for runs of Ns at the ends of scaffolds, created as artefacts of the iterative scaffolding process, and when found they were trimmed."
              }
            ]
          },
          {
            "id": "Sec48",
            "title": "Organelle genomes",
            "paragraphs": [
              {
                "id": "Par63",
                "text": "These were detected by a megaBLAST search against a database of known organelle genomes requiring e ≤ 1 × 10 −4 , sequence identity ≥90%, and match length ≥500; the databases are available at ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/mito.nt.gz and ftp://ftp.ncbi.nlm.nih.gov/refseq/release/plastid/*genomic.fna.gz. Only scaffolds consisting entirely of organelle sequences were assumed to be organelle genomes, and replaced by the genome from the separate organelle assembly pipeline. Organelle matches embedded in nuclear sequences that were found to be NuMTs were kept."
              }
            ]
          },
          {
            "id": "Sec49",
            "title": "False duplication removal",
            "paragraphs": [
              {
                "id": "Par64",
                "text": "Retained false duplications were identified using Purge_Haplotigs 13 run either after scaffolding and polishing (Anna’s hummingbird, kākāpō, male zebra finch, female zebra finch, platypus, pale spear-nosed bat, and greater horseshoe bat) or on the c1 before scaffolding (two-lined caecilian, flier cichlid, Canada lynx, and Goode’s thornscrub tortoise). Subsequent manual curation identified additional haplotypic duplications for the listed assemblies and also those that were not treated with Purge_Haplotigs (Eastern happy, climbing perch, zig-zag eel). The evidence used included read coverage, sequence self-comparison, transcript alignments, Bionano map alignments and Hi-C 2D maps, all confirming the superfluous nature of one allele. The identified haplotype duplications were moved from the primary to the alternate assembly."
              }
            ]
          },
          {
            "id": "Sec50",
            "title": "Chromosome assignment",
            "paragraphs": [
              {
                "id": "Par65",
                "text": "For a scaffold to be annotated as a chromosome, we used evidence from Hi-C as well as genetic linkage or FISH karyotype mapping when available. For Hi-C evidence, we considered a scaffold as a complete chromosome (albeit with gaps) when there was a clear unbroken diagonal in the Juicebox or HiGlass plots for that scaffold and no other large scaffolds that could be joined to that same scaffold; if present and no unambiguous join was possible, we named it as an unlocalized scaffold for that chromosome. When we could not find evidence of a complete chromosome, we kept the scaffold number for its name. We named all evidence-validated scaffolds as chromosomes down to the smallest Hi-C box unit resolution allowed with these characteristics. When there was an established chromosome terminology for a given species or set of species, we use the established terminology except when our new assemblies revealed errors in the older assembly, such as scaffold/chromosome fusions, fissions, rearrangements, and non-chromosome names. For species without an established chromosome terminology, we named the scaffolds as chromosomes numbers 1, 2, 3 …, in descending order of scaffold size. For the sex chromosomes, we used the letters X and Y for mammals and Z and W for birds."
              }
            ]
          },
          {
            "id": "Sec51",
            "title": "Using comparative genomics to assess assembly structure",
            "paragraphs": [
              {
                "id": "Par66",
                "text": "In cases where a high-quality chromosome-level genome was available for a closely related species, comparative genome analysis was performed. The polished primary assembly (t3.p) was mapped to the related genome using MashMap2 86 with --pi 75 -s 300000 . The number of chromosomal differences was identified using a custom script available at https://github.com/jdamas13/assembly_comparison . This resulted in the identification of ~60 to ~450 regions for each genome assembly flanking putative misassemblies or lineage-specific genome rearrangements. To identify which were real misassemblies, the identified discrepancies were communicated to the curation team for manual verification (see above)."
              },
              {
                "id": "Par67",
                "text": "To identify any possible remaining mis-joins, each curated avian and mammalian assembly was compared with the zebra finch (taeGut2) or human (hg38) genomes, respectively. Pairwise alignments between each of the VGP assemblies and the clade reference were generated with LastZ 99 (version 1.04) using the following parameters: C = 0 E = 30 H = 2000 K = 3000 L = 2200 O = 400. The pairwise alignments were converted into the UCSC ‘chain’ and ‘net’ formats with axtChain (parameters: -minScore = 1000 -verbose = 0 -linearGap = medium ) followed by chainAntiRepeat, chainSort, chainPreNet, chainNet and netSyntenic, all with default parameters 100 . Pairwise synteny blocks were defined using maf2synteny 101 at 100-, 300-, and 500-kb resolutions. Evolutionary breakpoint regions were detected and classified using an ad hoc statistical approach 102 . This analysis identified 2 to 90 genomic regions per assembly that could be flanking misassemblies, lineage-specific chromosome rearrangements, or reference-specific chromosome rearrangements (116 in the human and 26 in the zebra finch). Determining the underlying cause for each of the flagged regions will need further verification. All alignments are available for visualization at the Evolution Highway comparative chromosome browser ( http://eh-demo.ncsa.illinois.edu/vgp/ )."
              }
            ]
          }
        ]
      },
      {
        "id": "Sec47",
        "title": "Contamination removal",
        "paragraphs": [
          {
            "id": "Par58",
            "text": "A succession of searches was used to identify potential contaminants in the generated assemblies."
          },
          {
            "id": "Par59",
            "text": "1) A megaBLAST 98 search against a database of common contaminants (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/contam_in_euks.fa.gz) requiring e ≤ 1 × 10 −4 , reporting matches with ≥98% sequence identity and match length 50–99 bp, ≥94% and match length 100–199 bp, or ≥90% and match length 200 bp or above."
          },
          {
            "id": "Par60",
            "text": "2) A vecscreen ( https://www.ncbi.nlm.nih.gov/tools/vecscreen/ ) search against a database of adaptor sequences (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/adaptors_for_screening_euks.fa)"
          },
          {
            "id": "Par61",
            "text": "3) After soft-masking repeats using Windowmasker 75 , a megaBLAST search against chromosome-level assemblies from RefSeq requiring e ≤ 1 × 10 −4 , match score ≥100, and sequence identity ≥98%; regions matching highly conserved rDNAs were ignored."
          },
          {
            "id": "Par62",
            "text": "Manual inspection of the results was necessary to differentiate contamination from conservation and/or horizontal gene transfer. Adaptor sequences were masked; other contaminant sequences were removed. Assemblies were also checked for runs of Ns at the ends of scaffolds, created as artefacts of the iterative scaffolding process, and when found they were trimmed."
          }
        ]
      },
      {
        "id": "Sec48",
        "title": "Organelle genomes",
        "paragraphs": [
          {
            "id": "Par63",
            "text": "These were detected by a megaBLAST search against a database of known organelle genomes requiring e ≤ 1 × 10 −4 , sequence identity ≥90%, and match length ≥500; the databases are available at ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/mito.nt.gz and ftp://ftp.ncbi.nlm.nih.gov/refseq/release/plastid/*genomic.fna.gz. Only scaffolds consisting entirely of organelle sequences were assumed to be organelle genomes, and replaced by the genome from the separate organelle assembly pipeline. Organelle matches embedded in nuclear sequences that were found to be NuMTs were kept."
          }
        ]
      },
      {
        "id": "Sec49",
        "title": "False duplication removal",
        "paragraphs": [
          {
            "id": "Par64",
            "text": "Retained false duplications were identified using Purge_Haplotigs 13 run either after scaffolding and polishing (Anna’s hummingbird, kākāpō, male zebra finch, female zebra finch, platypus, pale spear-nosed bat, and greater horseshoe bat) or on the c1 before scaffolding (two-lined caecilian, flier cichlid, Canada lynx, and Goode’s thornscrub tortoise). Subsequent manual curation identified additional haplotypic duplications for the listed assemblies and also those that were not treated with Purge_Haplotigs (Eastern happy, climbing perch, zig-zag eel). The evidence used included read coverage, sequence self-comparison, transcript alignments, Bionano map alignments and Hi-C 2D maps, all confirming the superfluous nature of one allele. The identified haplotype duplications were moved from the primary to the alternate assembly."
          }
        ]
      },
      {
        "id": "Sec50",
        "title": "Chromosome assignment",
        "paragraphs": [
          {
            "id": "Par65",
            "text": "For a scaffold to be annotated as a chromosome, we used evidence from Hi-C as well as genetic linkage or FISH karyotype mapping when available. For Hi-C evidence, we considered a scaffold as a complete chromosome (albeit with gaps) when there was a clear unbroken diagonal in the Juicebox or HiGlass plots for that scaffold and no other large scaffolds that could be joined to that same scaffold; if present and no unambiguous join was possible, we named it as an unlocalized scaffold for that chromosome. When we could not find evidence of a complete chromosome, we kept the scaffold number for its name. We named all evidence-validated scaffolds as chromosomes down to the smallest Hi-C box unit resolution allowed with these characteristics. When there was an established chromosome terminology for a given species or set of species, we use the established terminology except when our new assemblies revealed errors in the older assembly, such as scaffold/chromosome fusions, fissions, rearrangements, and non-chromosome names. For species without an established chromosome terminology, we named the scaffolds as chromosomes numbers 1, 2, 3 …, in descending order of scaffold size. For the sex chromosomes, we used the letters X and Y for mammals and Z and W for birds."
          }
        ]
      },
      {
        "id": "Sec51",
        "title": "Using comparative genomics to assess assembly structure",
        "paragraphs": [
          {
            "id": "Par66",
            "text": "In cases where a high-quality chromosome-level genome was available for a closely related species, comparative genome analysis was performed. The polished primary assembly (t3.p) was mapped to the related genome using MashMap2 86 with --pi 75 -s 300000 . The number of chromosomal differences was identified using a custom script available at https://github.com/jdamas13/assembly_comparison . This resulted in the identification of ~60 to ~450 regions for each genome assembly flanking putative misassemblies or lineage-specific genome rearrangements. To identify which were real misassemblies, the identified discrepancies were communicated to the curation team for manual verification (see above)."
          },
          {
            "id": "Par67",
            "text": "To identify any possible remaining mis-joins, each curated avian and mammalian assembly was compared with the zebra finch (taeGut2) or human (hg38) genomes, respectively. Pairwise alignments between each of the VGP assemblies and the clade reference were generated with LastZ 99 (version 1.04) using the following parameters: C = 0 E = 30 H = 2000 K = 3000 L = 2200 O = 400. The pairwise alignments were converted into the UCSC ‘chain’ and ‘net’ formats with axtChain (parameters: -minScore = 1000 -verbose = 0 -linearGap = medium ) followed by chainAntiRepeat, chainSort, chainPreNet, chainNet and netSyntenic, all with default parameters 100 . Pairwise synteny blocks were defined using maf2synteny 101 at 100-, 300-, and 500-kb resolutions. Evolutionary breakpoint regions were detected and classified using an ad hoc statistical approach 102 . This analysis identified 2 to 90 genomic regions per assembly that could be flanking misassemblies, lineage-specific chromosome rearrangements, or reference-specific chromosome rearrangements (116 in the human and 26 in the zebra finch). Determining the underlying cause for each of the flagged regions will need further verification. All alignments are available for visualization at the Evolution Highway comparative chromosome browser ( http://eh-demo.ncsa.illinois.edu/vgp/ )."
          }
        ]
      },
      {
        "id": "Sec52",
        "title": "Annotation",
        "paragraphs": [
          {
            "id": "Par68",
            "text": "NCBI and Ensembl annotation pipeline used in this study are described in the Supplementary Methods ."
          }
        ]
      },
      {
        "id": "Sec53",
        "title": "Evaluation",
        "paragraphs": [
          {
            "id": "Par69",
            "text": "Detailed methods for other types of evaluation, including BUSCO runs, mis-join and missed-join identification, reliable blocks, collapsed repeats, telomeres, RNA-seq and ATAC–seq mapping, and false gene duplications are in the Supplementary Methods . No statistical methods were used to predetermine sample size, the experiments were not randomized, and the investigators were not blinded to group during experiments and outcome assessment."
          }
        ]
      },
      {
        "id": "Sec54",
        "title": "Reporting summary",
        "paragraphs": [
          {
            "id": "Par70",
            "text": "Further information on research design is available in the Nature Research Reporting Summary linked to this paper."
          }
        ]
      },
      {
        "id": "Sec55",
        "title": "Online content",
        "paragraphs": [
          {
            "id": "Par71",
            "text": "Any methods, additional references, Nature Research reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at https://doi.org/10.1038/s41586-021-03451-0 ."
          }
        ]
      }
    ],
    "full_text": "Main Chromosome-level reference genomes underpin the study of functional, comparative, and population genomics within and across species. The first high-quality genome assemblies of human 1 and other model species (for example, Caenorhabditis elegans 2 , mouse 3 , and zebrafish 4 ) were put together using 500–1,000-base pair (bp) Sanger sequencing reads of thousands of hierarchically organized clones with 200–300-kilobase (kb) inserts, and chromosome genetic maps. This approach required tremendous manual effort, software engineering, and cost, in decade-long projects. Whole-genome shotgun approaches simplified the logistics (for example, in human 7 and Drosophila 8 ), and later next-generation sequencing with shorter (30–150-bp) sequencing reads and short insert sizes (for example, 1 kb) ushered in more affordable and scalable genome sequencing 9 . However, the shorter reads resulted in lower-quality assemblies, fragmented into thousands of pieces, where many genes were missing, truncated, or incorrectly assembled, resulting in annotation and other errors 10 . Such errors can require months of manual effort to correct individual genes and years to correct an entire assembly. Genomic heterozygosity posed additional problems, because homologous haplotypes in a diploid or polyploid genome are forced together into a single consensus by standard assemblers, sometimes creating false gene duplications 11 , 12 , 13 – 14 . To address these problems, the G10K consortium 5 , 6 initiated the Vertebrate Genomes Project (VGP; https://vertebrategenomesproject.org ) with the ultimate aim of producing at least one high-quality, near error-free and gapless, chromosome-level, haplotype-phased, and annotated reference genome assembly for each of the 71,657 extant named vertebrate species and using these genomes to address fundamental questions in biology, disease, and biodiversity conservation. Towards this end, having learned the lessons of having too many variables that make conclusions more difficult to reach in the G10K from the G10K Assemblathon 2 effort 15 , we first evaluated multiple genome sequencing and assembly approaches extensively on one species, the Anna’s hummingbird ( Calypte anna ). We then deployed the best-performing method across sixteen species representing six major vertebrate classes, with a wide diversity of genomic characteristics. Drawing on the principles learned, we improved these methods further, discovered parameters and approaches that work better for species with different genomic characteristics, and made biological discoveries that had not been possible with the previous assemblies. Complete, accurate assemblies require long reads We chose a female Anna’s hummingbird because it has a relatively small genome (about 1 Gb), is heterogametic (has both Z and W sex chromosomes), and has an annotated reference of the same individual built from short reads 16 . We obtained 12 new sequencing data types, including both short and long reads (80 bp to 100 kb), and long-range linking information (40 kb to more than 100 Mb), generated using eight technologies (Supplementary Table 1 ). We benchmarked all technologies and assembly algorithms (Supplementary Table 2 ) in isolation and in many combinations (Supplementary Table 3 ). To our knowledge, this was the first systematic analysis of many sequence technologies, assembly algorithms, and assembly parameters applied on the same individual. We found that primary contiguous sequences (contigs) (pseudo-haplotype; Supplementary Note 1 ) assembled from Pacific Biosciences continuous long reads (CLR) or Oxford Nanopore long reads (ONT) were approximately 30- to 300-fold longer than those assembled from Illumina short reads (SR), regardless of data type combination or assembly algorithm used (Fig. 1a , Supplementary Table 3 ). The highest contig NG50s for short-read-only assemblies were about 0.025 to 0.169 Mb, whereas for long reads they were about 4.6 to 7.66 Mb (Fig. 1a ); contig NG50 is an assembly metric based on a weighted median of the lengths of its gapless sequences relative to the estimated genome size. After fixing a function in the PacBio FALCON software 17 that caused artificial breaks in contigs between stretches of highly homozygous and heterozygous haplotype sequences (Supplementary Note 1 , Supplementary Table 2 ), contig NG50 nearly tripled to 12.77 Mb (Fig. 1a ). These findings are consistent with theoretical predictions 18 and demonstrate that, given current sequencing technology and assembly algorithms, it is not possible to achieve high contig continuity with short reads alone, as it is typically impossible to bridge through repeats that are longer than the read length. Fig. 1 Comparative analyses of Anna’s hummingbird genome assemblies with various data types. a , Contig NG50 values of the primary pseudo-haplotype. b , Scaffold NG50 values. c , Number of joins (gaps). d , Number of mis-join errors compared with the curated assembly. The curated assembly has no remaining conflicts with the raw data and thus no known mis-joins. *Same as CLR + linked + Opt. + Hi-C, but with contigs generated with an updated FALCON 17 version and earlier Hi-C Salsa version (v2.0 versus v2.2; Supplementary Table 2 ) for less aggressive contig joining. e , f , Hi-C interaction heat maps before and after manual curation, which identified 34 chromosomes. Grid lines indicate scaffold boundaries. Red arrow, example mis-join that was corrected during curation. g , Karyotype of the identified chromosomes ( n = 36 + ZW), consistent with previous findings 70 . h , Correlation between estimated chromosome sizes (in Mb) based on karyotype images in g and assembled scaffolds in Supplementary Table 4 (bCalAna1) on a log–log scale. v1.0, VGP assembly v1.0 pipeline; linked, 10X Genomics linked reads; Hi-C, Hi-C proximity ligation; 1D, 2D, Oxford Nanopore long reads; NRGene, NRGene paired-end Illumina reads; SR, paired-end Illumina short reads. Iterative assembly pipeline Scaffolds generated with all three scaffolding technologies (that is, 10X Genomics linked reads (10XG), Bionano optical maps (Opt.), and Arima Genomics, Dovetail Genomics, or Phase Genomics Hi-C) were approximately 50% to 150% longer than those generated using one or two technologies, regardless of whether we started with short- or long-read-based contigs (Fig. 1b , Extended Data Fig. 1a , Supplementary Table 3 ). These findings include improvements we made to each approach (Supplementary Note 1 , Supplementary Tables 4 , 5 , Supplementary Fig. 1 ). Despite similar scaffold continuity, the short-read-only assemblies had from about 18,000 to about 70,000 gaps, whereas the long-read assemblies had substantially fewer (about 400 to about 4,000) gaps (Fig. 1c ). Many gaps in the short-read assemblies were in repeat or GC-rich regions. Considering the curated version of this assembly to be more accurate, we also identified roughly 5,000 to 8,000 mis-joins in short-read-based assemblies, whereas long-read-based assemblies had only from 20 to around 700 mis-joins (Fig. 1d ). These mis-joins included chimeric joins and inversions. After we curated this assembly for contamination, assembly errors, and Hi-C-based chromosome assignments (Fig. 1e, f ), the final hummingbird assembly had 33 scaffolds that closely matched the chromosome karyotype in number (33 of 36 autosomes plus sex chromosomes) and estimated sizes (approximately 2 to 200 Mb; Fig. 1g, h ), with only 1 to 30 gaps per autosome (bCalAnn1 in Supplementary Table 6 ). Of the five autosomes with only one gap each, three (chromosomes 14, 15, and 19) had complete spanning support by at least two technologies (reliable blocks, Extended Data Fig. 1c ; bCalAnn1 in Supplementary Table 6 ), indicating that the chromosome contigs were nearly complete. However, they were missing long arrays of vertebrate telomere repeats within 1 kb of their ends (Extended Data Fig. 1c ; bCalAnn1 in Supplementary Tables 6 , 7 ). Assembly pipeline across vertebrate diversity Using the formula that gave the highest-quality hummingbird genome, we built an iterative VGP assembly pipeline (v1.0) with haplotype-separated CLR contigs, followed by scaffolding with linked reads, optical maps, and Hi-C, and then gap filling, base call polishing, and finally manual curation (Extended Data Figs. 2 a, 3a ). We systematically tested our pipeline on 15 additional species spanning all major vertebrate classes: mammals, birds, non-avian reptiles, amphibians, teleost fishes, and a cartilaginous fish (Supplementary Tables 8 , 9 , Supplementary Note 2 ). For the zebra finch, we used DNA from the same male as was used to generate the previous reference genome 19 , and included a female trio for benchmarking haplotype completeness, where sequenced reads from the parents were used to bin parental haplotype reads from the offspring before assembly 20 (Extended Data Figs. 2 a, 3b ). We set initial minimum assembly metric goals of: 1 Mb contig NG50; 10 Mb scaffold NG50; assigning 90% of the sequence to chromosomes, structurally validated by at least two independent lines of evidence; Q40 average base quality; and haplotypes assembled as completely and correctly as possible. When these metrics were achieved, most genes were assembled with gapless exon and intron structures 11 , and fewer than 3% had frame-shift base errors identified in annotation. Q40 is the mathematical inflection point at which genes go from usually containing an error to usually not 21 . Of the curated assemblies (Supplementary Table 10 , Supplementary Note 2 ), 16 of 17 achieved the desired continuity metrics (Extended Data Table 1 ). Scaffold NG50 was significantly correlated with genome size (Fig. 2a ), suggesting that larger genomes tend to have larger chromosomes. On average, 98.3% of the assembled bases had reliable block NG50s ranging from 2.3 to 40.2 Mb; collapsed repeat bases 22 with abnormally high CLR read coverage (more than 3 s.d.) ranged from 0.7 to 31.4 Mb per Gb; and the completeness of the genome assemblies ranged from 87.2 to 98.1%, with less than 4.9% falsely duplicated regions, consistent with the false duplication rate we found for the conserved BUSCO vertebrate gene set (Extended Data Table 1 , Supplementary Tables 11 , 12 ). Fig. 2 Impact of repeats and heterozygosity on assembly quality. a , Correlation between scaffold NG50 and genome size of the curated assemblies. b , Nonlinear correlation between contig NG50 and repeat content, before and after curation. c , Correlation between number of gaps per Gb assembled and repeat content. d , Correlation between primary assembly size relative to estimated genome size ( y axis) and genome heterozygosity ( x axis), before and after purging of false duplications. Assembly sizes above 100% indicate the presence of false duplications and those below 100% indicate collapsed repeats. e , f , Correlations between genome duplication rate using k -mers 23 ( e ) and conserved BUSCO vertebrate gene set ( f ), and genome heterozygosity before and after purging of false duplications. g , h , As in e , f , but with whole-genome repeat content before and after purging of false duplications. Genome size, heterozygosity, and repeat content were estimated from 31-mer counts using GenomeScope 71 , except for the channel bull blenny, as the estimates were unreliable (see Methods ). Repeat content was measured by modelling the k -mer multiplicity from sequencing reads. Sequence duplication rates were estimated with Merqury 23 using 21-mers. * P < 0.05; ** P < 0.01; *** P < 0.001, of the correlation coefficient: P values and adjusted r 2 from F -statistics. n = 17 assemblies of 16 species. Repeats markedly affect continuity For assemblies generated using our automated pipeline (Extended Data Fig. 3a ) before manual curation, all but 2 (the thorny skate and channel bull blenny) of the 17 assemblies exceeded the desired continuity metrics (Supplementary Table 13 ). In searching for an explanation of these results, we found that contig NG50 decreased exponentially with increasing repeat content, with the thorny skate having the highest repeat content (Fig. 2b , Supplementary Table 13 ). Consequently, after scaffolding and gap filling, we observed a significant positive correlation between repeat content and number of gaps (Fig. 2c ). The kākāpō parrot, which had 15% repeat content, had about 325 gaps per Gb, including 2 of 26 chromosomes with no gaps (chromosomes 16 and 18) and no evidence of collapses or low support, suggesting that the chromosomal contigs were complete (bStrHab1 in Supplementary Table 6 ). By contrast, the thorny skate, with 54% repeat content, had about 1,400 gaps per Gb (Extended Data Table 1 ); none of its 49 chromosomal-level scaffolds contained fewer than eight gaps, and all had some regions that contained collapses or low support (sAmbRad1 in Supplementary Table 6 ). Even after curation and other modifications to increase assembly quality (Supplementary Note 2 ), the number of collapses, their total size, missing bases, and the number of genes in the collapses all correlated with repeat content (Extended Data Fig. 4a–d ). The average collapsed length, however, correlated with average CLR read lengths (10–35 kb; Extended Data Fig. 4e ). There were no correlations between the number of collapsed bases and heterozygosity or genome size (Extended Data Fig. 4f, g ). Depending on species, 77.4 to 99.2% of the collapsed regions consisted of unresolved segmental duplications (Extended Data Fig. 4h ). The remainder were high-copy repeats, mostly of previously unknown types (Extended Data Fig. 4i ), and of known types such as satellite arrays, simple repeats, long terminal repeats (LTRs), and short and long interspersed nuclear elements (SINEs and LINEs), depending on species (Extended Data Fig. 4j ). We found that repeat masking before generating contigs prevented some repeats from making it into the final assembly (Supplementary Note 3 ). All of the above findings quantitatively demonstrate the effect that repeat content has on the ability to produce highly continuous and complete assemblies. Detection and removal of false duplications During curation, we discovered that one of the most common assembly errors was the introduction of false duplications, which can be misinterpreted as exon, whole-gene, or large segmental duplications. We observed two types of false duplication: 1) heterotype duplications, which occurred in regions of increased sequence divergence between paternal and maternal haplotypes, where separate haplotype contigs were incorrectly placed in the primary assembly (Extended Data Fig. 5a ); and 2) homotype duplications, which occurred near contig boundaries or under-collapsed sequences caused by sequencing errors (Extended Data Fig. 5b ). False heterotype duplications appeared to occur with higher heterozygosity. For example, during curation of the female zebra finch genome, we found an approximately 1-Mb falsely duplicated heterozygous sequence (Extended Data Fig. 6a ). This zebra finch individual had the highest heterozygosity (1.6%) relative to all other genomes (0.1–1.1%). Homotype duplications often occurred at contig boundaries, and were approximately the same length as the sequence reads (Extended Data Fig. 6b, c ). We identified and removed false duplications during curation using read coverage, self-, transcript-, optical map- and Hi-C-alignments, and k -mer profiles (Extended Data Fig. 6 , Supplementary Fig. 2 ). Before we purged false duplications, the primary assembly genome size correlated positively with estimated percentage heterozygosity; more heterozygous genomes tended to have assembly sizes bigger than the estimated haploid genome size (Fig. 2d ). Similarly, the extra duplication rate in the primary assembly, measured using k -mers 23 or conserved vertebrate BUSCO genes 24 , varied from 0.3% to 30% and trended towards correlation with heterozygosity (Fig. 2e, f , Supplementary Table 13 ). Apparent false gene duplication rates correlated more strongly with the overall repeat rate in the assemblies (Fig. 2g, h ). To remove these false duplications automatically, we initially used Purge_Haplotigs 13 , which removed retained falsely duplicated contigs that were not scaffolded (Extended Data Fig. 5 ; VGP v1.0–1.5). Later, we developed Purge_Dups 14 to remove both falsely retained contigs and end-to-end duplicated contigs within scaffolds (Extended Data Fig. 5 ; VGP v1.6), which reduced the amount of manual curation. After we applied these tools, the primary assembly sizes and the k -mer and BUSCO gene duplication rates were all reduced, and their correlations with heterozygosity and repeat content were also reduced or eliminated (Fig. 2d–h ). These findings indicate that it is essential to properly phase haplotypes and to obtain high consensus sequence accuracy in order to prevent false duplications and associated biologically false conclusions. Curation is needed for a high-quality reference Each automated scaffolding method introduced tens to thousands of unique joins and breaks in contigs or scaffolds (Supplementary Table 14 ). Depending on species, the first scaffolding step with linked reads introduced about 50–900 joins between CLR-generated contigs. Optical maps introduced a further roughly 30–3,500 joins, followed by Hi-C with about 30–700 more joins, and each identified up to several dozen joins that were inconsistent with the previous scaffolding step. Manual curation resulted in an additional 7,262 total interventions for 19 genome assemblies or 236 interventions per Gb of sequence (Supplementary Table 15 ). When a genome assembly was available for the same or a closely related species, it was used to confirm putative chromosomal breakpoints or rearrangements (Supplementary Table 15 ). These interventions indicate that even with current state-of-the-art assembly algorithms, curation is essential for completing high-quality reference assemblies and for providing iterative feedback to improve assembly algorithms. A further description of our curation approach and analyses of VGP genomes are presented elsewhere 25 . Hi-C scaffolding and cytological mapping Most large assembled scaffolds of each species spanned entire chromosomes, as shown by the relatively clean Hi-C heat map plots across each scaffold after curation (Extended Data Fig. 7 ), near perfect correlation between chromosomal scaffold length and karyotypically determined chromosome length (Fig. 1h ), and the presence of telomeric repeat motifs on some scaffold ends (Supplementary Table 7 ). In our VGP zebra finch assembly, all inferred chromosomes were consistent with previously identified linkage groups in the Sanger-based reference, except for chromosomes 1 and 1B (Extended Data Fig. 8a ). Their join in the VGP assembly was supported by both single CLR reads and optical maps through the junction. We also corrected nine inversion errors and filled in large gaps at some chromosome ends. In the platypus, we identified 18 structural differences in 13 scaffolds between the VGP assembly and the previous Sanger-based reference anchored to chromosomes using fluorescence in situ hybridization (FISH) physical mapping (Extended Data Fig. 8b , Supplementary Table 16 ). Of these 18, all were supported with Hi-C, and seven were also supported by both CLR and optical maps in the VGP assembly. Our platypus assembly also filled in many large (approximately 1–30 Mb) gaps and corrected many inversion errors (Extended Data Fig. 8b ). Furthermore, we identified seven additional chromosomes (chromosomes 30–36) in the zebra finch, and eight (chromosomes 8, 9, 14, 15, 17, 19, 21, and X4; Extended Data Fig. 8a, b ) in the platypus 26 , 27 . Relative to the VGP assembly, the earlier short-read Anna’s hummingbird assembly was highly fragmented (Extended Data Fig. 8c ), despite being scaffolded with seven different Illumina libraries spanning a wide range of insert sizes (0.2–20 kb). The previous climbing perch assembled chromosomes were even more fragmented and also had large gaps of missing sequence (Extended Data Fig. 8d ). On average, 97% ± 3% (s.d.) of the assembled bases were assigned to chromosomes (Extended Data Table 1 ), compared with 76% and 32% in the prior zebra finch and platypus references, respectively. We believe the comparable or higher accuracy of Hi-C relative to genetic linkage or FISH physical mapping is due to the higher sampling rate of Hi-C pairs across the genome. Nonetheless, visual karyotyping is useful for complementary validation of chromosome count and structure 28 . Trios help to resolve haplotypes We were able to assemble the trio-based female zebra finch contigs into separate maternal and paternal chromosome-level scaffolds (Extended Data Fig. 9a ) using our VGP trio pipeline (Extended Data Fig. 3b ). Compared to the non-trio assembly of the same individual, the trio version had seven- to eightfold fewer false duplications ( k -mer and BUSCO dups in Supplementary Tables 11 , 12 ), well-preserved haplotype-specific variants ( k -mer precision/recall 99.99/97.08%), and higher base call accuracy, exceeding Q43 for both haplotypes (Extended Data Table 1 ). The trio-based assembly was the only assembly with nearly perfect (99.99%) separation of maternal and paternal haplotypes, determined using k -mers specific to each 23 . We identified haplotype-specific structural variants, including inversions of 4.5 to 12.5 Mb on chromosomes 5, 11, and 13 that were not readily identifiable in the non-trio version (Extended Data Fig. 10a–e ). Moving forward, the VGP is prioritising the collection of mother–father–offspring trios where possible, or single parent–offspring duos, to assist with diploid assembly and phasing, as well as the development of improved methods for the assembly of diploid genomes in the absence of parental genomic data, as described in another study 29 . Effects of polishing on accuracy Despite their increased continuity and structural accuracy, CLR-based assemblies required at least two rounds of short-read consensus polishing to reach 99.99% base-level accuracy (one error per 10 kb, Phred 30 Q40; Supplementary Table 5 ). Before polishing, the per-base accuracy was Q30–35 (calculated using k -mers). The most common errors were short indels from inaccurate consensus calling during CLR contig formation, which resulted in amino acid frameshift errors. Using our combined approach of long-read and short-read polishing applied on both primary and alternate haplotype sequences together, we polished from 82% to 99.7% of the primary and about 91.3% of the alternate assembly (Supplementary Table 17 ). Of the remaining unpolished sequence, one haplotype was sometimes reconstructed at substantially lower quality, because most reads aligned to the higher quality haplotype (Extended Data Fig. 11a ). False duplications had similar effects, where the duplicated sequence acted as an attractor during the read mapping. Haplotypes in the more homozygous regions tended to be collapsed by FALCON-Unzip 17 . All such cases recruited reads from both haplotypes and thereby caused switch errors, which we confirmed in the trio-based assembly and fixed when excluding read pairs from the other haplotype during polishing (Extended Data Fig. 11b ). These findings indicate that both sequence read accuracy and careful haplotype separation are important for producing accurate assemblies. Sex chromosomes and mitochondrial genomes Sex chromosomes have been notoriously difficult to assemble, owing to their greater divergence relative to autosomes and high repeat content 31 . We successfully assembled both sex chromosomes (Z, W) for all three avian species, the first W chromosome (to our knowledge) for vocal learning birds (Extended Data Figs. 7 , 9b ), the X and/or Y chromosome in placental mammals (Canada lynx and two bat species), the X chromosome in the thorny skate, and for the first time, to our knowledge, all ten sex chromosomes (5X and 5Y) in the platypus 26 (Extended Data Fig. 9c ). The completeness and continuity of the zebra finch Z and W chromosomes were further improved by the trio-based assembly (Extended Data Fig. 9b ). However, the sex chromosome assemblies were still more fragmented than the autosomes, probably owing to their lower sequencing depth and high repeat content. Mitochondrial (MT) genomes, which are expected to be 11–28 kb in size 32 , were initially found in only six assemblies (Supplementary Table 18 ). The MT-derived raw reads were present, but they failed to assemble, in part because of minimum read-length cutoffs for the starting contig assembly. Furthermore, if the MT genome was not present during nuclear genome polishing, the raw MT reads were attracted to nuclear MT sequences (NuMTs), incorrectly converting them to the full organelle MT sequence (Extended Data Fig. 11c ). To address these issues, we developed a reference-guided MT pipeline and included the MT genome during polishing 33 (Extended Data Fig. 3c ; VGP v1.6). With these improvements, we reliably assembled 16 of 17 MT genomes (Supplementary Table 18 ) and discovered 2 kb of an 83-bp repeat expansion within the control region in the kākāpō (Extended Data Fig. 9d ), and Nad1 and trnL2 gene duplications in the climbing perch (Extended Data Fig. 9e ). These duplications were verified using single-molecule CLR reads that spanned the duplication junctions or even the entire MT genome. Their absence in previous MT references 34 , 35 is likely to result from the inability of Sanger or short reads to correctly resolve large duplications. More details on the MT-VGP pipeline and new biological discoveries are reported elsewhere 33 . Improvements to read alignment and annotation Compared to previous Sanger (zebra finch and platypus) and Illumina (Anna’s hummingbird and climbing perch) assemblies, we added about 42–176 Mb of missing sequence and placed 68.5 Mb (zebra finch) to 1.8 Gb (platypus) of previously unplaced sequence within chromosomes. We corrected about 7,800–64,000 mis-joins, and closed 55,177–193,137 gaps per genome (Supplementary Table 19 ). Consistent with these improvements, both transcriptome RNA sequencing (RNA-seq) data (Fig. 3a ) and genome assay for transposase-accessible chromatin using sequencing (ATAC–seq) data (Fig. 3b ) aligned with about 5 to 10% greater mapability to our new VGP assemblies compared with the previous assemblies. The NCBI RefSeq and EBI Ensembl annotations revealed: 5,434 to 14,073 more protein-coding transcripts per species, with 94.1 to 97.8% fully supported (Fig. 3c , Supplementary Table 20 ); only about 100 to 300 partially assembled coding genes, compared with about 1,600 to 5,600 (Fig. 3d ); more orthologous coding genes shared with human; and fewer transcripts that required corrections to compensate for premature stop codons or frame-shift indel errors (Extended Data Table 2 ). The total number of genes annotated went down in the VGP assemblies (Extended Data Table 2 ), partly because there were fewer false duplications (Supplementary Table 19 ). Supporting these results, the VGP assemblies had 0 to 13% higher k -mer completeness (95% mean ± 3.5% s.d. versus 88 ± 4.3%; Extended Data Table 2 , Supplementary Table 19 ; P = 0.0047, n = 4 prior and 17 VGP assemblies, unpaired t -test). Fig. 3 Improvements to alignments and annotations in VGP assemblies relative to prior references. a , b , Average percentage of RNA-seq transcriptome samples ( a ; n = 44, mean ± s.e.m.) and ATAC–seq genome reads ( b ; n = 12) that align to the previous and VGP zebra finch assemblies. Unique reads mapped to only one location in the assembly. Total is the sum of unique and multi-mapped reads. P values are from paired t -test. c , d , Total number of coding sequence (CDS) transcripts (full bar) and portion fully supported (inner bar) ( c ) and the number of RefSeq coding genes annotated as partial ( d ) in the previous and VGP assemblies using the same input data. e – h , Examples of assembly and associated annotation errors in previous reference assemblies corrected in the new VGP assemblies. See main text for descriptions. i , Gene synteny around the VTR2C receptor in the platypus shows completely missing genes ( NUDT16 ), truncated and duplicated ARHGAP4 , and many gaps in the earlier Sanger-based assembly compared with the filled in and expanded gene lengths in the new VGP assembly. Assembly accessions are in Supplementary Table 19 . An example of a whole-gene heterotype false duplication in the RefSeq annotation of the previous zebra finch reference 19 is the BUSCO gene SPC25 36 , for which each haplotype was correctly placed in the VGP primary and alternate assemblies (Fig. 3e ). The GABRG2 receptor, which shows specialized expression in vocal learning circuits 37 , had a partial tandem duplication of four of its ten exons, resulting in annotated partial false tandem gene duplications ( GABRG2 and GABRG2 -like; Fig. 3f ). The vitellogenin-2 ( VTG2 ) gene, a component of egg yolk in all egg-laying species 38 , was distributed across 14 contigs in 3 different scaffolds in the previous platypus assembly (Fig. 3g ). Two of these scaffolds received two corresponding VTG2 -like gene annotations, and the third was included as false duplicated intron in CAPN-13 (red), together causing false amino acid sequences in five exons (blue). The BUSCO YIPF6 gene, which is associated with inflammatory bowel disease 39 , was split between two different scaffolds and is thus presumed to be a gene loss in the earlier climbing perch assembly 40 (Fig. 3h ). Each of these genes is now present on long VGP contigs, within validated blocks, with no gaps and no false gene gains or losses (Supplementary Table 21 ). Going beyond individual genes, a ten-gene synteny window surrounding the vasotocin receptor 2C gene ( VTR2C ; also known as AVPR2 ), which is involved in blood pressure homeostasis and brain function 41 , 42 , was split into 34 contigs on four scaffolds, one of which contained a false haplotype duplication of ARHGAP4 in the previous platypus assembly 43 (Fig. 3i ). In our VGP assembly, all eleven genes were in one 37-Mb-long contig within the approximately 50 Mb chromosome 6 scaffold. Furthermore, eight of the eleven genes were remarkably increased in size owing to the addition of previously unknown missing sequences. This chromosomal region was more GC-rich (54%) than the entire chromosome 6 (46%). Thousands of such false gains and losses in previous reference assemblies have been corrected in our VGP assemblies (more details in refs. 27 , 44 ), demonstrating that assembly quality has a critical effect on subsequent annotations and functional genomics. GC-rich regulatory regions of coding genes We tested whether the higher-quality VGP assemblies enabled new biological discoveries. Notably, beginning about 1.5 kb upstream of protein-coding genes, in 100-bp blocks, there was a steady increase from about 6–20% to about 30–55% of genes having missing sequence in previous references (Fig. 4a ); similarly high proportions of genes were missing their subsequent 5′ untranslated regions (UTRs) and first exons. This fluctuation in missing sequence was directly proportional to GC content (Fig. 4a ). We therefore studied the GC content pattern across all protein-coding genes in all 16 new VGP assemblies and found a genome-wide signature: a rapid rise in GC content in the roughly 1.5 kb before the transcription start site, in the 5′ UTR, and in the first exon, followed by a steady decrease in subsequent exons and returning to near intergenic background levels in the 3′ UTR and about 1.5 kb after the transcription termination site (Fig. 4b ). The introns had lower GC content, closer to the intergenic background. The intergenic GC content was stable within 30 kb on either side of each gene (Fig. 4b ). Mammals, birds, and reptiles had the highest increase (around 20%) in GC content near the start site, followed by the amphibian and skate with medium levels (around 10%). Teleost fishes showed an initial decrease, followed by weaker increase (about 5%) from an already lower GC content (Fig. 4b ). Given that the skate represents the sister branch to all other vertebrate lineages sequenced, these findings suggest that teleosts lost at least 5% GC content genome-wide, while maintaining most of the GC content pattern in protein-coding genes. Although it is known that promoter regions can be CpG rich, and GC content can vary between exons and introns 45 , 46 , such a systematic pattern, the lineage-specific differences within vertebrates, and the magnitude of these differences had not been previously described, to our knowledge. Fig. 4 VGP assemblies reveal GC content patterns in protein-coding genes. a , Average GC content ( n = 14,000–18,000 annotated coding genes; Extended Data Table 2 ) in VGP assemblies (black) and the percentage of genes with missing sequence in the earlier references (red) based on a Cactus alignment, in 100-bp blocks, 2 kb on either side of all protein-coding genes (left and right), and for UTRs, exons, and introns (middle). b , Average GC content (mean ± s.d. for lineages with more than one species) of the six major vertebrate lineages sequenced, for 30 kb upstream and downstream (in 100-bp blocks, log scale; left and right) and of the UTR, exons, and introns (middle). c , d , Left, specialized expression (arrows) shown by in situ hybridization of DRD1B in the zebra finch striatum ( c ) and ER81 in the arcopallium ( d ), from Jarvis et al. 47 ; the cerebellum was removed from the ER81 image. Right, ATAC–seq profiles in the GC-rich promoter regions of these genes, showing each gene’s GC content (red is high), the ATAC–seq peaks in striatum (purple) or arcopallium (yellow) neurons, and portions of missing sequence (black) in the previous reference assembly (grey). We tested whether the newly assembled GC-rich promoter regions contained novel regulatory sequences. Analysing the zebra finch brain, we found that genes with upregulated expression specific to the striatum (for example, DRD1B , which encodes a dopamine receptor) had ATAC-seq peaks in the GC-rich promoter and 5′ UTR region in striatal neurons, but not in arcopallium neurons (Fig. 4c ); conversely, genes (for example, the ER81 transcription factor) with upregulated expression in the arcopallium (mammalian cortex layer 5 equivalent 47 ) had ATAC–seq peaks in the GC-rich region in arcopallium neurons but not striatal neurons (Fig. 4d ). These GC-rich regions were missing in the earlier assembly. In addition, the missing region in DRD1B led to a false annotation as a two-exon gene 48 , whereas the VGP assembly revealed a single-exon gene (Fig. 4c ). These GC-rich promoter regions are candidates for driving cell-type-specific expression. These findings demonstrate the importance of using sequencing chemistry that reads through GC-rich regions, like the CLR method. The earlier hummingbird genome assembly was generated using Illumina TruSeq3 chemistry 16 , which was designed to read through GC-rich regions, and yet about 55% of the genes were missing the 100-bp GC-rich region before the start site (Fig. 4a ). Another paper contains additional findings on missing regions 27 . Chromosomal evolution We next investigated whether we could gain new insights into chromosome evolution among vertebrates. Given the more than 430 million years (Myr) of evolutionary divergence among the species sampled here, it was difficult to generate whole genome-to-genome alignments across all species. Thus, we focused our initial analyses on 1,147 highly conserved BUSCO vertebrate genes that are shared among our assemblies of all 16 species and the human reference (GRCh38). Human chromosomes mapped with greater orthology to 3.7 ± 1.3 (s.d.) chromosomes on average in other mammals, compared to 5.6 ± 2.2 in amphibians and 9.6 ± 3.3 in teleost fishes (Fig. 5a , Supplementary Table 22 ). The skate chromosome arrangement was more conserved with tetrapods, mapping to 2.9 ± 1.4 chromosomes on average, compared to 4.8 ± 2.5 in teleost fishes. These findings indicate that, along with a reduction in GC content, the teleost lineage has experienced more massive chromosome rearrangements since divergence from their most recent common ancestor with tetrapods, consistent with a proposed higher rearrangement rate in teleosts 49 . Fig. 5 Chromosome evolution among bats and other vertebrates. a , Chromosome synteny maps across the species sequenced based on BUSCO gene alignments. Chromosome sizes (bar lengths) are normalized to genome size, to make visualization easier. Genes (lines) are coloured according to the human chromosome to which they belong; those on human chromosome 6 are highlighted in blue and other chromosomes are in lighter shades. The cladogram is from the TimeTree database 72 . b , Phylogenetic relationship of the mammalian species sequenced and their inferred chromosome EBR rates (breaks per Myr) on different branches. Red, higher rates than average (0.84); blue, lower than average. c , Summary of alignment, gene organization, and functional gene status surrounding a bat interchromosomal EBR involving the homologue of human chromosome 6. End of scaffold (S) or chromosome (Chr.) means that the breakpoint is located at a chromosome arm end; middle means that it is located within a scaffold or chromosome. Scale is relevant for human Chr. 6 only. Actual gene sizes in the non-human species may differ and were drawn to match the annotated human gene sizes for simplicity. To determine the precise locations of chromosome rearrangements between species, we focused on a shorter evolutionary distance of around 180 Myr among mammals, and added four additional bat species described in our Bat1K study 50 , the human genome reference 51 (GRCh38.p12), and a recently upgraded long-read chicken reference 52 (galGal6a) as an outgroup. Pairwise whole-genome alignments to the human reference defined homologous synteny blocks and evolutionary breakpoint regions (EBRs) among the species. We found that breakpoint rates (EBRs per Myr) tripled among bats soon after the last mass extinction event (about 66 million years ago (Mya)), a time of rapid bat superfamily divergences 53 (about 60 Mya; Fig. 5b ). Some rearrangements affected genes. For example, a 1.3-Mb inversion in greater horseshoe bat chromosome 28 (homologous to 29.5 Mb of human chromosome 15; Extended Data Fig. 12a ) disrupted STARD5 , a gene involved in cholesterol homeostasis in liver cells 54 . The rearrangement separated exons 1–5 from exon 6, and disrupted splicing of the transcripts (Extended Data Fig. 12b ). Another example was an EBR that involved fission of an ancestral bat chromosome homologue of human chromosome 6 (boreoeutherian mammal chromosome 5 55 ) and was later reused among the different bat lineages in rearrangements that involved the ancestral homologues of human chromosomes 1, 2 and 6 (Fig. 5c , Extended Data Fig. 12c ). We also noted a fission in this region in the mouse, rat, and dog genomes 55 . On the basis of the conserved gene order in human and Canada lynx, we inferred that the boreoeutherian ancestral mammal locus corresponding to human 6p22.1 contained 12 genes, including four ZSCAN and two ZKSCAN transcription factors, and two GPX enzyme genes, all associated with sequentially increasing independent gene losses in bats (Fig. 5d ). For example, the greater horseshoe bat lost only ZSCAN12 and GPX6 to pseudogenization, whereas Kuhl’s pipistrelle lost all 12 genes. ZSCAN and ZKSCAN are involved in cell differentiation, migration and invasion, proliferation, apoptosis, and innate immunity 56 . We speculate that loss of ZSCAN12 in all six bats could contribute to their immune tolerance to pathogens 50 . Other biological findings using these VGP assemblies are published elsewhere, and include: 1) more accurate synteny across species, leading to a better understanding of the evolution of and thus a universal nomenclature for the vasotocin (also known as vasopressin) and oxytocin ligand and receptor gene families 57 ; 2) greater understanding of the evolution of the carbohydrate 6- O sulfotransferase gene family, which encodes enzymes that modify secreted carbohydrates 58 ; 3) the first Bat1K study 50 , which generated a genome-scale phylogeny that better resolves the relationships between bats and other mammals, and which identified changes in bat genes that are involved in immunity and life span, including genes that are relevant to the COVID-19 pandemic 59 ; 4) deleterious mutations that have been purged from the last surviving isolated and inbred population of the critically endangered kākāpō 60 ; and 5) more complete resolution of the evolution of the complex sex chromosomes in platypus and echidna 26 . These discoveries were not possible with the previous reference assemblies, and we expect many future discoveries to follow. Proposed assembly quality metrics Drawing on the lessons learned from this work, we propose that assembly quality should be summarized using 14 metrics under 6 categories (Table 1 ; full details in Supplementary Note 4 ). We summarize the most critical and commonly used metrics using the simple notation x . y . P . Q . C , where: x = log 10 [contig NG50], y = log 10 [scaffold NG50], P = log 10 [haplotype phase block NG50], Q = QV base accuracy, and C = percentage of the assembly assigned to chromosomes (Table 1 ). Our current minimum VGP standard, for example, is 6.7.P5.Q40.C90. This revises our prior notation 50 , 61 , 62 , which reported log-scaled continuity measured in ‘kilobases’ rather than ‘bases’. The thresholds we chose were based on empirical and quantitative observations between what is achievable currently and what is aspirational, and the question the assemblies are meant to answer. For example, the short-read paired-end library-based assemblies of the B10K Phase 1 genomes in 2014 16 and the 10XG linked-read assembly of the Anna’s hummingbird presented here would be categorized as a 4.5.P7.Q50 assembly, with low continuity but high base accuracy (Table 1 ). Such a genome would be suitable for use in phylogenomics 63 and for population-scale SNP surveys 64 . If, instead, a genome is to be used to study chromosomal evolution, then the VGP-2016 minimum metric 6.7.P5.Q40.C95, with high structural and base accuracies and more than 95% assigned to chromosomes (Table 1 ), would be necessary. If having GC-rich promoter regions and complete 5′ exons in most genes is essential, then long-read approaches that sequence through these regions are necessary. ‘Finished’ quality (Table 1 ) is obviously the ideal assembly result, but this level of quality is currently routine only for bacterial and non-vertebrate model organisms with smaller genome sizes that lack large centromeric satellite arrays 65 , 66 – 67 and for organelle genomes, as presented here 33 . The possibility of achieving complete, telomere-to-telomere assemblies of vertebrate and other eukaryotic species is foreseeable, given some assembled avian and bat chromosomes with zero gaps in this study, and the recent complete assembly of two human chromosomes 68 , 69 . Table 1 Proposed standards and metrics for defining genome assembly quality Quality category Metric Finished VGP-2020 VGP-2016 B10k-2014 This study Notation x.y.P.Q.C c.c.Pc.Q60.C100 7.c.P6.Q50.C95 6.7.P5.Q40.C90 4.5.Q30 Continuity Contig NG50 ( x ) = Chr. NG50 >10 Mb >1 Mb >10 kb 1–25 Mb Scaffolds NG50 ( y ) = Chr. NG50 = Chr. NG50 >10 Mb >100 kb 23–480 Mb Gaps per Gb No gaps <200 <1,000 <10,000 75–1,500 Structural accuracy Reliable blocks = Chr. NG50 >10 Mb >1 Mb Not required 2.3–40.2 Mb False duplications 0% <1% <5% <10% 0.2–5.0% Curation Conflicts resolved Manual Manual Not required Manual Base accuracy Base pair QV ( Q ) >60 >50 >40 >30 39–43 k -mer completeness 100% complete >95% >90% >80% 87–98% Haplotype phasing Phase block NG50 ( P ) = Chr. NG50 >1 Mb >100 kb Not required 1.6 Mb a Functional completeness Genes >98% complete >95% complete >90% >80% 82–98% Transcript mappability >98% >90% >80% >70% 96% Chromosome status Assigned (C) >100% >95% >90% Not required 94.4–99.9% Sex chromosomes Right order, no gaps Localized homo pairs At least one shared (for example, X or Z) Fragmented At least one shared Organelles (for example, MT) One complete allele One complete allele Fragmented Not required One complete allele The six broad quality categories in the first column are split into sub-metrics in the second column. The recommendations for draft to finished qualities (columns 3–6) are based on those achieved in past studies 16 , 19 , 63 , this study, and what we aspire to. In the x.y.P.Q.C notation, x = log 10 [contig NG50]; y = log 10 [scaffold NG50]; P = log 10 [haplotype phased NG50 block]; Q = Phred base accuracy QV; and C = percentage of the assembly assigned to chromosomes. c denotes ‘complete’ telomere-to-telomere continuity. The VGP assemblies (last column) satisfy the 6.7.6.Q40.C90 standard, but some come close to achieving a higher 7.c.7.Q50.C95 standard. These metrics apply to genomes about 1 Gb or bigger. a Phase blocks calculated for the zebra finch non-trio assembly using haplotype specific k -mers from parental data 20 ; the trio assemblies had NG50 phase blocks of 17.3 Mb (maternal) and 56.6 Mb (paternal). The Vertebrate Genomes Project Building on this initial set of assembled genomes and the lessons learned, we propose to expand the VGP to deeper taxonomic phases, beginning with phase 1: representatives of approximately 260 vertebrate orders, defined here as lineages separated by 50 million or more years of divergence from each other. Phase 2 will encompass species that represent all approximately 1,000 vertebrate families; phase 3, all roughly 10,000 genera; and phase 4, nearly all 71,657 extant named vertebrate species (Supplementary Note 5 , Supplementary Fig. 3 ). To accomplish such a project within 10 years, we will need to scale up to completing 125 genomes per week, without sacrificing quality. This includes sample permitting, high molecular weight DNA extractions, sequencing, meta-data tracking, and computational infrastructure. We will take advantage of continuing improvements in genome sequencing technology, assembly, and annotation, including advances in PacBio HiFi reads, Oxford Nanopore reads, and replacements for 10XG reads (Supplementary Note 6 ), while addressing specific scientific questions at increasing levels of phylogenetic refinement. Genomic technology advances quickly, but we believe the principles of our pipeline and the lessons learned will be applicable to future efforts. Areas in which improvement is needed include more accurate and complete haplotype phasing, base-call accuracy, and resolution of long repetitive regions such as telomeres, centromeres, and sex chromosomes. The VGP is working towards these goals and making all data, protocols, and pipelines openly available (Supplementary Notes 5 , 7 ). Despite remaining imperfections, our reference genomes are the most complete and highest quality to date for each species sequenced, to our knowledge. When we began to generate genomes beyond the Anna’s hummingbird in 2017, only eight vertebrate species in GenBank had genomes that met our target continuity metrics, and none were haplotype phased (Supplementary Table 23 ). The VGP pipeline introduced here has now been used to complete assemblies of more than 130 species of similar or higher quality (Supplementary Note 5 ; BioProject PRJNA489243). We encourage the scientific community to use and evaluate the assemblies and associated raw data, and to provide feedback towards improving all processes for complete and error-free assembled genomes of all species. Methods Genome assembly naming For each completed assembly of an individual, we gave that assembly an abbreviated name with the following rules: Lineage/GenusSpecies/Individual#.Assembly#. The first letter, in lowercase, identifies the particular lineage: m, mammals; b, birds; r, reptiles; a, amphibians; f, teleost fish; and s, sharks and other cartilaginous fishes. The next three letters (first in caps) identify the species scientific genus name; the next three letters (first in caps) identifies the specific species name. In the last position is the genome identifier, where integers (1, 2, 3, …) represent different individuals of the same species, and decimals (1.1, 1.2, 1.3, …) represent different assemblies of the same individual. For example, the first submission of the curated Anna’s hummingbird ( Calypte anna ) assembly is bCalAnn1.1, and an updated assembly for the same individual is bCalAnn1.2. When the abbreviated lineage or genus and species names for two or more species were identical, we replaced the subsequent letters (fourth, fifth and so on) of the genus or species name until they could be differentiated. We have created abbreviated names for all 71,657 vertebrate species ( http://vgpdb.snu.ac.kr/splist/ ; https://id.tol.sanger.ac.uk/ ). Sample collection The production of high-quality genome assemblies required us to obtain high-quality cells or tissue that would yield high-molecular-weight (HMW) DNA for long-read sequencing technologies (CLR and ONT) and optical mapping (Bionano). Therefore, we obtained fresh-frozen samples of various tissues (Supplementary Table 8 ). All samples were obtained according to approved protocols of the respective animal care and use committees or permits obtained by the respective persons and institutions listed in Supplementary Table 8 . Additional details of the samples are on their respective BioSample pages ( https://www.ncbi.nlm.nih.gov/biosample ; accession numbers in Supplementary Table 8 ). All tissue types tested yielded a sufficient quantity and quality of DNA for sequencing and assembly, but we found that blood worked best for species that have nucleated red blood cells (that is, bird and reptiles), and spleen or cultured cells worked best for mammals, as of to date. Analysis of different tissue types will be presented elsewhere (in preparation). Isolation of high-molecular-weight DNA Agarose plug DNA isolation For tissue, HMW DNA was extracted using the Bionano animal tissue DNA isolation fibrous tissue protocol (cat no. RE-013-10; document number 30071), according to the manufacturer’s guidelines. A total of 25–30 mg was fixed in 2% formaldehyde and homogenized using the Qiagen TissueRuptor or manual tissue disruption. For nucleated blood, 27–54 μl was used with an adapted protocol (Bionano, personal communication) of the Bionano Prep Blood and Cell Culture DNA Isolation Kit (cat no. RE-130-10). Lysates were embedded into agarose plugs and treated with Proteinase K and RNase A. Plugs were then purified by drop dialysis with 1× TE. DNA quality was assessed using pulse field gel electrophoresis (PFGE) (Pippin Pulse, SAGE Science, Beverly, MA) or the Femto Pulse instrument (Agilent). PFGE revealed that we isolated ultra-high-molecular-weight DNA between ~100 and ~500 kb long. Phenol–chloroform gDNA extraction For some samples, we performed phenol–chloroform extractions for HMW gDNA. Snap-frozen tissue was pulverized into a fine powder with a mortar and pestle in liquid nitrogen. The powdered tissue was lysed overnight at 55 °C in high-salt tissue lysis buffer (400 mM NaCl, 20 mM Tris base (pH 8.0), 30 mM EDTA (pH 8.0), 0.5% SDS, 100 μg/ml Proteinase K), and powdered lung tissue was lysed overnight in Qiagen G2 lysis buffer (cat no. 1014636, Qiagen, Hilden, Germany) containing 100 μg/ml Proteinase K at 55 °C. RNA was removed by incubation in 50 μg/ml RNase A for 1 h at 37 °C. HMW gDNA was purified with two washes of phenol–chloroform-IAA equilibrated to pH 8.0, followed by two washes of chloroform-IAA, and precipitated in ice-cold 100% ethanol. Filamentous HMW gDNA was either spooled with shepherds hooks or collected by centrifugation. HMW gDNA was washed twice with 70% ethanol, dried for 20 min at room temperature and eluted in TE. For the flier cichlid muscle gDNA sample used for PacBio CLR and 10XG libraries, glycogen was precipitated by adding 1/10 (v/v) 0.3 M sodium acetate, pH 6.0 to the extracted genomic DNA, mixing carefully and spinning at room temperature at 10,000 g . PFGE revealed thatDNA molecule length was between 50 and 300 kb—often lower in size than that obtained with the agarose plug but sufficient for long-range sequencing of CLR and linked read data types. Others We also used the Qiagen MagAttract HMW DNA kit (cat no. 67563) and the KingFisher Cell and Tissue DNA kit (Thermo Scientific; cat no. 97030196), following the manufacturers’ guidelines. These protocols yielded HMW DNA ranging from 30 to 50 kb. The Genomic Tip (Qiagen) kit was also used for tissue-based extraction of HMW DNA. Libraries and sequencing PacBio libraries and sequencing DNA obtained from agarose plugs was sheared down to ~40 kb fragment size with a MegaRuptor device (Diagenode, Belgium) and fragmented using Covaris g-tubes (520079) or by needle shearing. PacBio large insert libraries were prepared with either the SMRTbell Template Prep Kit 1.0‐SPv3 (no.100‐991‐900) or the SMRTbell Express Template Prep Kit v1 (no. 101‐357‐000). Libraries were size-selected between 12 and 25 kb using Sage BluePippin (Sage Science, USA), depending on the DNA quality and extraction method. These libraries were sequenced on either RSII or Sequel I instruments, at least 60× coverage per species using Sequel Binding Kit and Sequencing Plate versions 2.0 and 2.1 with 10-h movie time (Supplementary Table 9 ). 10X Chromium libraries and sequencing Unfragmented HMW DNA from the agarose plugs was used to generate linked read libraries on the 10X Genomics Chromium platform (Genome Library Kit & Gel Bead Kit v2 PN-120258, Genome Chip Kit v2 PN-120257, i7 Multiplex Kit PN-120262) following the manufacturer’s guidelines. We sequenced the 10X libraries at ~60× coverage per species on an Illumina NovaSeq S4 150-bp PE lane. Bionano libraries and optical map imaging Unfragmented ultra-HMW DNA from the agarose plugs was labelled using either two different nicking enzymes (BspQI and BssSI) or a direct labelling enzyme (DLE1) following the Bionano Prep Labelling NLRS (document number 30024) and DLS protocols, respectively (document number 30206). Labelled samples were then imaged on a Bionano Irys or on a Bionano Saphyr instrument. For all species, we aimed for at least 100× coverage per label (Supplementary Table 9 ). Hi-C libraries and sequencing Chromatin interaction (Hi-C) libraries were generated using either Arima Genomics, Dovetail Genomics, or Phase libraries on muscle, blood, or other tissue with in vivo cross-linking (Supplementary Table 9 ) and sequenced on Illumina instruments. Arima-HiC preparations were performed by Arima Genomics ( https://arimagenomics.com/ ) using the Arima-HiC kit that uses two enzymes (P/N: A510008). The resulting Arima-HiC proximally ligated DNA was then sheared, size-selected around 200–600 bp using SPRI beads, and enriched for biotin-labelled proximity-ligated DNA using streptavidin beads. From these fragments, Illumina-compatible libraries were generated using the KAPA Hyper Prep kit (P/N: KK8504). The resulting libraries were PCR amplified and purified with SPRI beads. The quality of the final libraries was checked with qPCR and Bioanalyzer, and then sequenced on Illumina HiSeq X at ~60× coverage following the manufacturer’s protocols. Dovetail-HiC preparations were performed by Dovetail using a single-enzyme (DpnII) proximity ligation approach. Phase-HiC libraries were made by Phase Genomics using a Proximo Hi-C Library single-enzyme reaction. Quality control Before we performed any assembly, all genomic data of all data types from each sample were used to screen potential outlier libraries, outlier sequencing runs, or accidental species contamination with Mash 73 by measuring sequence similarity (Supplementary Fig. 4 ). When running Mash, we used 21-mers to generate sketches with sketch size of 10,000 and compared among each sequencing run, and then differences assessed between sequencing sets. Genome size, repeat content, and heterozygosity estimations These estimations were made with k -mer-based methods applied to the Illumina short reads obtained from 10XG linked sequencing libraries. After trimming off barcodes during scaff10x 74 preprocessing, canonical 31-mer counts were collected using Meryl 23 . With the resulting 31-mer histogram, GenomeScope 71 was used to estimate the haploid genome length, repeat content, and heterozygosity. The thorny skate linked read data failed quality control, which we suspect was due to low complexity sequences from the high repeat content (54.1%) of the genome; so k -mers were collected later from Illumina whole-genome sequencing reads instead. The genome size and repeat content of the channel bull blenny were estimated from an alternative method that looks at the mode of long read overlap coverage and WindowMasker 75 , as the estimated genome size from GenomeScope was almost doubling the known haploid genome size (1.29 Gb versus 0.6 Gb) and repeat content (28.0% versus 58.0%), for reasons related to either the quality of the 10X data or species differences. Benchmarking assembly steps with the Anna’s hummingbird To develop the VGP standard pipeline, we compared various scaffolding, gap filling, and polishing tools. Default options were used unless otherwise noted. Detailed software versions are listed in Supplementary Table 2 . Contigging and scaffolding FALCON 76 and FALCON-Unzip 17 (smrtanalysis 3.0.0) were used to generate contigs that used CLR. Canu 77 1.5+67 was used to generate the combined PacBio CLR and Oxford Nanopore ONT assembly. To benchmark scaffolding with linked reads, we used scaff10x 74 2.0. For the linked read-only assembly, Supernova 2 78 was used. For the optical maps, two-enzyme hybrid scaffolding was used in the Bionano Solve v3.2.1 software, using BspQI and BssSI initially, as well as DLE1 later when the technology was developed. For benchmarking Hi-C in scaffolding, Salsa 2.2 79 was used for scaffolding results in Fig. 1a , with Hi-C reads generated from Arima Genomics. Additional comparisons for the Hi-C libraries were performed using assemblies provided by Dovetail Genomics and Phase Genomics (Supplementary Table 3 ). We used Hi-C from Arima Genomics as it had the smallest number of PCR duplicates and better coverage for short and long interactions at the time of comparison (Supplementary Fig. 1 ). Assembly statistics from HiRise, Proximo HiC, 3D-DNA 80 and Arima Hi-C are available in Supplementary Table 3 . We concluded that all Hi-C scaffolding algorithms had similar performance. We decided to use Salsa, as HiRise and Proximo HiC were not open access, and 3D-DNA was computationally expensive on the DNAnexus platform. For short read assemblies, other than Supernova and the NRGene assembly, the assembly GCA_000699085.1 16 was used for benchmarking, which was generated with Illumina paired-end, multiple mate-pair libraries and the SoapDeNovo 81 assembler. The NRGene assembly was provided by the company with DeNovo Magic. Gap filling We ran PBJelly with support --capturedOnly --spanOnly parameters, to avoid greedy gap closures with no spanning read support. For conservatively filling sequences, we compared different parameters in output stage with --minreads 1 and --minreads 4 in addition to no restrictions. We found that the number of gaps closed was similar to the gaps filled with Arrow 76 (Supplementary Table 4 ) and chose not to run PBJelly 82 for future assemblies. Short-read polishing Illumina polishing benchmarking was performed using Longranger 83 2.1.3 and Pilon 84 1.21 with --fix bases, local option (Supplementary Table 5 ). Later, for the VGP pipeline, we used FreeBayes 85 as Pilon 84 was not computationally scalable for large genomes with the updated Longranger 2.2.2. Base-level accuracy estimate Base-level accuracy was measured using a mapping-based approach and later using the k -mer-based approach 23 . To determine the number of rounds to polish, we used Illumina paired-end reads from the hummingbird 16 . Mis-joins and missed-joins The curated hummingbird assembly was mapped to the target assemblies with MashMap2 86 with --filter_mode one-to-one --pi 95 using 5 kb segments (-s 5000) for CLR assemblies and 1 kb (-s 1000) for SR assemblies to compensate for the shorter contig sizes, as contigs smaller than a segment size will be excluded from the alignment. The number of mis-joins and missed joins were identified using the assembly_comparison.pl used in the ‘Curation’ section below ( Supplementary Methods , Supplementary Fig. 5 ). VGP standard genome assembly pipeline 1.0 to 1.6 All 17 genomes were assembled with the VGP pipeline (Extended Data Fig. 2a ) for benchmark purposes, with some uncurated. The pale spear-nosed bat, greater horseshoe bat, Canada lynx, platypus, male and female zebra finch, kākāpō, Anna’s hummingbird, Goode’s thornscrub tortoise, flier cichlid, and blunt-snouted clingfish assemblies were generated using the VGP pipeline 1.0 to 1.6 and curated for submission to NCBI and EBI public archives. The curated and submitted two-lined caecilian, zig-zag eel, climbing perch, channel bull blenny, eastern happy, and thorny skate assemblies were generated using a similar process developed in parallel (Supplementary Note 2 ). Two submitted curated versions of the female zebra finch were made, one using the standard VGP pipeline and the other using the VGP trio pipeline, so that comparative analyses could be performed by others. Contigging For PacBio data, contigs were generated from subreads using FALCON 76 and FALCON-Unzip 17 , with one round of Arrow polishing (smrtanalysis 5.1.0.26412). A minimum read length of 2 kb or a cutoff at which reads longer than the cutoff include 50× coverage was used, whichever was longer. For calculating read coverage, we used estimated genome size from http://www.genomesize.com/ when available, or from the literature (Supplementary Table 11 ) while waiting for 10XG sequencing to estimate genome size using k -mers. FALCON and FALCON-Unzip were run with default parameters, except for computing the overlaps. Raw read overlaps were computed with DALIGNER parameters -k14 -e0.75 -s100 -l2500 -h240 -w8 to better reflect the higher error rate in early PacBio sequel I and II. Pread (preassembled read) overlaps were computed with DALIGNER parameters -k24 -e.90 -s100 -l1000 -h600 intending to collapse haplotypes for the FALCON step to better unzip genomes with high heterozygosity rate. FALCON-Unzip outputs both a pseudo-haplotype and a set of alternate haplotigs that represent the secondary alleles. We refer to these outputs as the primary contig set (c1) and alternate contig set (c2). Purging false duplications Heterotype false duplications occurred despite setting FALCON 76 parameters to resolve up to 10% haplotype divergence. FALCON-Unzip 17 also incorrectly retained some secondary alleles in the primary contig set, which appeared as false duplications. To reduce these false duplications, we ran Purge_Haplotigs 13 , first during curation (VGP v1.0 pipeline) and then later after contig formation (VGP v1.5 pipeline). To do the former, Purge_Haplotigs was run on the primary contigs (c1), and identified haplotigs were mapped to the scaffolded primary assembly with MashMap2 86 for removal. In the latter, identified haplotigs were moved from the primary contigs (c1) to the alternate haplotig set (p2). The remaining primary contigs were referred to as p1; p2 combined with c2 was referred to as q2. Later, in the VGP v1.6 pipeline, we replaced Purge_Haplotigs with Purge_Dups 14 , a new program developed by several of the authors in response to Purge_Haplotigs not removing partial false duplication at contig boundaries. Purging also removes excessive low-coverage (junk) and high-coverage (repeats) contigs. To calculate the presence and overall success of purging false duplications, we used a k -mer approach ( Supplementary Methods , Supplementary Fig. 6 ). Scaffolding with 10XG linked reads The 10X Genomics linked reads were aligned to the primary contigs (p1), and an adjacency matrix was computed from the barcodes using scaff10x 74 v2.0–2.1. Two rounds of scaffolding were performed. The first round was run with parameters -matrix 2000 -reads 12 -link 10 , and the second round with parameters -matrix 2000 -reads 8 -link 10 . A gap of 100 bp (represented with ‘N’s) was inserted between joined contigs. The resulting primary scaffold set was named s1. Scaffolding with Bionano optical maps Bionano cmaps were generated using the Bionano Pipeline in non-haplotype assembly mode and used to further scaffold the s1 assembly with Bionano Solve v3.2.1 87 . We began with a one-enzyme nick map (BspQI), followed by a two-enzyme nick map (BspQI and BssSI), and then with a DLE-1 one-enzyme non-nicking approach when the later data type became available (Supplementary Table 9 ). Scaffold gaps were sized according to the software estimate. The resulting scaffold set was named s2. Scaffolding with Hi-C reads Hi-C reads were aligned to the s2 scaffolds using the Arima Genomics mapping pipeline 88 . In brief, both ends of a read pair were mapped independently using BWA-MEM 89 with the parameter -B8 , and filtered when mapping quality was <10. Chimeric reads containing a restriction enzyme site were trimmed from the restriction site onward, leaving only the 5′ end. The filtered single-read alignments were then rejoined as paired read alignments. The processed alignments were then used for scaffolding with Salsa2 79 , which analyses the normalized frequency of Hi-C interactions between all pairs of contig ends to determine a likely ordering and orientation of each. We used parameters -m yes -i 5 -p yes to allow Salsa2 to break potentially mis-assembled contigs and perform five iterations of scaffolding. After feedback from curation, later versions of Salsa were developed, which more conservatively determine the number of iterations (v2.1) and actively break at mis-assemblies (v2.2), and run for the Canada lynx, Goode’s thornscrub tortoise, and two-lined caecilian. The restriction enzyme(s) used to generate each library were specified using parameters -e GATC,GANTC for Arima and -e GATC for Dovetail and Phase Genomics Hi-C data. The resulting Hi-C scaffolded assembly was named s3. Consensus polishing To polish bases in both haplotypes with minimal alignment bias, we concatenated the alternate haplotig set (c2 in v1.0 or q2 in v1.5–1.6) to the scaffolded primary set (s3) and the assembled mitochondrial genome (mitoVGP in v1.6). We then performed another round of polishing with Arrow (smrtanalysis 5.1.0.26412) using PacBio CLR reads, aligning with pbalign --minAccuracy=0.75 --minLength=50 --minAnchorSize=12 --maxDivergence=30 –concordant --algorithm=blasr --algorithmOptions=--useQuality --maxHits=1 --hitPolicy=random --seed=1 and consensus polishing with variantCaller --skipUnrecognizedContigs haploid -x 5 -q 20 -X120 –v --algorithm=arrow . While this round of polishing resulted in higher QV for all genomes herein considered, we noticed that it was particularly sensitive to the coverage cutoff parameter ( -x ). This is because Arrow generates a de novo consensus from the mapped reads without explicitly considering the reference sequence. Later, we found that the second round of Arrow polishing sometimes reduced the QV accuracy for some species. Upon investigation, this issue was traced back to option -x 5 , which requires at least 5 reads to call consensus. Such low minimum requirements can lead to uneven polishing in low coverage regions. To avoid this behaviour, we suggest to increase the -x close to the half sequence coverage (for example, 30× when 60× was used for assembly) and check QV before moving forward. For genomes with a combined assembly size larger than 4 Gb, we used Minimap2 90 with parameters -ax map-pb instead of Blasr 91 to overcome reference index size limitations. Two more rounds of base-pair polishing were performed with linked reads. The reads were aligned with Longranger align 2.2.2, which incorporates the Lauriat for barcode-aware alignment 83 . From the alignments, homozygous mismatches (variants) were called with FreeBayes 83 v1.2.0 using default options. Consensus was called with bcftools consensus 92 with -i’QUAL>1 && (GT=’’AA’’ || GT = ‘’Aa’’)’ -Hla . VGP Trio Pipeline v1.0–v1.6 The trio pipeline is similarly designed to the standard pipeline, except for the use of parental data (Extended Data Fig. 3b ). When parental genomes are available, the child’s CLR reads are binned to maternal and paternal haplotypes, and assembled separately as haplotype-specific contigs (haplotigs) using TrioCanu 20 . In brief, parental specific marker k -mers were collected using Meryl 23 from the parental Illumina WGS reads of the parents. These markers were filtered and used to bin the child’s CLR read. A haplotype was assigned given the markers observed, normalized by the total markers in each haplotype. The subsequent purging, scaffolding, and polishing steps were similarly updated with the use of Purge_Dups 14 (v1.6). We extended binning to linked reads and Hi-C reads, by excluding read pairs that had any parental-specific marker. The binned Hi-C reads were used to scaffold its haplotype assembly, and polished with the binned linked reads from the observation of haplotype switching using the standard polishing approach. During curation, one of the haplotype assemblies with the higher QV and/or contiguity was chosen as the representative haplotype. The heterogametic sex chromosome from the unchosen haplotype was added to the representative assembly. However, while curating several trios, we found that in regions of low divergence between shared parental homogametic sex chromosomes (that is, X or Z), a small fraction of offspring CLR data was mis-assigned to the wrong haplotype. This mis-alignment resulted in a duplicate, low-coverage offspring X or Z assembly in the paternal (for mammals) or maternal (for birds) haplotype, respectively, which required removal during curation. We are working on methods to improve the binning accuracy for resolution of this issue going forward. For the female zebra finch in particular, contigs were generated before the binning was automated in the Canu assembler as TrioCanu1.7, and therefore a manual binning process was applied as described in the original Trio-binning paper 20 ( Supplementary Methods ). Contigs were assembled for each haplotype using the binned reads, excluding unclassified reads. The contigs were polished with two rounds of Arrow polishing using the binned reads, and scaffolded following the v1.0 pipeline with no purging. Additional scaffolding rounds with Bionano (s4) and Hi-C were applied. Scaffolds were renamed according to the primary scaffold assembly of the same individual (s5), with sex chromosomes grouped as Z in the paternal assembly and W in the maternal assembly following synteny to the Z chromosome from the curated male zebra finch VGP assembly. Two rounds of SR polishing were applied using linked reads, by mapping on both haplotypes. After haplotype switches were discovered, additional rounds of polishing were applied using binned linked reads ( Supplementary Methods ). Mitochondrial genome assembly Similar to other recent methods 93 , 94 , we developed a reference-guided MT assembly pipeline. MT reads in the raw CLR data were identified by mapping the whole read set to an existing reference sequence of the specific species or of closely related species using Blasr. Filtered mtDNA CLRs were assembled into a single contig using Canu v1.8, polished with Arrow using CLR and then FreeBayes v1.0.2 together with bcftools v1.9 using short reads from the 10XG data (Extended Data Fig. 3c ). The overlapping sequences at the ends of the contig were trimmed, and the remaining contig sequence circularized. The mitoVGP pipeline is made available at https://github.com/VGP/vgp-assembly/tree/master/mitoVGP . A more detailed protocol description of the assembly pipeline and new discoveries from the MT assemblies are published elsewhere 33 . Curation The VGP genome assembly pipeline produces high quality assemblies, yet no automated method to date is free from the production of errors, especially during the scaffolding stages. To minimize the impact of the remaining algorithmic shortcomings, we subjected all assemblies to rigorous manual curation. All data generated for a species in this study and other publicly available data (for example, genetic maps, gene sets and genome assemblies of the same or closely related species) were collated, aligned to the primary assembly and analysed in gEVAL 95 ( https://vgp-geval.sanger.ac.uk/index.html ), visualizing discordances in a feature browser and issue lists. In parallel, Hi-C data were mapped to the primary assembly and visualized using Juicebox 96 and/or HiGlass 97 . With these data, genome curators identified mis-joins, missed joins and other anomalies, and corrected the primary assembly accordingly. No change was made without unambiguous evidence from available data types; for example, a Hi-C suggested join would not be made unless supported by BioNano maps, long-read data, or gene alignments. When sequencing the heterogametic sex, we identified sex chromosomes based on half coverage, homology alignments to sex chromosomes in other species, and the presence of sex chromosome-specific genes. Contamination removal A succession of searches was used to identify potential contaminants in the generated assemblies. 1) A megaBLAST 98 search against a database of common contaminants (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/contam_in_euks.fa.gz) requiring e ≤ 1 × 10 −4 , reporting matches with ≥98% sequence identity and match length 50–99 bp, ≥94% and match length 100–199 bp, or ≥90% and match length 200 bp or above. 2) A vecscreen ( https://www.ncbi.nlm.nih.gov/tools/vecscreen/ ) search against a database of adaptor sequences (ftp://ftp.ncbi.nlm.nih.gov/pub/kitts/adaptors_for_screening_euks.fa) 3) After soft-masking repeats using Windowmasker 75 , a megaBLAST search against chromosome-level assemblies from RefSeq requiring e ≤ 1 × 10 −4 , match score ≥100, and sequence identity ≥98%; regions matching highly conserved rDNAs were ignored. Manual inspection of the results was necessary to differentiate contamination from conservation and/or horizontal gene transfer. Adaptor sequences were masked; other contaminant sequences were removed. Assemblies were also checked for runs of Ns at the ends of scaffolds, created as artefacts of the iterative scaffolding process, and when found they were trimmed. Organelle genomes These were detected by a megaBLAST search against a database of known organelle genomes requiring e ≤ 1 × 10 −4 , sequence identity ≥90%, and match length ≥500; the databases are available at ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/mito.nt.gz and ftp://ftp.ncbi.nlm.nih.gov/refseq/release/plastid/*genomic.fna.gz. Only scaffolds consisting entirely of organelle sequences were assumed to be organelle genomes, and replaced by the genome from the separate organelle assembly pipeline. Organelle matches embedded in nuclear sequences that were found to be NuMTs were kept. False duplication removal Retained false duplications were identified using Purge_Haplotigs 13 run either after scaffolding and polishing (Anna’s hummingbird, kākāpō, male zebra finch, female zebra finch, platypus, pale spear-nosed bat, and greater horseshoe bat) or on the c1 before scaffolding (two-lined caecilian, flier cichlid, Canada lynx, and Goode’s thornscrub tortoise). Subsequent manual curation identified additional haplotypic duplications for the listed assemblies and also those that were not treated with Purge_Haplotigs (Eastern happy, climbing perch, zig-zag eel). The evidence used included read coverage, sequence self-comparison, transcript alignments, Bionano map alignments and Hi-C 2D maps, all confirming the superfluous nature of one allele. The identified haplotype duplications were moved from the primary to the alternate assembly. Chromosome assignment For a scaffold to be annotated as a chromosome, we used evidence from Hi-C as well as genetic linkage or FISH karyotype mapping when available. For Hi-C evidence, we considered a scaffold as a complete chromosome (albeit with gaps) when there was a clear unbroken diagonal in the Juicebox or HiGlass plots for that scaffold and no other large scaffolds that could be joined to that same scaffold; if present and no unambiguous join was possible, we named it as an unlocalized scaffold for that chromosome. When we could not find evidence of a complete chromosome, we kept the scaffold number for its name. We named all evidence-validated scaffolds as chromosomes down to the smallest Hi-C box unit resolution allowed with these characteristics. When there was an established chromosome terminology for a given species or set of species, we use the established terminology except when our new assemblies revealed errors in the older assembly, such as scaffold/chromosome fusions, fissions, rearrangements, and non-chromosome names. For species without an established chromosome terminology, we named the scaffolds as chromosomes numbers 1, 2, 3 …, in descending order of scaffold size. For the sex chromosomes, we used the letters X and Y for mammals and Z and W for birds. Using comparative genomics to assess assembly structure In cases where a high-quality chromosome-level genome was available for a closely related species, comparative genome analysis was performed. The polished primary assembly (t3.p) was mapped to the related genome using MashMap2 86 with --pi 75 -s 300000 . The number of chromosomal differences was identified using a custom script available at https://github.com/jdamas13/assembly_comparison . This resulted in the identification of ~60 to ~450 regions for each genome assembly flanking putative misassemblies or lineage-specific genome rearrangements. To identify which were real misassemblies, the identified discrepancies were communicated to the curation team for manual verification (see above). To identify any possible remaining mis-joins, each curated avian and mammalian assembly was compared with the zebra finch (taeGut2) or human (hg38) genomes, respectively. Pairwise alignments between each of the VGP assemblies and the clade reference were generated with LastZ 99 (version 1.04) using the following parameters: C = 0 E = 30 H = 2000 K = 3000 L = 2200 O = 400. The pairwise alignments were converted into the UCSC ‘chain’ and ‘net’ formats with axtChain (parameters: -minScore = 1000 -verbose = 0 -linearGap = medium ) followed by chainAntiRepeat, chainSort, chainPreNet, chainNet and netSyntenic, all with default parameters 100 . Pairwise synteny blocks were defined using maf2synteny 101 at 100-, 300-, and 500-kb resolutions. Evolutionary breakpoint regions were detected and classified using an ad hoc statistical approach 102 . This analysis identified 2 to 90 genomic regions per assembly that could be flanking misassemblies, lineage-specific chromosome rearrangements, or reference-specific chromosome rearrangements (116 in the human and 26 in the zebra finch). Determining the underlying cause for each of the flagged regions will need further verification. All alignments are available for visualization at the Evolution Highway comparative chromosome browser ( http://eh-demo.ncsa.illinois.edu/vgp/ ). Annotation NCBI and Ensembl annotation pipeline used in this study are described in the Supplementary Methods . Evaluation Detailed methods for other types of evaluation, including BUSCO runs, mis-join and missed-join identification, reliable blocks, collapsed repeats, telomeres, RNA-seq and ATAC–seq mapping, and false gene duplications are in the Supplementary Methods . No statistical methods were used to predetermine sample size, the experiments were not randomized, and the investigators were not blinded to group during experiments and outcome assessment. Reporting summary Further information on research design is available in the Nature Research Reporting Summary linked to this paper. Online content Any methods, additional references, Nature Research reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at https://doi.org/10.1038/s41586-021-03451-0 ."
  },
  "references_count": 108
}